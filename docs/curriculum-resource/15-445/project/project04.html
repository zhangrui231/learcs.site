<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-curriculum-resource/15-445/project/project04" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Project 03 | CSËá™Â≠¶Á§æÂå∫</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.learncs.site/docs/curriculum-resource/15-445/project/project04"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="baidu-site-verification" content="codeva-hJyfN2UKgo"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Project 03 | CSËá™Â≠¶Á§æÂå∫"><meta data-rh="true" name="description" content="Remember to pull the latest code from the bustub repository. Do not post your code on a public GitHub repository."><meta data-rh="true" property="og:description" content="Remember to pull the latest code from the bustub repository. Do not post your code on a public GitHub repository."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.learncs.site/docs/curriculum-resource/15-445/project/project04"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/15-445/project/project04" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/15-445/project/project04" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CSËá™Â≠¶Á§æÂå∫ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CSËá™Â≠¶Á§æÂå∫ Atom Feed">




<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.c4382977.css">
<link rel="preload" href="/assets/js/runtime~main.1f1549d9.js" as="script">
<link rel="preload" href="/assets/js/main.2f696ece.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">üéâÔ∏èüéâÔ∏èüéâÔ∏èËØæÁ®ãÊñáÊ°£Ê±âÂåñÂ∑•‰ΩúÊ≠£Âú®ËøõË°å‰∏≠ üéâÔ∏èüéâÔ∏è Â≠¶‰π†‰∫§ÊµÅÁæ§ËØ∑Âà∞ <a href="/community">Á§æÂå∫È°µÈù¢</a> Êü•ÁúãÂÖ•Áæ§ÊñπÂºè üéâÔ∏èüéâÔ∏èüéâÔ∏è</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">TeachYourselfCS</b></a><a class="navbar__item navbar__link" href="/docs/roadmap">Ë∑ØÁ∫øÂõæ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">ËØæÁ®ãËµÑÊ∫ê</a><a class="navbar__item navbar__link" href="/blog">ÂçöÂÆ¢</a><a class="navbar__item navbar__link" href="/community">Á§æÂå∫</a><a class="navbar__item navbar__link" href="/donate">ÊçêËµ†Êàë‰ª¨</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">ÂâçË®Ä</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/roadmap">Ë∑ØÁ∫øÂõæ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/ËØæÁ®ãËµÑÊ∫ê">ËØæÁ®ãËµÑÊ∫ê</a><button aria-label="Toggle the collapsible sidebar category &#x27;ËØæÁ®ãËµÑÊ∫ê&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x">cs50x</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61a">cs61a</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61a&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61b">cs61b</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61b&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61c">cs61c</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61c&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-01">MIT 18.01</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.01&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-02">MIT 18.02</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.02&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-06">MIT 18.06</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.06&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/6-04j">MIT 6.042J</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 6.042J&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs162">cs162</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs162&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs144">cs144</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs144&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/15-445">CMU 15-445</a><button aria-label="Toggle the collapsible sidebar category &#x27;CMU 15-445&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/assignments">assignments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/syllabus">syllabus-ËØæÁ®ãÂ§ßÁ∫≤</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/15-445/homework/homework01">homework</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/15-445/project/project01">project</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/project/project01">Project 0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/project/project02">Project 01</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/project/project03">Project 02</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/curriculum-resource/15-445/project/project04">Project 03</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/project/project05">Project 04</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/py4e">py4e</a><button aria-label="Toggle the collapsible sidebar category &#x27;py4e&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/ËØæÁ®ãËµÑÊ∫ê"><span itemprop="name">ËØæÁ®ãËµÑÊ∫ê</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/15-445"><span itemprop="name">CMU 15-445</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">project</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Project 03</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Project 03</h1></header><p>Remember to pull the latest code from the bustub repository. Do not post your code on a public GitHub repository.</p><h1>Overview</h1><p>At this point in the semester, you have implemented many internal components of a database management system.
In <a href="https://15445.courses.cs.cmu.edu/fall2024/project1" target="_blank" rel="noopener noreferrer">Project #1</a>, you implemented a buffer pool manager. In <a href="https://15445.courses.cs.cmu.edu/fall2024/project2" target="_blank" rel="noopener noreferrer">Project #2</a>, you implemented a b-plus tree index. In this project, you will implement the components that allow BusTub to execute queries. You will create the operator executors that execute SQL queries and implement optimizer rules to transform query plans.</p><p>This project is composed of several tasks:</p><ul><li><a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#task1" target="_blank" rel="noopener noreferrer"><strong>Task #1: Access Method Executors</strong></a></li><li><a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#task2" target="_blank" rel="noopener noreferrer"><strong>Task #2: Aggregation and Join Executors</strong></a></li><li><a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#task3" target="_blank" rel="noopener noreferrer"><strong>Task #3: HashJoin Executor and Optimization</strong></a></li><li><a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#task4" target="_blank" rel="noopener noreferrer"><strong>Task #4: External Merge Sort + Limit Executors</strong></a></li><li><a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#leaderboard" target="_blank" rel="noopener noreferrer"><strong>Optional Leaderboard Task</strong></a></li></ul><p>This project must be completed individually (i.e., no groups).
Before starting, run <code>git pull public master</code> to pull the latest code from the public <a href="https://github.com/cmu-db/bustub" target="_blank" rel="noopener noreferrer">BusTub repo</a>.</p><h1>Background</h1><p>Please read this section carefully because you will need to construct your own SQL queries to test your executor implementation. You can also use the <code>bustub shell</code> to understand:</p><ul><li>Use <code>EXPLAIN</code> or <code>EXPLAIN (o)</code> to show raw and optimized plans</li><li>Understand parameters in plan nodes (i.e., what the first and second 0 means in <code>#0.0</code>)</li><li>Read a few simple plan node implementations in <code>include/execution/plans/</code></li><li>Pay attention to various expression types in <code>include/execution/expressions/</code></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">‚Äã</a></h2><p>BusTub&#x27;s architecture is as follows:</p><p><a href="https://15445.courses.cs.cmu.edu/fall2024/project3/img/project-structure.svg" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/assets/images/project-structure-815d681d303c6c1953a34032587bb495.svg" width="960" height="720" class="img_ev3q"></a></p><p>In the public BusTub repository, we provide a full query processing layer. You can use the BusTub shell to execute SQL queries, much like in other database systems. Use the following command to compile and run the BusTub shell:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd build &amp;&amp; make -j$(nproc) shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./bin/bustub-shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also use <a href="https://15445.courses.cs.cmu.edu/fall2024/bustub/" target="_blank" rel="noopener noreferrer">BusTub Web Shell</a> to run the examples below. It is a complete reference solution of the system running in your browser!</p><p>Within the shell, you can use <code>\dt</code> to view all tables. By default, the BusTub shell will automatically create three tables that are pre-populated with data. This is provided as a convenience so that you do not need to load data every time you rebuild your solution. Changes to these tables will not be persisted when you restart the DBMS.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; \dt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----+----------------+------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| oid | name           | cols                         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----+----------------+------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 0   | __mock_table_1 | (colA:INTEGER, colB:INTEGER) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 1   | __mock_table_2 | (colC:VARCHAR, colD:VARCHAR) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2   | __mock_table_3 | (colE:INTEGER, colF:VARCHAR) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ... | ...            | ...                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----+----------------+------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can view all data from a table by using the <code>SELECT</code> statement:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; SELECT * FROM __mock_table_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------------+---------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| __mock_table_1.colA | __mock_table_1.colB |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------------+---------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 0                   | 0                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 1                   | 100                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2                   | 200                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 3                   | 300                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 4                   | 400                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 5                   | 500                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ...                 | ...                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------------+---------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Please note:</p><ul><li>BusTub only supports a small subset of SQL. Don&#x27;t be surprised if it does not work with some SQL queries. For all SQL queries supported in BusTub, refer to the SQLLogicTest files in <code>tests/sql</code>.</li><li>If you are using CLion to run the BusTub shell, please add a <code>--disable-tty</code> parameter to the shell, so that it works correctly in the CLion terminal.</li><li>Always end your statement with <code>;</code> (except internal commands).</li><li>BusTub only supports <code>INT</code> and <code>VARCHAR(n)</code> type. Also you should use single quotes for strings, e.g., <code>INSERT INTO table VALUES (&#x27;a&#x27;)</code>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="inspecting-sql-query-plans">Inspecting SQL Query Plans<a href="#inspecting-sql-query-plans" class="hash-link" aria-label="Direct link to Inspecting SQL Query Plans" title="Direct link to Inspecting SQL Query Plans">‚Äã</a></h2><p>BusTub supports the <code>EXPLAIN</code> command to print a query&#x27;s execution plan. You can add <code>EXPLAIN</code> in front of any query. For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN SELECT * FROM __mock_table_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== BINDER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BoundSelect {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  table=BoundBaseTableRef { table=__mock_table_1, oid=0 },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  columns=[__mock_table_1.colA, __mock_table_1.colB],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  groupBy=[],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  having=,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  where=,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  limit=,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  offset=,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  order_by=[],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  is_distinct=false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== PLANNER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Projection { exprs=[#0.0, #0.1] } | (__mock_table_1.colA:INTEGER, __mock_table_1.colB:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MockScan { table=__mock_table_1 } | (__mock_table_1.colA:INTEGER, __mock_table_1.colB:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MockScan { table=__mock_table_1 } | (__mock_table_1.colA:INTEGER, __mock_table_1.colB:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The result of <code>EXPLAIN</code> provides an overview of the transformation process within the query processing layer. The statement is first processed by the parser and the binder, which produces an abstract syntax tree (AST) representing the query. In this example, the query is represented by a <code>BoundSelect</code> on <code>__mock_table_1</code> that will retrieve two columns ( <code>colA</code> and <code>colB</code>). Note that the binder automatically expands the <code>*</code> character from the original SQL query into the actual columns in the table.</p><p>Next, the binder AST is processed by the planner, which will produce an appropriate query plan. In this case, the query plan is a tree of two nodes, with data flowing from the leaves to the root:</p><p><a href="https://15445.courses.cs.cmu.edu/fall2024/project3/img/mock_scan.svg" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/assets/images/mock_scan-8166f0b03b5d30b5cba6f8d182888bc9.svg" width="960" height="469" class="img_ev3q"></a></p><p>After that, the optimizer will optimize the query plan. In this case, it removes the projection because it is redundant.</p><p>Let&#x27;s consider a more complex example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN (o) SELECT colA, MAX(colB) FROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (SELECT * FROM __mock_table_1, __mock_table_3 WHERE colA = colE) GROUP BY colA;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Agg { types=[max], aggregates=[#0.1], group_by=[#0.0] }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NestedLoopJoin { type=Inner, predicate=(#0.0=#1.0) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MockScan { table=__mock_table_1 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MockScan { table=__mock_table_3 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For this example, the optimized query plan is:</p><p><a href="https://15445.courses.cs.cmu.edu/fall2024/project3/img/more_complex_example.svg" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/assets/images/more_complex_example-a7ebbeead255ddd642358743b9798d17.svg" width="960" height="720" class="img_ev3q"></a></p><p>In this project, you will need to construct SQL queries to test each of your executor&#x27;s implementations. <code>EXPLAIN</code> is extremely helpful for you to know if a SQL query is using a specific executor.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sample-executors">Sample Executors<a href="#sample-executors" class="hash-link" aria-label="Direct link to Sample Executors" title="Direct link to Sample Executors">‚Äã</a></h2><p>In the BusTub public repository, we provide several sample executor implementations.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="projection">Projection<a href="#projection" class="hash-link" aria-label="Direct link to Projection" title="Direct link to Projection">‚Äã</a></h3><p>A <strong>projection</strong> node can represent various computations on its input. It will always have exactly one child node. In the BusTub shell, inspect the query plans for the following queries:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT 1 + 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT colA FROM __mock_table_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT colA + colB AS a, 1 + 2 AS b FROM __mock_table_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A projection plan node consists of one or more expressions representing a computation:</p><ul><li><code>ColumnValueExpression</code>: directly places a column of the child executor to the output. The syntax <code>#0.0</code> means the first column in the first child. You will see something like <code>#0.0 = #1.0</code> in a plan for joins.</li><li><code>ConstantExpression</code>: represents a constant value (e.g., <code>1</code>).</li><li><code>ArithmeticExpression</code>: a tree representing an arithmetic computation. For example, <code>1 + 2</code> would be represented by an <code>ArithmeticExpression</code> with two <code>ConstantExpression</code> ( <code>1</code> and <code>2</code>) as children.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="filter">Filter<a href="#filter" class="hash-link" aria-label="Direct link to Filter" title="Direct link to Filter">‚Äã</a></h3><p>A <strong>filter</strong> plan node is used to filter the output of a child given a predicate. For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM __mock_table_1 WHERE colA &gt; 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A filter node has exactly one child and contains a predicate.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="values">Values<a href="#values" class="hash-link" aria-label="Direct link to Values" title="Direct link to Values">‚Äã</a></h3><p>A <strong>values</strong> plan node is used to directly produce values:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN values (1, 2, &#x27;a&#x27;), (3, 4, &#x27;b&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE table1(v1 INT, v2 INT, v3 VARCHAR(128));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN INSERT INTO table1 VALUES (1, 2, &#x27;a&#x27;), (3, 4, &#x27;b&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Values plan nodes are useful when inserting user-supplied values into a table.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="query-plan-syntax">Query Plan Syntax<a href="#query-plan-syntax" class="hash-link" aria-label="Direct link to Query Plan Syntax" title="Direct link to Query Plan Syntax">‚Äã</a></h2><p>As you might have noticed, <code>EXPLAIN</code> produces a string of column descriptions after each plan node. That&#x27;s the output schema of the node. Consider this example output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Projection { exprs=[#0.0, #0.1] } | (__mock_table_1.colA:INTEGER, __mock_table_1.colB:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This indicates that the executor representing this plan node will produce two columns, both of integer types. The output schema is inferred within the planner. For this project, your executor implementations must produce tuples with schema exactly as specified in the plan node, or they will fail our unit tests.</p><h1>Project Specification</h1><p>In this project, you will add new operator executors and query optimizations to BusTub. BusTub uses the iterator (i.e., Volcano) query processing model, in which every executor implements a <code>Next</code> function to get the next tuple result. When the DBMS invokes an executor&#x27;s <code>Next</code> function, the executor returns either (1) a single tuple or (2) an indicator that there are no more tuples. With this approach, each executor implements a loop that continues calling <code>Next</code> on its children to retrieve tuples and process them one by one.</p><p>In BusTub&#x27;s implementation of the iterator model, the <code>Next</code> function for each executor returns a record identifier ( <code>RID</code>) in addition to a tuple. A record identifier serves as a unique identifier for the tuple.</p><p>The executors are created from an execution plan in <a href="https://github.com/cmu-db/bustub/blob/master/src/execution/executor_factory.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/executor_factory.cpp</code></a>.</p><p>All test cases in this project are written in a special file format called SQLLogicTest (derived from SQLite). You can find how to use it at the end of this page.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1---access-method-executors">Task <!-- -->#<!-- -->1 - Access Method Executors<a href="#task-1---access-method-executors" class="hash-link" aria-label="Direct link to task-1---access-method-executors" title="Direct link to task-1---access-method-executors">‚Äã</a></h2><p>In the background section above, we saw that the BusTub can already retrieve data from mock tables in <code>SELECT</code> queries. This is implemented without real tables by using a <code>MockScan</code> executor to always generate the same tuples using a predefined algorithm. This is why you cannot update these tables.</p><p>In this task, you will implement executors that read from and write to tables in the storage system. You will complete your implementation in the following files:</p><ul><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/seq_scan_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/seq_scan_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/seq_scan_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/seq_scan_executor.cpp</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/insert_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/insert_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/insert_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/insert_executor.cpp</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/update_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/update_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/update_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/update_executor.cpp</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/delete_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/delete_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/delete_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/delete_executor.cpp</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/index_scan_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/index_scan_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/index_scan_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/index_scan_executor.cpp</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/optimizer/seqscan_as_indexscan.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/optimizer/seqscan_as_indexscan.cpp</code></a></li></ul><p>Each of these executors is described below.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="seqscan">SeqScan<a href="#seqscan" class="hash-link" aria-label="Direct link to SeqScan" title="Direct link to SeqScan">‚Äã</a></h3><p>The <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/seq_scan_plan.h" target="_blank" rel="noopener noreferrer"><code>SeqScanPlanNode</code></a> can be planned with a <code>SELECT * FROM table</code> statement.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; CREATE TABLE t1(v1 INT, v2 VARCHAR(100));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Table created with id = 15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN (o,s) SELECT * FROM t1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SeqScan { table=t1 } | (t1.v1:INTEGER, t1.v2:VARCHAR)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>SeqScanExecutor</code> iterates over a table and returns its tuples one at a time.</p><p><strong>Hint:</strong> Make sure that you understand the difference between the pre-increment and post-increment operators when using the <code>TableIterator</code> object. (Check <a href="https://en.cppreference.com/w/cpp/language/operator_incdec" target="_blank" rel="noopener noreferrer">here</a> for a quick refresher.)</p><p><strong>Hint:</strong> Do not emit tuples that are deleted in the <code>TableHeap</code>.
Check the <code>is_deleted_</code> field of the corresponding <a href="https://github.com/cmu-db/bustub/blob/master/src/include/storage/table/tuple.h" target="_blank" rel="noopener noreferrer"><code>TupleMeta</code></a> for each tuple.</p><p><strong>Hint:</strong> The output of sequential scan is a copy of each matched tuple and its original record identifier ( <code>RID</code>).</p><p><strong>Note:</strong> BusTub does not support <code>DROP TABLE</code> or <code>DROP INDEX</code>. You can reset your database by restarting the shell.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="insert">Insert<a href="#insert" class="hash-link" aria-label="Direct link to Insert" title="Direct link to Insert">‚Äã</a></h3><p>The <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/insert_plan.h" target="_blank" rel="noopener noreferrer"><code>InsertPlanNode</code></a> can be planned with an <code>INSERT</code> statement. Note that you will need to use a single quote to specify a <code>VARCHAR</code> value.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN (o,s) INSERT INTO t1 VALUES (1, &#x27;a&#x27;), (2, &#x27;b&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Insert { table_oid=15 } | (__bustub_internal.insert_rows:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Values { rows=2 } | (__values#0.0:INTEGER, __values#0.1:VARCHAR)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>InsertExecutor</code> inserts tuples into a table and updates any affected indexes. It has exactly one child producing values to be inserted into the table. The planner will ensure that the values have the same schema as the table. The executor will produce a single tuple of integer type as the output, indicating how many rows have been inserted into the table. Remember to update indexes when inserting into the table, if there are indexes associated with it.</p><p><strong>Hint:</strong> See the <a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#system-catalog" target="_blank" rel="noopener noreferrer">System Catalog</a> section below for information about the system catalog. To initialize this executor, you will need to look up information about the table being inserted into.</p><p><strong>Hint:</strong> See the <a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#index-updates" target="_blank" rel="noopener noreferrer">Index Updates</a> section below for further details about updating a table&#x27;s indexes.</p><p><strong>Hint:</strong> You will need to use the <a href="https://github.com/cmu-db/bustub/blob/master/src/include/storage/table/table_heap.h" target="_blank" rel="noopener noreferrer"><code>TableHeap</code></a> class to perform table modifications.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="update">Update<a href="#update" class="hash-link" aria-label="Direct link to Update" title="Direct link to Update">‚Äã</a></h3><p>The <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/update_plan.h" target="_blank" rel="noopener noreferrer"><code>UpdatePlanNode</code></a> can be planned with an <code>UPDATE</code> statement. It has exactly one child with the records to be updated in the table.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; explain (o,s) update test_1 set colB = 15445;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Update { table_oid=20, target_exprs=[#0.0, 15445, #0.2, #0.3] } | (__bustub_internal.update_rows:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SeqScan { table=test_1 } | (test_1.colA:INTEGER, test_1.colB:INTEGER, test_1.colC:INTEGER, test_1.colD:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>UpdateExecutor</code> modifies existing tuples in a specified table. The executor will produce a single tuple of integer type as the output, indicating how many rows have been updated. Remember to update any indexes affected by the updates.</p><p><strong>Hint:</strong> To implement an update, first delete the affected tuple and then insert a new tuple.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="delete">Delete<a href="#delete" class="hash-link" aria-label="Direct link to Delete" title="Direct link to Delete">‚Äã</a></h3><p>The <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/delete_plan.h" target="_blank" rel="noopener noreferrer"><code>DeletePlanNode</code></a> can be planned with a <code>DELETE</code> statement. It has exactly one child with the records to be deleted from the table. Your delete executor should produce an integer output that represents the number of rows that it deleted from the table. It will also need to update any affected indexes.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN (o,s) DELETE FROM t1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Delete { table_oid=15 } | (__bustub_internal.delete_rows:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Filter { predicate=true } | (t1.v1:INTEGER, t1.v2:VARCHAR)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SeqScan { table=t1 } | (t1.v1:INTEGER, t1.v2:VARCHAR)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN (o,s) DELETE FROM t1 where v1 = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Delete { table_oid=15 } | (__bustub_internal.delete_rows:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Filter { predicate=#0.0=1 } | (t1.v1:INTEGER, t1.v2:VARCHAR)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SeqScan { table=t1 } | (t1.v1:INTEGER, t1.v2:VARCHAR)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You may assume that the <code>DeleteExecutor</code> is always at the root of the query plan in which it appears. The <code>DeleteExecutor</code> should not modify its result set.</p><p><strong>Hint:</strong> To delete a tuple, you need to get a <code>RID</code> from the child executor and update the <code>is_deleted_</code> field of the corresponding <a href="https://github.com/cmu-db/bustub/blob/master/src/include/storage/table/tuple.h" target="_blank" rel="noopener noreferrer"><code>TupleMeta</code></a> for that tuple.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="indexscan">IndexScan<a href="#indexscan" class="hash-link" aria-label="Direct link to IndexScan" title="Direct link to IndexScan">‚Äã</a></h3><p>The <code>IndexScanExecutor</code> does point lookup and ordered scan using the b-plus tree index to retrieve tuples in the table. The executor should be able to support several point lookups on the same index.</p><p>You will need to implement the index scan by supporting the following two types of queries:</p><ol><li>Point Lookup: <code>SELECT FROM &lt;table&gt; WHERE &lt;index column&gt; = &lt;val&gt;</code>. You will implement the optimizer rule to transform a <code>SeqScan</code> into an <code>IndexScan</code> in the next section.</li><li>Ordered Scan: <code>SELECT FROM &lt;table&gt; ORDER BY &lt;index column&gt;</code>. The optimizer rule to generate an <code>IndexScan</code> for queries with <code>ORDER BY</code> on an index column has been implemented for you. Your task is to handle <code>ASC</code> (or default) ordering only in <code>IndexScan</code>.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; CREATE TABLE t1(v1 int, v2 int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Table created with id = 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; CREATE INDEX t1v1 ON t1(v1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Index created with id = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN (o,s) SELECT * FROM t1 WHERE v1 = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IndexScan { index_oid=0, filter=(#0.0=1) } | (t1.v1:INTEGER, t1.v2:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN (o,s) SELECT * FROM t1 ORDER BY v1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IndexScan { index_oid=0 } | (t1.v1:INTEGER, t1.v2:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The type of the index object in the plan will always be <code>BPlusTreeIndexForTwoIntegerColumn</code> in this project. You can safely cast the object to this type and store it in the executor wherever needed:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tree_ = dynamic_cast&lt;BPlusTreeIndexForTwoIntegerColumn *&gt;(index_info_-&gt;index_.get())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can then do point lookup or ordered scan with the b-plus tree index and emit the satisfying tuple. In this semester, you only need to support the index on a single, unique integer column. Our test cases will not contain duplicate keys. Hence, this executor returns one tuple per point lookup if it exists.</p><p>You will need to finish the optimizer rule in the next section to transform a <code>SeqScan</code> into an <code>IndexScan</code>. It may make more sense to <strong>implement the optimizer rule before implementing <code>IndexScan</code></strong> to understand the kind of queries <code>IndexScanExecutor</code> will need to support.</p><p><strong>Hint:</strong> We will never insert duplicate rows into tables with indexes.</p><p><strong>Hint:</strong> As above, do not emit tuples that are deleted.</p><p><strong>Hint:</strong> Please use <code>ScanKey</code> for the point lookup, and use <code>Index Iterator</code> for the ordered scan.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="optimizing-seqscan-to-indexscan">Optimizing SeqScan to IndexScan<a href="#optimizing-seqscan-to-indexscan" class="hash-link" aria-label="Direct link to Optimizing SeqScan to IndexScan" title="Direct link to Optimizing SeqScan to IndexScan">‚Äã</a></h3><p>As we learned in lecture, when we are querying on the indexed column, using an IndexScan will significantly boost the lookup performance. To this end, we need to push down the filter into the scanner so that we know the key to lookup in the index. Then we can directly retrieve the value over the index, instead of doing a full table scan.</p><p>You would need to modify the optimizer to transform a <code>SeqScanPlanNode</code> into a <code>IndexScanPlanNode</code> when it is possible.</p><p>Consider the following example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN (o) SELECT * FROM t1 WHERE v1 = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Without applying the MergeFilterScan and the SeqScan as IndexScan optimizer rule, the plan may look like the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> Filter { predicate=(#0.0=1) } | (t1.v1:INTEGER, t1.v2:INTEGER, t1.v3:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SeqScan { table=t1 } | (t1.v1:INTEGER, t1.v2:INTEGER, t1.v3:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After applying the MergeFilterScan and SeqScan as IndexScan optimizer rule, we can just do a quick index lookup instead of iterating the entire table. The resulting plan will look like the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> IndexScan { index_oid=0, filter=(#0.0=1) } | (t1.v1:INTEGER, t1.v2:INTEGER, t1.v3:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here&#x27;s the brief steps to implement this optimizer rule:</p><ol><li><p><strong>Enable Predicate pushdown to SeqScan:</strong> We can implement a predicate filter in SeqScanExecutor so that later the index scan node will have the predicate. We&#x27;ve already enabled MergeFilterScan optimizer rule <a href="https://github.com/cmu-db/bustub/blob/master/src/optimizer/merge_filter_scan.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/optimizer/merge_filter_scan.cpp</code></a> in the starter optimizer rules for you.</p></li><li><p><strong>Use Index:</strong> You can check the filtering columns from the predicate. If there happens to exist an index on this column, create an IndexScanPlanNode. Note that to get full score, you will need to support this optimizer rule in a few different situations: (1) when there&#x27;s one equality test on the indexed column in predicate (i.e., <code>WHERE v1 = 1</code>) (2) when the indexed column ordering is flipped (i.e., <code>WHERE 1 = v1</code>) (3) when there are several point lookups on the same index (i.e., <code>WHERE v1 = 1 or v1 = 4</code>). Note that queries of the form <code>SELECT * FROM t1 WHERE v1 = 1 AND v2 = 2</code> should still use a seq scan, thus you do not need to split the predicates.</p></li></ol><p>Please check <a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#optimizer-guide" target="_blank" rel="noopener noreferrer">Optimizer Rule Implementation Guide</a> section for details on implementing an optimizer rule.</p><p>Now that you have implemented all storage related executors. In the following tasks, you can create tables and insert some values by yourself to test your own executor implementation! At this point, you should also have passed <a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#testing" target="_blank" rel="noopener noreferrer">SQLLogicTests #1 to #6</a>.</p><p><strong>Hint:</strong> You may find the utility <code>BPlusTreeIndex::ScanKey</code> function helpful.</p><p><strong>Hint:</strong> Think about how to handle queries of the form <code>WHERE v1 = 1 OR v1 = 1</code>. It may help to view <code>AggregateKey</code> in <code>/src/include/execution/plans/aggregation_plan.h</code>.</p><p><strong>Hint:</strong> Please only optimize <code>SeqScan</code> to <code>IndexScan</code> in the 2 scenarios mentioned above (i.e. point lookup and ordered scan).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2---aggregation--join-executors">Task <!-- -->#<!-- -->2 - Aggregation &amp; Join Executors<a href="#task-2---aggregation--join-executors" class="hash-link" aria-label="Direct link to task-2---aggregation--join-executors" title="Direct link to task-2---aggregation--join-executors">‚Äã</a></h2><p>You will complete your implementation in the following files:</p><ul><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/aggregation_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/aggregation_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/aggregation_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/aggregation_executor.cpp</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/nested_loop_join_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/nested_loop_join_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/nested_loop_join_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/nested_loop_join_executor.cpp</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/nested_index_join_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/nested_index_join_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/nested_index_join_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/nested_index_join_executor.cpp</code></a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aggregation">Aggregation<a href="#aggregation" class="hash-link" aria-label="Direct link to Aggregation" title="Direct link to Aggregation">‚Äã</a></h3><p>The <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/aggregation_plan.h" target="_blank" rel="noopener noreferrer"><code>AggregationPlanNode</code></a> is used to support queries like the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT colA, MIN(colB) FROM __mock_table_1 GROUP BY colA;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT COUNT(colA), min(colB) FROM __mock_table_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT colA, MIN(colB) FROM __mock_table_1 GROUP BY colA HAVING MAX(colB) &gt; 10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT DISTINCT colA, colB FROM __mock_table_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The aggregation executor computes an aggregation function for each group of input. It has exactly one child.
The output schema consists of the group-by columns followed by the aggregation columns.</p><p>As discussed in class, a common strategy for implementing aggregation is to use a hash table, with the group-by columns as the key. In this project, you may assume that the aggregation hash table fits in memory. This means that you do not need to implement a multi-stage, partition-based strategy, and the hash table does not need to be backed by buffer pool pages.</p><p>We provide a <code>SimpleAggregationHashTable</code> data structure that exposes an in-memory hash table ( <code>std::unordered_map</code>) but with an interface designed for computing aggregations. This class also exposes an <code>SimpleAggregationHashTable::Iterator</code> type that can be used to iterate through the hash table. You will need to complete the <code>CombineAggregateValues</code> function for this class.</p><p>The aggregation executor itself will not need to handle the <code>HAVING</code> predicate. The planner will plan aggregations with a <code>HAVING</code> clause as an <code>AggregationPlanNode</code> followed by a <code>FilterPlanNode</code>.</p><p><strong>Hint:</strong> In the context of a query plan, aggregations are <em>pipeline breakers</em>. This may influence the way that you use the <code>AggregationExecutor::Init()</code> and <code>AggregationExecutor::Next()</code> functions in your implementation. Carefully decide whether the build phase of the aggregation should be performed in <code>AggregationExecutor::Init()</code> or <code>AggregationExecutor::Next()</code>.</p><p><strong>Hint:</strong> You must handle NULL values in the input of the aggregation functions (i.e., a tuple may have a NULL value for the attribute used in the aggregation function). See test cases for expected behavior. Group-by columns will never be NULL.</p><p><strong>Hint:</strong> When performing aggregation on an empty table, <code>CountStarAggregate</code> should return zero and all other aggregate types should return <code>integer_null</code>. This is why <code>GenerateInitialAggregateValue</code> initializes most aggregate values as NULL.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nestedloopjoin">NestedLoopJoin<a href="#nestedloopjoin" class="hash-link" aria-label="Direct link to NestedLoopJoin" title="Direct link to NestedLoopJoin">‚Äã</a></h3><p>The DBMS will use <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/nested_loop_join_plan.h" target="_blank" rel="noopener noreferrer"><code>NestedLoopJoinPlanNode</code></a> for all join operations, by default. Consider the following example queries:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM __mock_table_1, __mock_table_3 WHERE colA = colE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM __mock_table_1 INNER JOIN __mock_table_3 ON colA = colE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM __mock_table_1 LEFT OUTER JOIN __mock_table_3 ON colA = colE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You will need to implement an inner join and <a href="https://en.wikipedia.org/wiki/Join_(SQL)#Left_outer_join" target="_blank" rel="noopener noreferrer">left join</a> for the <code>NestedLoopJoinExecutor</code> using the simple nested loop join algorithm from class. The output schema of this operator is all columns from the left table followed by all columns from the right table.
For each tuple in the outer table, consider each tuple in the inner table and emit an output tuple if the join predicate is satisfied.</p><p><strong>Hint:</strong> You should use the predicate in the <code>NestedLoopJoinPlanNode</code>. See <code>AbstractExpression::EvaluateJoin</code>, which handles the left tuple and right tuple and their respective schemas. Note that this returns a <code>Value</code>, which could be false, true, or NULL. See <code>FilterExecutor</code> for how to apply predicates on tuples.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nestedindexjoin">NestedIndexJoin<a href="#nestedindexjoin" class="hash-link" aria-label="Direct link to NestedIndexJoin" title="Direct link to NestedIndexJoin">‚Äã</a></h3><p>The DBMS will use <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/nested_index_join_plan.h" target="_blank" rel="noopener noreferrer"><code>NestedIndexJoinPlanNode</code></a> if the query contains a join with an equi-condition and the right side of the join has an index over the condition.</p><p>Consider the following example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE t1(v1 int, v2 int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE t2(v3 int, v4 int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE INDEX t2v3 on t2(v3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM t1 INNER JOIN t2 ON v1 = v3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== PLANNER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Projection { exprs=[#0.0, #0.1, #0.2, #0.3] } | (t1.v1:INTEGER, t1.v2:INTEGER, t2.v3:INTEGER, t2.v4:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NestedLoopJoin { predicate=#0.0=#1.0 } | (t1.v1:INTEGER, t1.v2:INTEGER, t2.v3:INTEGER, t2.v4:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SeqScan { table=t1 } | (t1.v1:INTEGER, t1.v2:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SeqScan { table=t2 } | (t2.v3:INTEGER, t2.v4:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=== OPTIMIZER ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NestedIndexJoin { type=Inner, key_predicate=#0.0, index=t2v3, index_table=t2 } | (t1.v1:INTEGER, t1.v2:INTEGER, t2.v3:INTEGER, t2.v4:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SeqScan { table=t1 } | (t1.v1:INTEGER, t1.v2:INTEGER)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the plan phase, the query is planned as a <code>NestedLoopJoin</code> of two tables. The optimizer identifies that the right side of the join ( <code>SeqScan t2</code>) has an index on column <code>v3</code>, and the join condition is an equi-condition <code>v1 = v3</code>. This means that for all tuples from the left side, the system can use the key <code>v1</code> to query the index <code>t2v3</code> to produce the join result.</p><p>The schema of <code>NestedIndexJoin</code> is all columns from the left table (child, outer) and then from the right table (index, inner). This executor will have only one child that propagates tuples corresponding to the outer table of the join. For each of these tuples, you will need to find the corresponding tuple in the inner table that matches the index key given by utilizing the index in the catalog.</p><p><strong>Hint:</strong> You will want to fetch the tuple from the outer table, construct the index probe key by using <code>key_predicate</code>, and then look up the RID in the index to retrieve the corresponding tuple for the inner table.</p><p>We will provide all test cases on Gradescope AS-IS. We will not test with strange edge cases involving NULLs (such as NULLs in the group-by clause or in indexes). At this point, you should pass <a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#testing" target="_blank" rel="noopener noreferrer">SQLLogicTests - #7 to #13</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3---hashjoin-executor-and-optimization">Task <!-- -->#<!-- -->3 - HashJoin Executor and Optimization<a href="#task-3---hashjoin-executor-and-optimization" class="hash-link" aria-label="Direct link to task-3---hashjoin-executor-and-optimization" title="Direct link to task-3---hashjoin-executor-and-optimization">‚Äã</a></h2><p>You will complete your implementation in the following files:</p><ul><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/hash_join_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/hash_join_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/hash_join_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/hash_join_executor.cpp</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/optimizer/nlj_as_hash_join.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/optimizer/nlj_as_hash_join.cpp</code></a></li></ul><p>You need to implement <code>NestedLoopJoinExecutor</code> in <a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#task2" target="_blank" rel="noopener noreferrer">Task #2</a> before starting this task.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hashjoin">HashJoin<a href="#hashjoin" class="hash-link" aria-label="Direct link to HashJoin" title="Direct link to HashJoin">‚Äã</a></h3><p>The DBMS can use <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/hash_join_plan.h" target="_blank" rel="noopener noreferrer"><code>HashJoinPlanNode</code></a> if a query contains a join with a conjunction of several equi-conditions between two columns (equi-conditions are seperated by <code>AND</code>). Consider the following example queries:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM __mock_table_1, __mock_table_3 WHERE colA = colE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM __mock_table_1 INNER JOIN __mock_table_3 ON colA = colE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM __mock_table_1 LEFT OUTER JOIN __mock_table_3 ON colA = colE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM test_1 t1, test_2 t2 WHERE t1.colA = t2.colA AND t1.colB = t2.colC;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM test_1 t1 INNER JOIN test_2 t2 on t1.colA = t2.colA AND t2.colC = t1.colB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM test_1 t1 LEFT OUTER JOIN test_2 t2 on t2.colA = t1.colA AND t2.colC = t1.colB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You will need to implement the inner join and <a href="https://en.wikipedia.org/wiki/Join_(SQL)#Left_outer_join" target="_blank" rel="noopener noreferrer">left join</a> for <code>HashJoinExecutor</code> using the hash join algorithm from class. The output schema of this operator is all columns from the left table followed by all columns from the right table. As with aggregation, you may assume that the hash table used by the join fits entirely in memory.</p><p>Your implementation should correctly handle the case where multiple tuples have hash collisions (on either side of the join). You will want to make use of the join key accessors functions <code>GetLeftJoinKey()</code> and <code>GetRightJoinKey()</code> in the <code>HashJoinPlanNode</code> to construct the join keys for the left and right sides of the join, respectively.</p><p><strong>Hint:</strong> You will need a way to hash a tuple with multiple attributes in order to construct a unique key. As a starting point, take a look at how the <code>SimpleAggregationHashTable</code> in the <code>AggregationExecutor</code> implements this functionality.</p><p><strong>Hint:</strong> As with aggregation, the build side of a hash join is a <em>pipeline breaker</em>. You should again consider whether the <em>build</em> phase of the hash join should be performed in <code>HashJoinExecutor::Init()</code> or <code>HashJoinExecutor::Next()</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="optimizing-nestedloopjoin-to-hashjoin">Optimizing NestedLoopJoin to HashJoin<a href="#optimizing-nestedloopjoin-to-hashjoin" class="hash-link" aria-label="Direct link to Optimizing NestedLoopJoin to HashJoin" title="Direct link to Optimizing NestedLoopJoin to HashJoin">‚Äã</a></h3><p>Hash joins usually yield better performance than nested loop joins.
You should modify the optimizer to transform a <code>NestedLoopJoinPlanNode</code> into a <code>HashJoinPlanNode</code> when it is possible to use a hash join. Specifically, the hash join algorithm can be used when a join predicate is a conjunction of several equi-conditions between two columns. For this project, you should be able to handle a varying number of equi-conditions connected by <code>AND</code>.</p><p>Consider the following example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bustub&gt; EXPLAIN (o) SELECT * FROM test_1 t1, test_2 t2 WHERE t1.colA = t2.colA AND t1.colB = t2.colC;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Without applying the <code>NLJAsHashJoin</code> optimizer rule, the plan may look like:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> NestedLoopJoin { type=Inner, predicate=((#0.0=#1.0)and(#0.1=#1.2)) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SeqScan { table=test_1 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SeqScan { table=test_2 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After applying the <code>NLJAsHashJoin</code> optimizer rule, the left and right join key expressions will be extracted from the single
join predicate in the <code>NestedLoopJoinPlanNode</code>. The resulting plan will look like:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> HashJoin { type=Inner, left_key=[#0.0, #0.1], right_key=[#0.0, #0.2] }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SeqScan { table=test_1 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   SeqScan { table=test_2 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Please check the <a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#optimizer-guide" target="_blank" rel="noopener noreferrer">Optimizer Rule Implementation Guide</a> section for details on implementing an optimizer rule. At this point, you should pass <a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#testing" target="_blank" rel="noopener noreferrer">SQLLogicTests - #14 to #15</a>.</p><p><strong>Hint:</strong> Make sure to check which table the column belongs to for each side of the equi-condition. It is possible that the column from outer table is on the right side of the equi-condition. You may find <code>ColumnValueExpression::GetTupleIdx</code> helpful.</p><p><strong>Hint:</strong> The order to apply optimizer rules matters. For example, you want to optimize NestedLoopJoin into HashJoin after filters and NestedLoopJoin have merged.</p><p><strong>Hint</strong> When dealing with multiple equi-conditions, try to extract out the keys recursively, instead of matching the joining condition with multiple layers of if clauses.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-external-merge-sort--limit-executors">Task <!-- -->#<!-- -->4: External Merge Sort + Limit Executors<a href="#task-4-external-merge-sort--limit-executors" class="hash-link" aria-label="Direct link to task-4-external-merge-sort--limit-executors" title="Direct link to task-4-external-merge-sort--limit-executors">‚Äã</a></h2><p>You will complete your implementation in the following files:</p><ul><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/external_merge_sort_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/external_merge_sort_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/external_merge_sort_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/external_merge_sort_executor.cpp</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/limit_executor.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/execution/limit_executor.h</code></a></li><li><a href="https://github.com/cmu-db/bustub/blob/master/src/execution/limit_executor.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/execution/limit_executor.cpp</code></a></li></ul><p>You need to implement <code>IndexScanExecutor</code> in <a href="https://15445.courses.cs.cmu.edu/fall2024/project3/#task1" target="_blank" rel="noopener noreferrer">Task #1</a> before starting this task. If there is an index over a table, the query processing layer will automatically pick it for sorting. In other cases, you will need a special sort executor to do this, which, in our case, is the external merge sort executor.</p><p>The limit executor will be much easier to implement than the external merge sort executor. Therefore, feel free to implement the limit executor first if you are stuck on the external merge sort executor. You should however be aware that we won&#x27;t test the limit executor without the external merge sort executor.</p><p>For all <code>ORDER BY</code> clauses, we assume every sort key will only appear once. You do not need to worry about ties in sorting.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="external-merge-sort">External Merge Sort<a href="#external-merge-sort" class="hash-link" aria-label="Direct link to External Merge Sort" title="Direct link to External Merge Sort">‚Äã</a></h3><p>Except in the case that the <code>ORDER BY</code> attributes matches the keys of an index, BusTub will use a <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/sort_plan.h" target="_blank" rel="noopener noreferrer"><code>SortPlanNode</code></a> for all <code>ORDER BY</code> operators.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM __mock_table_1 ORDER BY colA ASC, colB DESC;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This plan node does not change schema (i.e., the output schema is the same as the input schema). You can extract sort keys from <code>order_bys</code>. If the query does not include a sort direction in the <code>ORDER BY</code> clause (i.e., <code>ASC</code>, <code>DESC</code>), then the sort mode will be <code>default</code> (which is <code>ASC</code>).</p><p>One important assumption about the external merge sort is that the entries in a table will NOT be able to fit in memory. Therefore, you need to follow what you learned in the lecture: store the intermediate sorting results in temporary pages and do merge sort recursively based on the sorted results of the previous round.</p><p>As you may be aware of, a specific page format will be needed for the intermediate sorting results. In this project, you will be the one who designs the page format. Take a look at <code>external_merge_sort_executor.h</code> and you will find <code>SortPage</code>, which is dedicated for storing the intermediate sorting results but contains minimal pre-defined members/methods. You should design the page layout and implement the read/write methods for the page.</p><p>You will then implement the merge sort algorithm. It is not hard to do an in-memory merge sort. But when it involves the disk, you should carefully think of how you manipulate the sorted tuples via the page interfaces and the buffer pool. It is worth noting that the page that&#x27;s no longer in use (i.e. from the previous round of merge sort) should be deleted, or you will have a bunch of &quot;zombie&quot; pages that will never be referred to but still exist in the buffer pool.</p><p>To simplify your implementation of <code>SortPage</code>, <strong>we will only test on sorting fixed-length tuples in this semester.</strong> That is to say, we will not sort tuples containing <code>VARCHAR</code> attributes. Also, <strong>we will only test on two-way external merge sort this semester</strong> even though <code>ExternalMergeSortExecutor</code> is templated. Therefore, feel free to implement a two-way merge sort algorithm instead of a k-way one.</p><p>However, it&#x27;s important that your are doing the merge sort <em>externally</em> (not storing all data purely in memory). You are allowed to use <code>std::sort</code> to sort tuples fitting within one sort page, but NOT on all tuples. Also, your <code>SortPage</code> layout should be compact, i.e. as little fragmentation as possible. You should also make sure that the pages are actually deleted after the merge sort is done.</p><p><strong>Hint:</strong> For comparison of tuples based on the sort key, we provide a helper class <code>TupleComparator</code> in <code>execution_common.h</code>. We also provide a helper function <code>GenerateSortKey</code>, which you may find helpful when sorting the tuples.</p><p><strong>Hint:</strong> To better understand what to do and where to start for <code>SortPage</code>, you can take a look at the layout of the index pages you worked on in project 2 (e.g. a <code>char</code> array can be used as the start of page data). You may find <code>Schema::GetInlinedStorageSize</code> helpful given the assumption that we only test on fixed-length data. Also, it would be helpful to think of how your executor will call the read/write methods.</p><p><strong>Hint:</strong> You don&#x27;t really need to manually manipulate the &quot;write-to-disk&quot; part when doing the external merge sort. The buffer pool manager will handle this for you. Remember what you implemented in P1: the page guard will automatically pin and unpin a page, as well as setting the evictability. Just make proper use of the page guard and you will not be worrying too much for page manipulation in this project.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="limit">Limit<a href="#limit" class="hash-link" aria-label="Direct link to Limit" title="Direct link to Limit">‚Äã</a></h3><p>The <a href="https://github.com/cmu-db/bustub/blob/master/src/include/execution/plans/limit_plan.h" target="_blank" rel="noopener noreferrer"><code>LimitPlanNode</code></a> specifies the number of tuples that query will generate. Consider the following example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EXPLAIN SELECT * FROM __mock_table_1 LIMIT 10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>LimitExecutor</code> constrains the number of output tuples from its child executor. If the number of tuples produced by its child executor is less than the limit specified in the plan node, this executor has no effect and yields all of the tuples that it receives.</p><p>This plan node does not change schema (i.e., the output schema is the same as the input schema). You do not need to support offsets.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="optional-leaderboard-tasks">Optional Leaderboard Tasks<a href="#optional-leaderboard-tasks" class="hash-link" aria-label="Direct link to Optional Leaderboard Tasks" title="Direct link to Optional Leaderboard Tasks">‚Äã</a></h2><p>For this project&#x27;s leaderboard challenge, you should implement new executors and optimizer rules to make the system execute the following queries as fast as possible.</p><p>These tasks are optional. You do not need to complete them to get a perfect score on the project. Unlike previous projects, segfaults and timeouts in project 3 leaderboard tests will not affect your score.</p><p>It is possible that your implementation will produce different results for existing queries after implementing the leaderboard optimizations. We require you to pass all tests after implementing new optimization rules. We will also force using starter rules for some test cases. For example, in order to ensure your index scan executor works, we force the starter rule in this sqllogictest file with <code>set force_optimizer_starter_rule=yes</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-1-too-many-joins">Query 1: Too Many Joins!<a href="#query-1-too-many-joins" class="hash-link" aria-label="Direct link to Query 1: Too Many Joins!" title="Direct link to Query 1: Too Many Joins!">‚Äã</a></h3><p>Consider the following sample database:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE t4(x int, y int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE t5(x int, y int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE TABLE t6(x int, y int);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The user is not from CMU and they are writing terrible SQL. They forgot how write queries with joins so they puts all predicates in the <code>WHERE</code> clause.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT * FROM t4, t5, t6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WHERE (t4.x = t5.x) AND (t5.y = t6.y) AND (t4.y &gt;= 1000000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AND (t4.y &lt; 1500000) AND (t6.x &gt;= 100000) AND (t6.x &lt; 150000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Recommended Optimizations:</strong> Decompose the filter condition to extract hash join keys, and push down the remaining filter conditions to be below the hash join.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-2-the-mad-data-scientist">Query 2: The Mad Data Scientist<a href="#query-2-the-mad-data-scientist" class="hash-link" aria-label="Direct link to Query 2: The Mad Data Scientist" title="Direct link to Query 2: The Mad Data Scientist">‚Äã</a></h3><p>There is a data scientist invested all their money in NFTs. After realizing their terrible mistake, they go crazy and starts writing some weird SQL queries. Consider the following example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT v, d1, d2 FROM (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SELECT v,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         MAX(v1) AS d1, MIN(v1), MAX(v2), MIN(v2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         MAX(v1) + MIN(v1), MAX(v2) + MIN(v2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         MAX(v1) + MAX(v1) + MAX(v2) AS d2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FROM t7 LEFT JOIN (SELECT v4 FROM t8 WHERE 1 == 2) ON v &lt; v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GROUP BY v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>(This is not the same as the actual leaderboard query; refer to the test file.)</p><p><strong>Recommended Optimizations:</strong></p><ul><li>Column pruning ‚Äì you only need to compute v, d1, d2 from the left table in aggregation. We&#x27;ve provided a skeleton file <code>column_pruning.cpp</code>.</li><li>Common expression elimination, transform always false filter to dummy scan (values plan node of zero rows)</li><li>Some more if you could think of :)</li></ul><p><strong>Hint:</strong> You do not need to implement a complete rule for optimizing these queries. (1) a complete predicate pushdown requires you to handle all plan nodes ‚Äì limit, order by, etc. But to optimize for Q2, you only need to implement push down predicates over hash join / nested loop joins. (2) a complete join reordering requires you to handle predicates correctly (and maybe absorb filters in-between back to the join predicate), and you do not need to do that. Just make your optimizer work with those queries is enough.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-3-all-that-work-for-nothing">Query 3: All that work, for nothing?<a href="#query-3-all-that-work-for-nothing" class="hash-link" aria-label="Direct link to Query 3: All that work, for nothing?" title="Direct link to Query 3: All that work, for nothing?">‚Äã</a></h3><p>After all the hard work with Q1 and Q2, here&#x27;s something short and sweet. Imagine you have the following 2 tables representing everyone alive in the 1950s, and everyone born in the 1600s. Someone with no concept of human lifespan (or a firm belief in vampires) tries to construct a query that outputs the intersection of the 2 tables. You know the result will be empty, but your join executors won&#x27;t, what can you do to help speed up the process?</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT * FROM alive_in_1950s a INNER JOIN born_in_1600s b ON a.birthday = b.birthday</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>(This is not the same as the actual leaderboard query; refer to the test file.)</p><p><strong>Recommended Optimizations:</strong> Bloom filter for the hash table used during the build phase of the hash join.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="leaderboard-policy">Leaderboard Policy<a href="#leaderboard-policy" class="hash-link" aria-label="Direct link to Leaderboard Policy" title="Direct link to Leaderboard Policy">‚Äã</a></h3><ul><li>Submissions <em>with leaderboard bonus</em> are subject to manual review by TAs.<ul><li>By saying &quot;review&quot;, it means that TAs will manually look into your code, or if they are unsure whether an optimization is correct or not by looking, they will make simple modification to existing test cases to see if your leaderboard optimization <em>correctly</em> handled the specific cases that you want to optimize.</li><li>One example of simple modification: change the buffer pool manager size for the benchmark.</li></ul></li><li>Your optimization should not affect correctness. You can optimize for specific cases, but it should work for all inputs in your optimized cases.<ul><li>Allowed: only handling 3-table join reordering in Fall 2022 project 3.</li><li>Allowed: optimize for leaf node size &gt; 100 in project 2.</li><li>Disallowed: compare the plan with the leaderboard test and convert it to ValueExecutor with the output table in project 3. That‚Äôs because your optimization should work for all table contents. Hardcoding the answer will yield wrong result in some cases.</li></ul></li><li>You should not try detecting whether your submission is running leaderboard test by using side information.<ul><li>Unless we allow you to do so.</li><li>Disallowed: use¬†<code>#ifdef NDEBUG</code>, etc.</li></ul></li><li>Submissions with obvious correctness issues will not be assigned leaderboard bonus.</li><li>You cannot use late days for leaderboard tests.</li><li>If you are unsure about whether an optimization is reasonable, you should post on Piazza or visit any TA&#x27;s office hour.</li></ul><h1>Additional Information</h1><p>This section provides some additional information on other system components in BusTub that you will need to interact in order to complete this project.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="system-catalog">System Catalog<a href="#system-catalog" class="hash-link" aria-label="Direct link to System Catalog" title="Direct link to System Catalog">‚Äã</a></h2><p>A database maintains an internal catalog to keep track of meta-data about the database. In this project, you will interact with the system catalog to query information regarding tables, indexes, and their schemas.</p><p>The entirety of the catalog implementation is in <a href="https://github.com/cmu-db/bustub/blob/master/src/include/catalog/catalog.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/catalog/catalog.h</code></a>. You should pay particular attention to the member functions <code>Catalog::GetTable()</code> and <code>Catalog::GetIndex()</code>. You will use these functions in the implementation of your executors to query the catalog for tables and indexes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="index-updates">Index Updates<a href="#index-updates" class="hash-link" aria-label="Direct link to Index Updates" title="Direct link to Index Updates">‚Äã</a></h2><p>For the table modification executors ( <code>InsertExecutor</code>, <code>UpdateExecutor</code>, and <code>DeleteExecutor</code>) you must modify all indexes for the table targeted by the operation. You may find the <code>Catalog::GetTableIndexes()</code> function useful for querying all of the indexes defined for a particular table. Once you have the <code>IndexInfo</code> instance for each of the table&#x27;s indexes, you can invoke index modification operations on the underlying index structure.</p><p>In this project, we use your implementation of b-plus tree index from <a href="https://15445.courses.cs.cmu.edu/fall2024/project2" target="_blank" rel="noopener noreferrer">Project #2</a> as the underlying data structure for all index operations. Therefore, successful completion of this project relies on a working implementation of the b-plus tree.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="optimizer-rule-implementation-guide">Optimizer Rule Implementation Guide<a href="#optimizer-rule-implementation-guide" class="hash-link" aria-label="Direct link to Optimizer Rule Implementation Guide" title="Direct link to Optimizer Rule Implementation Guide">‚Äã</a></h2><p>The BusTub optimizer is a rule-based optimizer. Most optimizer rules construct optimized plans in a bottom-up way. Because the query plan has this tree structure, before applying the optimizer rules to the current plan node, you want to first recursively apply the rules to its children.</p><p>At each plan node, you should determine if the source plan structure matches the one you are trying to optimize, and then check the attributes in that plan to see if it can be optimized into the target optimized plan structure.</p><p>In the public BusTub repository, we already provide the implementation of several optimizer rules. Please take a look at them as reference.</p><h1>Instructions</h1><p>See the <a href="https://15445.courses.cs.cmu.edu/fall2024/project0/#instructions" target="_blank" rel="noopener noreferrer">Project #0 instructions</a> for how to create your private repository and set up your development environment.</p><p>You must pull the latest changes from the upstream BusTub repository for test files and other supplementary files we provide in this project.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">‚Äã</a></h2><p>We will use <code>SQLLogicTest</code> to perform testing and benchmarking. To use it,</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make -j$(nproc) sqllogictest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./bin/bustub-sqllogictest ../test/sql/p3.00-primer.slt --verbose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can use the <code>bustub-sqllogictest</code> program to run <code>slt</code> files. Remember to recompile <code>sqllogictest</code> before doing any testing. In this project, we provide ALL test cases to you. There are no hidden tests. The test cases are located at <a href="https://github.com/cmu-db/bustub/blob/master/test/sql/" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>test/sql/</code></a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="formatting">Formatting<a href="#formatting" class="hash-link" aria-label="Direct link to Formatting" title="Direct link to Formatting">‚Äã</a></h2><p>Your code must follow the <a href="https://google.github.io/styleguide/cppguide.html" target="_blank" rel="noopener noreferrer">Google C++ Style Guide</a>.
We use <a href="https://clang.llvm.org/" target="_blank" rel="noopener noreferrer">Clang</a> to automatically check the quality of your source code.
Your project grade will be <strong>zero</strong> if your submission fails any of these checks.</p><p>Execute the following commands to check your syntax.
The <code>format</code> target will automatically correct your code.
The <code>check-lint</code> and <code>check-clang-tidy-p3</code> targets will print errors and instruct you how to fix it to conform to our style guide.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ make format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ make check-lint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ make check-clang-tidy-p3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="memory-leaks">Memory Leaks<a href="#memory-leaks" class="hash-link" aria-label="Direct link to Memory Leaks" title="Direct link to Memory Leaks">‚Äã</a></h2><p>For this project, we use <a href="https://clang.llvm.org/docs/AddressSanitizer.html" target="_blank" rel="noopener noreferrer">LLVM Address Sanitizer (ASAN) and Leak Sanitizer (LSAN)</a> to check for memory errors. To enable ASAN and LSAN, configure CMake in debug mode and run tests as you normally would. If there is memory error, you will see a memory error report. Note that macOS <strong>only supports address sanitizer without leak sanitizer</strong>.</p><p>In some cases, address sanitizer might affect the usability of the debugger. In this case, you might need to disable all sanitizers by configuring the CMake project with:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cmake -DCMAKE_BUILD_TYPE=Debug -DBUSTUB_SANITIZER= ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-hints">Development Hints<a href="#development-hints" class="hash-link" aria-label="Direct link to Development Hints" title="Direct link to Development Hints">‚Äã</a></h2><p>You can use <code>BUSTUB_ASSERT</code> for assertions in debug mode. Note that the statements within <code>BUSTUB_ASSERT</code> will NOT be executed in release mode.
If you have something to assert in all cases, use <code>BUSTUB_ENSURE</code> instead.</p><p>We encourage you to use a graphical debugger to debug your project if you are having problems.</p><p>If you are having compilation problems, running <code>make clean</code> does not completely reset the compilation process. You will need to delete your build directory and run <code>cmake ..</code> again before you rerun <code>make</code>.</p><p>Post all of your questions about this project on Piazza. Do not email the TAs directly with questions.</p><h1>Grading Rubric</h1><p>Each project submission will be graded based on the following criteria:</p><ol><li>Does the submission successfully execute all of the test cases and produce the correct answer?</li><li>Does the submission execute without any memory leaks?</li><li>Does the submission follow the code formatting and style policies?</li></ol><h1>Late Policy</h1><p>See the <a href="https://15445.courses.cs.cmu.edu/fall2024/syllabus.html#late-policy" target="_blank" rel="noopener noreferrer">late policy</a> in the syllabus.</p><h1>Submission</h1><p>After completing the assignment, you can submit your implementation to Gradescope:</p><ul><li><strong><a href="https://www.gradescope.com/courses/817456" target="_blank" rel="noopener noreferrer">https://www.gradescope.com/courses/817456</a></strong></li></ul><p>Running <code>make submit-p3</code> in your <code>build/</code> directory will generate a <code>zip</code> archive called <code>project3-submission.zip</code> under your project root directory that you can submit to Gradescope.</p><p>Remember to resolve all style issues before submitting:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make check-clang-tidy-p3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Collaboration Policy</h1><ul><li>Every student has to work individually on this assignment.</li><li>Students are allowed to discuss high-level details about the project with others.</li><li>Students are <strong>not</strong> allowed to copy the contents of a white-board after a group meeting with other students.</li><li>Students are <strong>not</strong> allowed to copy the solutions from another colleague.</li></ul><p><strong>WARNING:</strong> All of the code for this project must be your own. You may not copy source code from other students or other sources that you find on the web. Plagiarism <strong>will not</strong> be tolerated. See CMU&#x27;s <a href="https://www.cmu.edu/policies/student-and-student-life/academic-integrity.html" target="_blank" rel="noopener noreferrer">Policy on Academic Integrity</a> for additional information.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/curriculum-resource/15-445/project/project03"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Project 02</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/curriculum-resource/15-445/project/project05"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Project 04</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#inspecting-sql-query-plans" class="table-of-contents__link toc-highlight">Inspecting SQL Query Plans</a></li><li><a href="#sample-executors" class="table-of-contents__link toc-highlight">Sample Executors</a><ul><li><a href="#projection" class="table-of-contents__link toc-highlight">Projection</a></li><li><a href="#filter" class="table-of-contents__link toc-highlight">Filter</a></li><li><a href="#values" class="table-of-contents__link toc-highlight">Values</a></li></ul></li><li><a href="#query-plan-syntax" class="table-of-contents__link toc-highlight">Query Plan Syntax</a></li><li><a href="#task-1---access-method-executors" class="table-of-contents__link toc-highlight">Task #1 - Access Method Executors</a><ul><li><a href="#seqscan" class="table-of-contents__link toc-highlight">SeqScan</a></li><li><a href="#insert" class="table-of-contents__link toc-highlight">Insert</a></li><li><a href="#update" class="table-of-contents__link toc-highlight">Update</a></li><li><a href="#delete" class="table-of-contents__link toc-highlight">Delete</a></li><li><a href="#indexscan" class="table-of-contents__link toc-highlight">IndexScan</a></li><li><a href="#optimizing-seqscan-to-indexscan" class="table-of-contents__link toc-highlight">Optimizing SeqScan to IndexScan</a></li></ul></li><li><a href="#task-2---aggregation--join-executors" class="table-of-contents__link toc-highlight">Task #2 - Aggregation &amp; Join Executors</a><ul><li><a href="#aggregation" class="table-of-contents__link toc-highlight">Aggregation</a></li><li><a href="#nestedloopjoin" class="table-of-contents__link toc-highlight">NestedLoopJoin</a></li><li><a href="#nestedindexjoin" class="table-of-contents__link toc-highlight">NestedIndexJoin</a></li></ul></li><li><a href="#task-3---hashjoin-executor-and-optimization" class="table-of-contents__link toc-highlight">Task #3 - HashJoin Executor and Optimization</a><ul><li><a href="#hashjoin" class="table-of-contents__link toc-highlight">HashJoin</a></li><li><a href="#optimizing-nestedloopjoin-to-hashjoin" class="table-of-contents__link toc-highlight">Optimizing NestedLoopJoin to HashJoin</a></li></ul></li><li><a href="#task-4-external-merge-sort--limit-executors" class="table-of-contents__link toc-highlight">Task #4: External Merge Sort + Limit Executors</a><ul><li><a href="#external-merge-sort" class="table-of-contents__link toc-highlight">External Merge Sort</a></li><li><a href="#limit" class="table-of-contents__link toc-highlight">Limit</a></li></ul></li><li><a href="#optional-leaderboard-tasks" class="table-of-contents__link toc-highlight">Optional Leaderboard Tasks</a><ul><li><a href="#query-1-too-many-joins" class="table-of-contents__link toc-highlight">Query 1: Too Many Joins!</a></li><li><a href="#query-2-the-mad-data-scientist" class="table-of-contents__link toc-highlight">Query 2: The Mad Data Scientist</a></li><li><a href="#query-3-all-that-work-for-nothing" class="table-of-contents__link toc-highlight">Query 3: All that work, for nothing?</a></li><li><a href="#leaderboard-policy" class="table-of-contents__link toc-highlight">Leaderboard Policy</a></li></ul></li><li><a href="#system-catalog" class="table-of-contents__link toc-highlight">System Catalog</a></li><li><a href="#index-updates" class="table-of-contents__link toc-highlight">Index Updates</a></li><li><a href="#optimizer-rule-implementation-guide" class="table-of-contents__link toc-highlight">Optimizer Rule Implementation Guide</a></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a></li><li><a href="#formatting" class="table-of-contents__link toc-highlight">Formatting</a></li><li><a href="#memory-leaks" class="table-of-contents__link toc-highlight">Memory Leaks</a></li><li><a href="#development-hints" class="table-of-contents__link toc-highlight">Development Hints</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">CSÂ≠¶‰π†Á§æÂå∫</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Ë∑ØÁ∫øÂõæ</a></li></ul></div><div class="col footer__col"><div class="footer__title">Á§æÂå∫</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/WqwvTrEQmA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">ÊçêËµ†</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/donate">ÊçêËµ†Êàë‰ª¨</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyleft ¬© 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1f1549d9.js"></script>
<script src="/assets/js/main.2f696ece.js"></script>
</body>
</html>