<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-curriculum-resource/15-445/project/project02" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Project 01 | CS自学社区</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.learncs.site/docs/curriculum-resource/15-445/project/project02"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="baidu-site-verification" content="codeva-hJyfN2UKgo"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Project 01 | CS自学社区"><meta data-rh="true" name="description" content="Do not post your project on a public Github repository."><meta data-rh="true" property="og:description" content="Do not post your project on a public Github repository."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.learncs.site/docs/curriculum-resource/15-445/project/project02"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/15-445/project/project02" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/15-445/project/project02" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CS自学社区 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CS自学社区 Atom Feed">




<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.c4382977.css">
<link rel="preload" href="/assets/js/runtime~main.30603f7d.js" as="script">
<link rel="preload" href="/assets/js/main.b37f8dfa.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">🎉️🎉️🎉️课程文档汉化工作正在进行中 🎉️🎉️ 学习交流群请到 <a href="/community">社区页面</a> 查看入群方式 🎉️🎉️🎉️</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">TeachYourselfCS</b></a><a class="navbar__item navbar__link" href="/docs/roadmap">路线图</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">课程资源</a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/community">社区</a><a class="navbar__item navbar__link" href="/donate">捐赠我们</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">前言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/roadmap">路线图</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/课程资源">课程资源</a><button aria-label="Toggle the collapsible sidebar category &#x27;课程资源&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x">cs50x</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61a">cs61a</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61a&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61b">cs61b</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61b&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61c">cs61c</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61c&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-01">MIT 18.01</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.01&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-02">MIT 18.02</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.02&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-06">MIT 18.06</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.06&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/6-04j">MIT 6.042J</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 6.042J&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs162">cs162</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs162&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs144">cs144</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs144&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/15-445">CMU 15-445</a><button aria-label="Toggle the collapsible sidebar category &#x27;CMU 15-445&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/assignments">assignments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/syllabus">syllabus-课程大纲</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/15-445/homework/homework01">homework</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/15-445/project/project01">project</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/project/project01">Project 0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/curriculum-resource/15-445/project/project02">Project 01</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/project/project03">Project 02</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/project/project04">Project 03</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/15-445/project/project05">Project 04</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/课程资源"><span itemprop="name">课程资源</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/15-445"><span itemprop="name">CMU 15-445</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">project</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Project 01</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Project 01</h1></header><p>Do not post your project on a public Github repository.</p><h1>Overview</h1><p>This semester, you will build a <em>disk-oriented database management system</em> (DBMS) called <a href="https://github.com/cmu-db/bustub" target="_blank" rel="noopener noreferrer">BusTub</a>. A disk-oriented architecture means that the DBMS&#x27;s primary storage location is in persistent storage, like a hard drive (HDD) or flash storage (SSDs). This is different from an in-memory DBMS, where data is stored in volatile memory.</p><p>The first programming project is to implement the DBMS&#x27;s <strong>buffer pool manager.</strong> The buffer pool is responsible for moving physical pages of data back and forth from buffers in main memory to persistent storage. It also behaves as a cache, keeping frequently used pages in memory for faster access, and evicting unused or cold pages back out to storage.</p><p>A <em>page</em> in BusTub is 4096 bytes (4 KB) of data, meaning the buffer pool manages data in 4 KB units. Since pages in BusTub have a fixed size, the buffer pool manager stores these pages into fixed-size buffers called <em>frames</em>. The distinction between a page and a frame is somewhat subtle. A <em>page</em> is 4 KB of logical (virtual) data, and can be stored in memory, on disk, or both in memory and on disk. A <em>frame</em>, on the other hand, is a fixed-length 4 KB block of memory (i.e., a pointer to this memory) that stores a single page of data. The analogy here is storing (logical) pages <em>inside</em> (physical) fixed frames.</p><p>In addition to behaving as a cache, the buffer pool manager allows a DBMS to support databases that are larger than the amount of memory available to the system. Consider a computer with 1 GB of memory (RAM). If we want to manage a 2 GB database, a buffer pool manager gives us the ability to interact with this database <em>without</em> needing to fit its entire contents in memory.</p><p>The I/O operations that the buffer pool executes are abstracted away from other parts of the DBMS. For example, when one of the DBMS&#x27;s components (e.g., execution engine) asks the buffer pool manager for a page of data using its unique identifier ( <code>page_id_t</code>), that component does not need to know whether that page is already in memory or whether the system has to retrieve it from disk. Similarly, the buffer pool manager does not need to understand the contents of these pages, it only needs to know where the data is located.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation">Implementation<a href="#implementation" class="hash-link" aria-label="Direct link to Implementation" title="Direct link to Implementation">​</a></h3><p><strong>Your implementation of the buffer pool must be thread-safe.</strong> Multiple threads will concurrently access the internal data structures of your buffer pool, and you must make sure that critical sections are protected with <a href="https://stackoverflow.com/a/42464336" target="_blank" rel="noopener noreferrer">latches</a> (these are called &quot;locks&quot; in operating systems).</p><p>You must implement the following storage manager components:</p><ul><li><a href="https://15445.courses.cs.cmu.edu/fall2024/project1/#lru-k-replacer" target="_blank" rel="noopener noreferrer"><strong>LRU-K Replacement Policy</strong></a></li><li><a href="https://15445.courses.cs.cmu.edu/fall2024/project1/#disk-scheduler" target="_blank" rel="noopener noreferrer"><strong>Disk Scheduler</strong></a></li><li><a href="https://15445.courses.cs.cmu.edu/fall2024/project1/#buffer-pool-manager" target="_blank" rel="noopener noreferrer"><strong>Buffer Pool Manager</strong></a></li></ul><p><strong>This is a single-person project that must be completed individually (i.e., no groups).</strong></p><ul><li><strong>Release Date:</strong> Sep 09, 2024</li><li><strong>Due Date:</strong> Sep 29, 2024 @ 11:59pm</li></ul><h1>Project Specification</h1><p>Remember to pull latest code from the BusTub repository.</p><p>For each of the following components, we have provided stub classes that contain the API that you must implement. You should <strong>not</strong> modify the signatures for the pre-defined functions in these classes. If you modify the signatures, our grading test code will not work and you will not get credit for this project.</p><p>If a class already contains data members, you should not remove them. For example, the <code>BufferPoolManager</code> class contains <code>DiskScheduler</code> and <code>LRUKReplacer</code> members that are required to implement functionality needed by the rest of the system. <strong>You may add data members and helper functions to these classes</strong> to correctly implement the required functionality.</p><p>You may use any built-in <a href="http://en.cppreference.com/w/cpp/container" target="_blank" rel="noopener noreferrer">C++17 containers</a> in your project unless specified otherwise. It is up to you to decide which ones you want to use. Be warned that these containers are not thread-safe, and you will need to use latches to protect access to them. <strong>You may not use additional third-party libraries (e.g., <a href="https://www.boost.org/" target="_blank" rel="noopener noreferrer">Boost</a>).</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1---lru-k-replacement-policy">Task <!-- -->#<!-- -->1 - LRU-K Replacement Policy<a href="#task-1---lru-k-replacement-policy" class="hash-link" aria-label="Direct link to task-1---lru-k-replacement-policy" title="Direct link to task-1---lru-k-replacement-policy">​</a></h2><p>This component is responsible for tracking page usage in the buffer pool in order to determine candidate pages / frames to evict out of memory and back to disk.</p><p>You will implement a class called <code>LRUKReplacer</code> in <a href="https://github.com/cmu-db/bustub/blob/master/src/include/buffer/lru_k_replacer.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/buffer/lru_k_replacer.h</code></a> and its corresponding implementation file in <a href="https://github.com/cmu-db/bustub/blob/master/src/buffer/lru_k_replacer.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/buffer/lru_k_replacer.cpp</code></a>. Note that <code>LRUKReplacer</code> is a standalone class and is <strong>not</strong> related to any of the other <code>Replacer</code> classes. You are only expected to implement the LRU-K replacement policy, and you don&#x27;t have to implement the LRU or Clock replacement policy (even though there is a corresponding file for it).</p><p><strong>The LRU-K algorithm evicts a frame whose backward <em>k-distance</em> is the maximum of all frames in the replacer.</strong> Backward k-distance is computed as the difference in time between the current timestamp and the timestamp of kth previous access. A frame with fewer than k historical accesses is given +inf as its backward k-distance. If multiple frames have +inf backward k-distance, the replacer evicts the frame with the earliest overall timestamp (i.e., the frame whose least-recent recorded access is the overall least recent access).</p><p>The maximum size of the <code>LRUKReplacer</code> is the same as the size of the buffer pool since it contains placeholders for all of the frames in the <code>BufferPoolManager</code>. However, not all frames in the replacer may be considered as evictable at any given time. The size of <code>LRUKReplacer</code> is represented by the number of <em>evictable</em> frames. The <code>LRUKReplacer</code> is first initialized to have no frames in it. Only when a frame is marked as evictable will replacer&#x27;s size will increase. Similarly, when a frame is pinned or not in use, the replacer&#x27;s size will decrease.</p><p>You will need to implement the following methods for LRU-K as defined in the header file ( <a href="https://github.com/cmu-db/bustub/blob/master/src/include/buffer/lru_k_replacer.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/buffer/lru_k_replacer.h</code></a>) and in the source file ( <a href="https://github.com/cmu-db/bustub/blob/master/src/buffer/lru_k_replacer.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/buffer/lru_k_replacer.cpp</code></a>):</p><ul><li><p><code>Evict() -&gt; std::optional&lt;frame_id_t&gt;</code> : Evict the frame that has the largest backward k-distance compared to all other <strong>evictable</strong> frames being tracked by the <code>Replacer</code>. If there are no evictable frames, return <code>std::nullopt</code>.</p></li><li><p><code>RecordAccess(frame_id_t frame_id)</code> : Record that the given frame has been accessed at the current timestamp. This method should be called after a page has been pinned in the <code>BufferPoolManager</code>.</p></li><li><p><code>Remove(frame_id_t frame_id)</code> : Clear all access history associated with a frame. This method should be called only when a page is deleted in the <code>BufferPoolManager</code>.</p></li><li><p><code>SetEvictable(frame_id_t frame_id, bool set_evictable)</code> : This method controls whether a frame is evictable or not. It also controls the <code>LRUKReplacer</code>&#x27;s size. You&#x27;ll know when to call this function when you implement the <code>BufferPoolManager</code>. To be specific, <strong>when the pin count of a page hits 0, its corresponding frame should be marked as evictable.</strong></p></li><li><p><code>Size() -&gt; size_t</code> : This method returns the number of evictable frames that are currently in the <code>LRUKReplacer</code>.</p></li></ul><p>The implementation details are up to you. You are allowed to use built-in STL containers. You may assume that you will not run out of memory for these data structures ( <strong>you cannot assume the same for the buffer pool in Task #3, you <em>will</em> run out of available frames</strong>). You must make sure that your implementation is thread-safe.</p><p>If you would like to read more about the LRU-K replacement algorithm, refer to this <a href="https://www.cs.cmu.edu/~natassa/courses/15-721/papers/p297-o_neil.pdf" target="_blank" rel="noopener noreferrer">paper</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2---disk-scheduler">Task <!-- -->#<!-- -->2 - Disk Scheduler<a href="#task-2---disk-scheduler" class="hash-link" aria-label="Direct link to task-2---disk-scheduler" title="Direct link to task-2---disk-scheduler">​</a></h2><p>This component is responsible for scheduling read and write operations on the <code>DiskManager</code>. You will implement a class called <code>DiskScheduler</code> in <a href="https://github.com/cmu-db/bustub/blob/master/src/include/storage/disk/disk_scheduler.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/storage/disk/disk_scheduler.h</code></a> and its corresponding implementation file in <a href="https://github.com/cmu-db/bustub/blob/master/src/storage/disk/disk_scheduler.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/storage/disk/disk_scheduler.cpp</code></a>.</p><p>The disk scheduler can be used by other components (in this case, your <code>BufferPoolManager</code> in Task #3) to queue disk requests, represented by a <code>DiskRequest</code> struct (already defined in <a href="https://github.com/cmu-db/bustub/blob/master/src/include/storage/disk/disk_scheduler.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/storage/disk/disk_scheduler.h</code></a>). The disk scheduler will maintain a background worker thread which is responsible for processing scheduled requests.</p><p>The disk scheduler will utilize a shared queue (channel) to schedule and process the <code>DiskRequest</code> s. One thread will add a request to the queue, and the disk scheduler&#x27;s background worker will process the queued requests. We have provided a <code>Channel</code> class in <a href="https://github.com/cmu-db/bustub/blob/master/src/include/common/channel.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/common/channel.h</code></a> to facilitate the thread-safe sharing of data between threads, but feel free to use your own implementation if you find it necessary.</p><p>The <code>DiskScheduler</code> constructor and destructor are already implemented and are responsible for creating and joining the background worker thread. You will only need to implement the following methods as defined in the header file ( <a href="https://github.com/cmu-db/bustub/blob/master/src/include/storage/disk/disk_scheduler.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/storage/disk/disk_scheduler.h</code></a>) and in the source file ( <a href="https://github.com/cmu-db/bustub/blob/master/src/storage/disk/disk_scheduler.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/storage/disk/disk_scheduler.cpp</code></a>):</p><ul><li><p><code>Schedule(DiskRequest r)</code> : Schedules a request for the <code>DiskManager</code> to execute. The <code>DiskRequest</code> struct specifies whether the request is for a read or write, where the data should be read from / written into, and the page ID for the operation. The <code>DiskRequest</code> also includes a <code>std::promise</code> whose value should be set to true once the request is processed. See below for more information about <code>std::promise</code>.</p></li><li><p><code>StartWorkerThread()</code> : The startup method for the background worker thread which processes the scheduled requests. The worker thread is created in the <code>DiskScheduler</code> constructor and calls this method. This worker thread is responsible for receiving queued requests and dispatching them to the <code>DiskManager</code>. Remember to set the value correctly on the <code>DiskRequest</code>&#x27;s callback to signal to the request issuer that the request has been completed. This should not return until the <code>DiskScheduler</code>&#x27;s destructor is called.</p></li></ul><p>We mentioned that one of the fields of a <code>DiskRequest</code> is a <code>std::promise</code>. If you are unfamiliar with C++ promises and futures, you can check out the documentation <a href="https://en.cppreference.com/w/cpp/thread/promise" target="_blank" rel="noopener noreferrer">here</a>. For the purposes of this project, they essentially provide a callback mechanism for a thread to know when their scheduled request is completed. To see an example of how they might be used, check out <code>disk_scheduler_test.cpp</code>.</p><p>Again, the implementation details are up to you. You must make sure that your implementation is thread-safe.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="disk-manager">Disk Manager<a href="#disk-manager" class="hash-link" aria-label="Direct link to Disk Manager" title="Direct link to Disk Manager">​</a></h3><p>The header containing the <code>DiskManager</code> class is located at ( <a href="https://github.com/cmu-db/bustub/blob/master/src/include/storage/disk/disk_manager.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/storage/disk/disk_manager.h</code></a>). It reads page data from disk and writes data to disk. Your disk scheduler will use <code>DiskManager::ReadPage()</code> and <code>DiskManager::WritePage()</code> while it is processing a read or write request.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3---buffer-pool-manager">Task <!-- -->#<!-- -->3 - Buffer Pool Manager<a href="#task-3---buffer-pool-manager" class="hash-link" aria-label="Direct link to task-3---buffer-pool-manager" title="Direct link to task-3---buffer-pool-manager">​</a></h2><p>Finally, you must implement the buffer pool manager ( <code>BufferPoolManager</code>)! Echoing the beginning of this page, the <code>BufferPoolManager</code> is responsible for fetching database pages from disk with the <code>DiskScheduler</code> and storing them in memory. The <code>BufferPoolManager</code> can also schedule writes of dirty pages out to disk when it is either explicitly instructed to do so or when it needs to evict a page to make space for a new page.</p><p>Your <code>BufferPoolManager</code> implementation will use the <code>LRUKReplacer</code> and <code>DiskScheduler</code> classes that you created in the previous steps of this assignment. The <code>LRUKReplacer</code> will keep track of when pages are accessed so that it can decide which frame to evict when it must make room for a new page. The <code>DiskScheduler</code> will schedule writes and reads to disk on the <code>DiskManager</code>.</p><p>We have provided a helper class called <code>FrameHeader</code>, which helps manage the in-memory frames. All access to page data should be through <code>FrameHeader</code> s. <code>FrameHeader</code> has a method called <code>GetData</code> that returns a raw pointer to its frame&#x27;s memory, and the <code>DiskScheduler</code> / <code>DiskManager</code> will use this pointer to copy the contents of a physical page on disk into memory.</p><p>As a reminder, the buffer pool manager does not need to understand the contents of these pages. The only information that the <code>BufferPoolManager</code> knows about pages are the page IDs ( <code>page_id_t</code>) and the <code>FrameHeader</code> s they are stored inside of. Also, the <code>BufferPoolManager</code> will reuse the same <code>FrameHeader</code> object to store data as it moves back and forth between disk and memory. In other words, all <code>FrameHeader</code> s will store many different pages throughout the lifetime of the system.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="concurrency">Concurrency<a href="#concurrency" class="hash-link" aria-label="Direct link to Concurrency" title="Direct link to Concurrency">​</a></h3><p>When implementing a multi-threaded buffer pool manager, we must take care to synchronize data access. This means that we do not want multiple copies of the same page in different frames of the buffer pool. If we allowed this, we would encounter this scenario:</p><ul><li>Thread T1 loads page X1 from disk into a frame and starts modifying page X1, and let&#x27;s call this new version page X2.</li><li>Thread T2 loads page X1 from disk into a different frame and starts modifying this version of page X1, and let&#x27;s call this other modified version page X3.</li><li>Thread T2 finishes writing and writes X3 back to disk.</li><li>Thread T1 finishes writing and writes X2 back to disk.</li><li>Data race ☠️!</li></ul><p>Thus, we keep only 1 version of a page in memory at a time to prevent data synchronization races. Additionally, to prevent us from evicting a page while threads are accessing it, we maintain a reference count / pin count on the frame that stores it. Finally, in order to keep track of which pages are stored in which frames, we also maintain a page table using a hash map that maps page IDs to frames.</p><p>The pin count of a frame is the number of threads that have access to the page&#x27;s data. As long as the pin count on a frame is greater than 0 (implying there is at least 1 thread accessing the page&#x27;s data), the buffer pool manager is not allowed to evict the page being stored. You can maintain the pin count using the atomic field <code>pin_count_</code> in the <code>FrameHeader</code> class. Keep in mind that <code>pin_count_</code> is separate from <code>LRUKReplacer::SetEvictable</code>, so you will need to make sure those are synced properly. You will also have to update the <code>is_dirty_</code> flag of the <code>FrameHeader</code> when you think it is necessary. If this flag is set when you want to evict a page, you will have to act accordingly to maintain data synchronization between memory and disk.</p><p>Last, but certainly not least, you will have to implement both <code>ReadPageGuard</code> and <code>WritePageGuard</code>. These classes are RAII objects that provide thread-safe read / write access to the underlying pages. See the implementation section below for more information. You will probably need to implement this in tandem with the <code>BufferPoolManager</code> methods <code>CheckedReadPage</code> and <code>CheckedWritePage</code>. However, if you want to make sure your page guard implementations are correct, you may choose to implement <code>BufferPoolManager::GetPinCount</code> first and then stitch together something that will pass the page guard tests.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-1">Implementation<a href="#implementation-1" class="hash-link" aria-label="Direct link to Implementation" title="Direct link to Implementation">​</a></h3><p>You will need to implement the following page guard methods defined in the header file ( <a href="https://github.com/cmu-db/bustub/blob/master/src/include/storage/page/page_guard.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/storage/page/page_guard.h</code></a>) and in the source file ( <a href="https://github.com/cmu-db/bustub/blob/master/src/storage/page/page_guard.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/storage/page/page_guard.cpp</code></a>):</p><ul><li><code>ReadPageGuard::ReadPageGuard()</code></li><li><code>ReadPageGuard::ReadPageGuard(ReadPageGuard &amp;&amp;that)</code></li><li><code>ReadPageGuard::operator=(ReadPageGuard &amp;&amp;that) -&gt; ReadPageGuard &amp;</code></li><li><code>ReadPageGuard::Drop()</code></li><li><code>WritePageGuard::WritePageGuard()</code></li><li><code>WritePageGuard::WritePageGuard(WritePageGuard &amp;&amp;that)</code></li><li><code>WritePageGuard::operator=(WritePageGuard &amp;&amp;that) -&gt; WritePageGuard &amp;</code></li><li><code>WritePageGuard::Drop()</code></li></ul><p><strong>You <em>do not</em> have to implement these methods <em>before</em> the <code>BufferPoolManager</code> methods. You should probably work on them at the same time.</strong></p><p>These methods implement move semantics and RAII for the page guards. If you are unfamiliar with these things, please familiarize yourself with learning materials online. There are many great resources (including articles, Microsoft tutorials, YouTube videos) that explain this in depth. <strong>You should not attempt to implement these methods without having a solid understanding of how RAII and move semantics work.</strong></p><p>There will likely be a lot of code duplication here (i.e. the two guards should be identical except for a handful of lines). If you want to derive these classes based on a class you create, you are welcome to do so. Just make sure that no interfaces and method signatures are changed!</p><p>You will also need to implement the following <code>BufferPoolManager</code> methods defined in the header file ( <a href="https://github.com/cmu-db/bustub/blob/master/src/include/buffer/buffer_pool_manager.h" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/include/buffer/buffer_pool_manager.h</code></a>) and in the source file ( <a href="https://github.com/cmu-db/bustub/blob/master/src/buffer/buffer_pool_manager.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/buffer/buffer_pool_manager.cpp</code></a>):</p><ul><li><code>NewPage() -&gt; page_id_t</code></li><li><code>DeletePage(page_id_t page_id) -&gt; bool</code></li><li><code>CheckedWritePage(page_id_t page_id) -&gt; std::optional&lt;WritePageGuard&gt;</code></li><li><code>CheckedReadPage(page_id_t page_id) -&gt; std::optional&lt;ReadPageGuard&gt;</code></li><li><code>FlushPage(page_id_t page_id) -&gt; bool</code></li><li><code>FlushAllPages()</code></li><li><code>GetPinCount(page_id_t page_id)</code></li></ul><p><strong>All of these methods have detailed documentation comments in the source file. Make sure to read all of these in their entirety! They will contain many useful hints.</strong></p><p>You do not need to make your buffer pool manager super efficient. For all of the public <code>BufferPoolManager</code> method, holding the buffer pool latch from beginning to end should be enough ( <strong>except for when you need to release it early to prevent deadlocks</strong>). However, you do need to ensure that your buffer pool manager has reasonable performance, otherwise there will be problems in future projects. You can compare your benchmark result (QPS.1 and QPS.2) with other students and see if your implementation is too slow.</p><p>Please refer to the source files ( <a href="https://github.com/cmu-db/bustub/blob/master/src/storage/page/page_guard.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/storage/page/page_guard.cpp</code></a> and <a href="https://github.com/cmu-db/bustub/blob/master/src/buffer/buffer_pool_manager.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>src/buffer/buffer_pool_manager.cpp</code></a>) for <em>significantly</em> more detailed specifications and documentation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="leaderboard-task-optional">Leaderboard Task (Optional)<a href="#leaderboard-task-optional" class="hash-link" aria-label="Direct link to Leaderboard Task (Optional)" title="Direct link to Leaderboard Task (Optional)">​</a></h2><p>For this project&#x27;s leaderboard challenge, we are doing a benchmark on your buffer pool manager with a special storage backend.</p><p>Optimizing for the leaderboard is optional (i.e., you can get a perfect score in the project after finishing all previous tasks).
However, your solution must finish the leaderboard test with a correct result and without deadlock and segfault.</p><p>The leaderboard test is compiled with the release profile:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir cmake-build-relwithdebinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd cmake-build-relwithdebinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmake .. -DCMAKE_BUILD_TYPE=RelWithDebInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make -j `nproc` bpm-bench</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The command below is just for illustrating how the bpm-bench test works.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># We are NOT running tests with the same parameter for the leaderboard test.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./bin/bustub-bpm-bench --duration 5000 --latency 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We strongly recommend you to checkpoint your code before optimizing for leaderboard tests, so that if these optimizations cause problems in future projects, you can always revert them.</p><p>In the leaderboard test, we will have multiple threads accessing the pages on the disk. There are two types of threads running in the benchmark:</p><ol><li>Scan threads. Each scan thread will read pages on the disk sequentially. There will be 8 scan threads.</li><li>Get threads. Each get thread will randomly select and update a page using the <a href="https://en.wikipedia.org/wiki/Zipf%27s_law" target="_blank" rel="noopener noreferrer">zipfian distribution</a>.
There will be 8 get threads.</li></ol><p>We will run the benchmark three times on the in-memory storage backend, each time for 30 seconds. For the first and the second time, it will run directly with different buffer pool and replacer settings.
For the third time, we will add a 1-millisecond latency to each of the random read/write operation, and 0.1ms latency to sequential/local read/write
operations. See <code>DiskManagerUnlimitedMemory</code> class for more information.</p><p>The final score is computed as a weighted QPS of scan and get operations, with and without latency respectively:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scan_qps_large / 1000 + get_qps_large / 1000 + scan_qps_small / 1000 + get_qps_small / 1000 + scan_qps_1ms + get_qps_1ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Recommended Optimizations</strong></p><ol><li>Better replacer algorithm. Given that get workload is skewed (i.e., some pages are more frequently accessed than others),
you can design your LRU-k replacer to take page access type into consideration, so as to reduce page miss.</li><li>Parallel I/O operations. Instead of processing one request at a time in your disk scheduler, you can issue multiple requests
to the disk manager at the same time. This optimization will be very useful in modern storage devices, where concurrent
access to the disk can make better use of the disk bandwidth. You should handle the case that multiple operations to the same page
are in the queue and the end result of these requests should be as if they are processed in order. In a single thread,
they should have read-after-write consistency.</li><li>To achieve true parallelism in disk scheduler, you will also need to allow your buffer pool manager can handle multiple
<code>ReadPage</code> and <code>WritePage</code> requests and evicting multiple pages at the same time. You might need to bring in a conditional variable in
your buffer pool manager to manage free pages.</li><li>You can use our provided lock-free queue implementation in <code>third_party/readerwriterqueue</code> and
create your own <code>promise</code> implementation that is compatible with <code>std::promise</code> so as to lower
the overhead of inter-thread communication. Note that in this project, all requests must go
through the <code>DiskScheduler</code>&#x27;s background thread.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="leaderboard-policy">Leaderboard Policy<a href="#leaderboard-policy" class="hash-link" aria-label="Direct link to Leaderboard Policy" title="Direct link to Leaderboard Policy">​</a></h3><ul><li>Submissions <em>with leaderboard bonus</em> are subject to manual review by TAs.<ul><li>By saying &quot;review&quot;, it means that TAs will manually look into your code, or if they are unsure whether an optimization is correct or not by looking, they will make simple modification to existing test cases to see if your leaderboard optimization <em>correctly</em> handled the specific cases that you want to optimize.</li><li>One example of simple modification: change the buffer pool manager size for the benchmark.</li></ul></li><li>Your optimization should not affect correctness. You can optimize for specific cases, but it should work for all inputs in your optimized cases.<ul><li>Disallowed: compare the plan with the leaderboard test and convert it to <code>ValueExecutor</code> with the output table in project 3. That’s because your optimization should work for all table contents. Hardcoding the answer will yield wrong result in some cases.</li></ul></li><li>You should not try detecting whether your submission is running leaderboard test by using side information.<ul><li>Unless we allow you to do so.</li><li>Disallowed: use <code>#ifdef NDEBUG</code>, etc.</li></ul></li><li>Submissions with obvious correctness issues will not be assigned leaderboard bonus.</li><li>You cannot use late days for leaderboard tests.</li><li>If you are unsure about whether an optimization is reasonable, you should post on Piazza or visit any TA&#x27;s office hour.</li></ul><h1>Instructions</h1><p>See the <a href="https://15445.courses.cs.cmu.edu/fall2024/project0/#instructions" target="_blank" rel="noopener noreferrer">Project #0 instructions</a> on how to create your private repository and setup your development environment.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">​</a></h2><p>You can test the individual components of this assigment using our testing framework. We use <a href="https://github.com/google/googletest" target="_blank" rel="noopener noreferrer">GTest</a> for unit test cases. There are three separate files that contain tests for each component:</p><ul><li><code>LRUKReplacer</code>: <a href="https://github.com/cmu-db/bustub/blob/master/test/buffer/lru_k_replacer_test.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>test/buffer/lru_k_replacer_test.cpp</code></a></li><li><code>DiskScheduler</code>: <a href="https://github.com/cmu-db/bustub/blob/master/test/storage/disk_scheduler_test.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>test/storage/disk_scheduler_test.cpp</code></a></li><li><code>PageGuard</code>: <a href="https://github.com/cmu-db/bustub/blob/master/test/storage/page_guard_test.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>test/storage/page_guard_test.cpp</code></a></li><li><code>BufferPoolManager</code>: <a href="https://github.com/cmu-db/bustub/blob/master/test/buffer/buffer_pool_manager_test.cpp" target="_blank" rel="noopener noreferrer" title="View Source Code"><code>test/buffer/buffer_pool_manager_test.cpp</code></a></li></ul><p>You can compile and run each test individually from the command-line:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ make lru_k_replacer_test -j `nproc`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./test/lru_k_replacer_test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also run <code>make check-tests</code> to run ALL of the test cases. Note that some tests are disabled as you have not implemented future projects. You can disable tests in GTest by adding a <code>DISABLED_</code> prefix to the test name.</p><p><strong>Important:</strong> These tests are only a subset of the all the tests that we will use to evaluate and grade your project. You should write additional test cases on your own to check the complete functionality of your implementation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="formatting">Formatting<a href="#formatting" class="hash-link" aria-label="Direct link to Formatting" title="Direct link to Formatting">​</a></h2><p>Your code must follow the <a href="https://google.github.io/styleguide/cppguide.html" target="_blank" rel="noopener noreferrer">Google C++ Style Guide</a>. We use <a href="https://clang.llvm.org/" target="_blank" rel="noopener noreferrer">Clang</a> to automatically check the quality of your source code. Your project grade will be <strong>zero</strong> if your submission fails any of these checks.</p><p>Execute the following commands to check your syntax. The <code>format</code> target will automatically correct your code. The <code>check-lint</code> and <code>check-clang-tidy-p1</code> targets will print errors and instruct you how to fix it to conform to our style guide.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ make format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ make check-clang-tidy-p1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="memory-leaks">Memory Leaks<a href="#memory-leaks" class="hash-link" aria-label="Direct link to Memory Leaks" title="Direct link to Memory Leaks">​</a></h2><p>For this project, we use <a href="https://clang.llvm.org/docs/AddressSanitizer.html" target="_blank" rel="noopener noreferrer">LLVM Address Sanitizer (ASAN) and Leak Sanitizer (LSAN)</a> to check for memory errors. To enable ASAN and LSAN, configure CMake in debug mode and run tests as you normally would. If there is memory error, you will see a memory error report. Note that macOS <strong>only supports address sanitizer without leak sanitizer</strong>.</p><p>In some cases, address sanitizer might affect the usability of the debugger. In this case, you might need to disable all sanitizers by configuring the CMake project with:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cmake -DCMAKE_BUILD_TYPE=Debug -DBUSTUB_SANITIZER= ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-hints">Development Hints<a href="#development-hints" class="hash-link" aria-label="Direct link to Development Hints" title="Direct link to Development Hints">​</a></h2><p>You can use <code>BUSTUB_ASSERT</code> for assertions in debug mode. Note that the statements within <code>BUSTUB_ASSERT</code> will NOT be executed in release mode.
If you have something to assert in all cases, use <code>BUSTUB_ENSURE</code> instead.</p><p>Post all of your questions about this project on Piazza. Do <strong>not</strong> email the TAs directly with questions.</p><p>We encourage you to use a graphical debugger to debug your project if you are having problems.</p><p>If you are having compilation problems, running <code>make clean</code> does not completely reset the compilation process. You will need to delete your build directory and run <code>cmake ..</code> again before you rerun <code>make</code>.</p><h1>Grading Rubric</h1><p>Each project submission will be graded based on the following criteria:</p><ol><li><p>Does the submission successfully execute all of the test cases and produce the correct answer?</p></li><li><p>Does the submission execute without any memory leaks?</p></li><li><p>Does the submission follow the code formatting and style policies?</p></li></ol><p>Note that we will use additional test cases to grade your submission that are more complex than the sample test cases that we provide you.</p><h1>Late Policy</h1><p>See the <a href="https://15445.courses.cs.cmu.edu/fall2024/syllabus.html#late-policy" target="_blank" rel="noopener noreferrer">late policy</a> in the syllabus.</p><h1>Submission</h1><p>After completing the assignment, you can submit your implementation to Gradescope:</p><ul><li><strong><a href="https://www.gradescope.com/courses/817456" target="_blank" rel="noopener noreferrer">https://www.gradescope.com/courses/817456</a></strong></li></ul><p>Running <code>make submit-p1</code> in your <code>build/</code> directory will generate a <code>zip</code> archive called <code>project1-submission.zip</code> under your project root directory that you can submit to Gradescope.</p><p>You can submit your answers as many times as you like and get immediate feedback.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="notes-on-gradescope-and-autograder">Notes on Gradescope and Autograder<a href="#notes-on-gradescope-and-autograder" class="hash-link" aria-label="Direct link to Notes on Gradescope and Autograder" title="Direct link to Notes on Gradescope and Autograder">​</a></h2><ol><li>If you are timing out on Gradescope, it&#x27;s likely because you have a deadlock in your code or your code is too slow and does not run in 60 seconds. If your code is too slow it may be because your <code>LRUKReplacer</code> is not efficient enough.</li><li>The autograder will not work if you are printing too many logs in your submissions.</li><li>If the autograder did not work properly, make sure that your formatting commands work and that you are submitting the right files.</li><li>The leaderboard benchmark score will be calculated by stress testing your <code>buffer_pool_manager</code> implementation.</li></ol><p>CMU students should use the Gradescope course code announced on Piazza.</p><h1>Collaboration Policy</h1><ul><li>Every student has to work individually on this assignment.</li><li>Students are allowed to discuss high-level details about the project with others.</li><li>Students are <strong>not</strong> allowed to copy the contents of a white-board after a group meeting with other students.</li><li>Students are <strong>not</strong> allowed to copy the solutions from another colleague.</li></ul><p><strong>WARNING:</strong> All of the code for this project must be your own. You may not copy source code from other students or other sources that you find on the web. Plagiarism <strong>will not</strong> be tolerated. See CMU&#x27;s <a href="https://www.cmu.edu/policies/student-and-student-life/academic-integrity.html" target="_blank" rel="noopener noreferrer">Policy on Academic Integrity</a> for additional information.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/curriculum-resource/15-445/project/project01"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Project 0</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/curriculum-resource/15-445/project/project03"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Project 02</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#implementation" class="table-of-contents__link toc-highlight">Implementation</a></li><li><a href="#task-1---lru-k-replacement-policy" class="table-of-contents__link toc-highlight">Task #1 - LRU-K Replacement Policy</a></li><li><a href="#task-2---disk-scheduler" class="table-of-contents__link toc-highlight">Task #2 - Disk Scheduler</a><ul><li><a href="#disk-manager" class="table-of-contents__link toc-highlight">Disk Manager</a></li></ul></li><li><a href="#task-3---buffer-pool-manager" class="table-of-contents__link toc-highlight">Task #3 - Buffer Pool Manager</a><ul><li><a href="#concurrency" class="table-of-contents__link toc-highlight">Concurrency</a></li><li><a href="#implementation-1" class="table-of-contents__link toc-highlight">Implementation</a></li></ul></li><li><a href="#leaderboard-task-optional" class="table-of-contents__link toc-highlight">Leaderboard Task (Optional)</a><ul><li><a href="#leaderboard-policy" class="table-of-contents__link toc-highlight">Leaderboard Policy</a></li></ul></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a></li><li><a href="#formatting" class="table-of-contents__link toc-highlight">Formatting</a></li><li><a href="#memory-leaks" class="table-of-contents__link toc-highlight">Memory Leaks</a></li><li><a href="#development-hints" class="table-of-contents__link toc-highlight">Development Hints</a></li><li><a href="#notes-on-gradescope-and-autograder" class="table-of-contents__link toc-highlight">Notes on Gradescope and Autograder</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">CS学习社区</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">路线图</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/WqwvTrEQmA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">捐赠</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/donate">捐赠我们</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyleft © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.30603f7d.js"></script>
<script src="/assets/js/main.b37f8dfa.js"></script>
</body>
</html>