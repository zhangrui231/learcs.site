<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-curriculum-resource/cs61a/project/scheme" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Scheme | CS自学社区</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.learncs.site/docs/curriculum-resource/cs61a/project/scheme"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Scheme | CS自学社区"><meta data-rh="true" name="description" content="Money Tree"><meta data-rh="true" property="og:description" content="Money Tree"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.learncs.site/docs/curriculum-resource/cs61a/project/scheme"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/cs61a/project/scheme" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/cs61a/project/scheme" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CS自学社区 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CS自学社区 Atom Feed">



<link rel="preconnect" href="https://hm.baidu.com">
<script async src="https://hm.baidu.com/hm.js?c106b2729592653e5e0c26db5e5d3142"></script>
<script src="https://sf-cdn.coze.com/obj/unpkg-va/flow-platform/chat-app-sdk/0.1.0-beta.4/libs/oversea/index.js"></script>
<script>document.addEventListener("DOMContentLoaded",(function(){console.log("DOMContentLoaded coze"),new CozeWebSDK.WebChatClient({config:{bot_id:"7380921096788590598"},componentProps:{title:"AI 助教"}})}))</script><link rel="stylesheet" href="/assets/css/styles.0cbaf963.css">
<link rel="preload" href="/assets/js/runtime~main.50f11cc7.js" as="script">
<link rel="preload" href="/assets/js/main.cf349332.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">TeachYourselfCS</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">自学路线</a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/community">社区</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">前言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/roadmap">路线图</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/课程资源">课程资源</a><button aria-label="Toggle the collapsible sidebar category &#x27;课程资源&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x">cs50x</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs61a">cs61a</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61a&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs61a/syllabus">syllabus-课程大纲</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61a/dis/disc00">discussion </a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61a/homework/hw01">homework </a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61a/lab/lab00">lab </a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs61a/project/hog">project </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs61a/project/hog">Hog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs61a/project/cats">Cats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs61a/project/ants">Ants</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/curriculum-resource/cs61a/project/scheme">Scheme</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs61a/project/scheme_contest">Scheme Gallery</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61b">cs61b</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61b&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61c">cs61c</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61c&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/课程资源"><span itemprop="name">课程资源</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/cs61a"><span itemprop="name">cs61a</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">project </span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Scheme</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Project 4: Scheme Interpreter | CS 61A Spring 2024</h1><blockquote><p><img loading="lazy" alt="Money Tree" src="/assets/images/money_tree-0801b6f966afc035aaebfc0520a56427.png" width="427" height="245" class="img_ev3q"></p><p>Eval calls apply,<br>
<!-- -->which just calls eval again!<br>
<!-- -->When does it all end?</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><blockquote><p><strong>Important submission note</strong>: For full credit,</p><ul><li>Submit with Part 1 complete by <strong>Monday, April 15</strong> (worth 1 pt).</li><li>Submit with Parts 2 &amp; 3 (including passing all tests provided in <code>tests.scm</code>) complete by <strong>Thursday, April 18</strong> (worth 1 pt).</li><li>Submit with all phases complete by <strong>Tuesday, April 23</strong>. Try to attempt the problems in order, as some later problems will depend on earlier problems in their implementation and therefore also when running <code>ok</code> tests.</li></ul><p>The entire project can be completed with a partner.</p><p>You can get 1 EC point by submitting the entire project by <strong>Monday, April 22</strong>.</p></blockquote><p>In this project, you will develop an interpreter for a subset of the Scheme language. As you proceed, think about the issues that arise in the design of a programming language; many quirks of languages are byproducts of implementation decisions in interpreters and compilers. The subset of the language used in this project is described in the <a href="https://www.composingprograms.com/pages/32-functional-programming.html" target="_blank" rel="noopener noreferrer">functional programming</a> section of Composing Programs, as well as this <a href="https://cs61a.org/articles/scheme-spec/" target="_blank" rel="noopener noreferrer">language specification</a> and <a href="https://cs61a.org/articles/scheme-builtins/" target="_blank" rel="noopener noreferrer">built-in procedure reference</a>.</p><p>Watch the lecture on Interpreters for an overview of the project.</p><p>In addition, there will be a completely optional open-ended art contest (released separately) that challenges you to produce recursive images in only a few lines of Scheme. As an example, the picture above abstractly depicts all the ways of making change for $0.50 using U.S. currency. All flowers appear at the end of a branch with length 50. Small angles in a branch indicate an additional coin, while large angles indicate a new currency denomination. In the contest, you too will have the chance to unleash your inner recursive artist.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="download-starter-files">Download starter files<a href="#download-starter-files" class="hash-link" aria-label="Direct link to Download starter files" title="Direct link to Download starter files">​</a></h2><p>You can download all of the project code as a <a target="_blank" href="/assets/files/scheme-5505367d4084c6a9cbad9d547f491fe7.zip">zip archive</a>.</p><p>Files you will edit:</p><ul><li><code>scheme_eval_apply.py</code>: the recursive evaluator for Scheme expressions</li><li><code>scheme_forms.py</code>: evaluation for special forms</li><li><code>scheme_classes.py</code>: classes that describe Scheme expressions</li><li><code>questions.scm</code>: Scheme procedures for you to implement</li></ul><p>The rest of the files in the project:</p><ul><li><code>scheme.py</code>: the interpreter REPL</li><li><code>pair.py</code>: defines the <code>Pair</code> class and the <code>nil</code> object</li><li><code>scheme_builtins.py</code>: built-in Scheme procedures</li><li><code>scheme_reader.py</code>: the reader for Scheme input</li><li><code>scheme_tokens.py</code>: the tokenizer for Scheme input</li><li><code>scheme_utils.py</code>: functions for inspecting Scheme expressions</li><li><code>ucb.py</code>: utility functions for use in 61A projects</li><li><code>tests.scm</code>: a collection of test cases written in Scheme</li><li><code>ok</code>: the autograder</li><li><code>tests</code>: a directory of tests used by <code>ok</code></li><li><code>mytests.rst</code>: a file where you can add your own tests</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="logistics">Logistics<a href="#logistics" class="hash-link" aria-label="Direct link to Logistics" title="Direct link to Logistics">​</a></h2><p>The project is worth 30 points. 28 points are for correctness, 1 point is for submitting Part 1 by the first checkpoint date, and 1 point is for submitting Parts 2 &amp; 3 by the second checkpoint date.</p><p>You will turn in the following files:</p><ul><li><code>scheme_eval_apply.py</code></li><li><code>scheme_forms.py</code></li><li><code>scheme_classes.py</code></li><li><code>questions.scm</code></li></ul><p>You do not need to modify or turn in any other files to complete the project. To submit the project, <strong>submit the required files to the appropriate Gradescope assignment.</strong></p><p>For the functions that we ask you to complete, there may be some initial code that we provide. If you would rather not use that code, feel free to delete it and start from scratch. You may also add new function definitions as you see fit.</p><p><strong>However, please do not modify any other functions or edit any files not listed above</strong>. Doing so may result in your code failing our autograder tests. Also, please do not change any function signatures (names, argument order, or number of arguments).</p><p>Throughout this project, you should be testing the correctness of your code. It is good practice to test often, so that it is easy to isolate any problems. However, you should not be testing <em>too</em> often, to allow yourself time to think through problems.</p><p>We have provided an <strong>autograder</strong> called <code>ok</code> to help you with testing your code and tracking your progress. The first time you run the autograder, you will be asked to <strong>log in with your Ok account using your web browser</strong>. Please do so. Each time you run <code>ok</code>, it will back up your work and progress on our servers.</p><p>The primary purpose of <code>ok</code> is to test your implementations.</p><p>If you want to test your code interactively, you can run</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> python3 ok -q [question number] -i </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>with the appropriate question number (e.g. <code>01</code>) inserted. This will run the tests for that question until the first one you failed, then give you a chance to test the functions you wrote interactively.</p><p>You can also use the debugging print feature in OK by writing</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> print(&quot;DEBUG:&quot;, x) </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>which will produce an output in your terminal without causing OK tests to fail with extra output.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="interpreter-details">Interpreter details<a href="#interpreter-details" class="hash-link" aria-label="Direct link to Interpreter details" title="Direct link to Interpreter details">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scheme-features">Scheme features<a href="#scheme-features" class="hash-link" aria-label="Direct link to Scheme features" title="Direct link to Scheme features">​</a></h3><p><strong>Read-Eval-Print.</strong> The interpreter reads Scheme expressions, evaluates them, and displays the results.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (+ 2 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; ((lambda (x) (* x x)) 5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">25</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The starter code for your Scheme interpreter can successfully evaluate the first expression above, since it consists of a single number. The second (a call to a built-in procedure) and the third (a computation of 5 squared) will not work just yet.</p><p><strong>Load.</strong> You can load a file by passing in a symbol for the file name. For example, to load <code>tests.scm</code>, evaluate the following call expression.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (load &#x27;tests)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Symbols.</strong> In the dialect of Scheme we use in CS 61A, a symbol (or <em>identifier</em>) is a sequence of letters (a-z and A-Z), digits, and characters in <code>!$%&amp;*/:&lt;=&gt;?@^_~-+.</code> that do not form a valid integer or floating-point numeral.</p><p>Our version of Scheme is case-insensitive: two identifiers are considered identical if they differ only in the capitalization of letters. They are internally represented and printed in lower case:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; &#x27;Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Turtle Graphics.</strong> In addition to standard Scheme procedures, we include procedure calls to the Python <code>turtle</code> package. This will come in handy for the contest.</p><p>If you&#x27;re curious, you can read the <a href="http://docs.python.org/py3k/library/turtle.html" target="_blank" rel="noopener noreferrer">turtle module documentation</a> online.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-interpreter">Running the interpreter<a href="#running-the-interpreter" class="hash-link" aria-label="Direct link to Running the interpreter" title="Direct link to Running the interpreter">​</a></h3><p>To start an interactive Scheme interpreter session, type:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 scheme.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To exit the Scheme interpreter, press <code>Ctrl-d</code> on Mac/Linux (or <code>Ctrl-z Enter</code> on Windows) or evaluate the <code>exit</code> procedure (after completing problems 3 and 4):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (exit)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can use your Scheme interpreter to evaluate the expressions in an input file by passing the file name as a command-line argument to <code>scheme.py</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 scheme.py tests.scm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>tests.scm</code> file contains a long list of sample Scheme expressions and their expected values. Many of these examples are from Chapters 1 and 2 of <a href="https://mitp-content-server.mit.edu/books/content/sectbyfn/books_pres_0/6515/sicp.zip/index.html" target="_blank" rel="noopener noreferrer">Structure and Interpretation of Computer Programs</a>, the textbook from which Composing Programs is adapted.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started-videos">Getting Started Videos<a href="#getting-started-videos" class="hash-link" aria-label="Direct link to Getting Started Videos" title="Direct link to Getting Started Videos">​</a></h2><p>These videos may provide some helpful direction for tackling the coding problems on this assignment.</p><blockquote><p>To see these videos, you should be logged into your berkeley.edu email.</p></blockquote><p><a href="https://youtu.be/playlist?list=PLx38hZJ5RLZez4iVyVRr52Eknxs4RF27w" target="_blank" rel="noopener noreferrer">YouTube link</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-1-the-evaluator">Part 1: The Evaluator<a href="#part-1-the-evaluator" class="hash-link" aria-label="Direct link to Part 1: The Evaluator" title="Direct link to Part 1: The Evaluator">​</a></h2><p>In Part 1, you will develop the following features of the interpreter:</p><ul><li>Symbol evaluation</li><li>Calling built-in procedures</li><li>Definitions</li></ul><p>In the starter implementation given to you, the interpreter can only evaluate self-evaluating expressions: numbers, booleans, and <code>nil</code>.</p><p>First, read the relevant code. In the &quot;Eval/Apply&quot; section of <code>scheme_eval_apply.py</code>:</p><ul><li><code>scheme_eval</code> evaluates a Scheme expression in the given environment. This function is nearly complete but is missing the logic for call expressions.</li><li>When evaluating a special form, <code>scheme_eval</code> redirects evaluation to an appropriate <code>do_?_form</code> function found in <code>scheme_forms.py</code></li><li><code>scheme_apply</code> applies a procedure to some arguments.</li></ul><p>In the &quot;Environments&quot; and &quot;Procedures&quot; sections of <code>scheme_classes.py</code>:</p><ul><li>The <code>Frame</code> class implements an environment frame.</li><li>The <code>LambdaProcedure</code> class (in the &quot;Procedures&quot; section) represents user-defined procedures.</li></ul><p>These are all of the essential components of the interpreter. <code>scheme_forms.py</code> defines special forms, <code>scheme_builtins.py</code> defines the various functions built into the standard library, and <code>scheme.py</code> defines the user interface to the interpreter.</p><blockquote><p><strong>IMPORTANT NOTE:</strong> As all non-atomic Scheme expressions (i.e. call expressions and special forms) are Scheme lists (and therefore linked lists), we represent all non-atomic Scheme expressions using the <code>Pair</code> class, which behaves like a linked list. For example, the expression <code>(+ 1 2)</code> will be represented in our interpreter as <code>Pair(&#x27;+&#x27;, Pair(1, Pair(2, nil)))</code>. <strong>This class is defined in <code>pair.py</code>.</strong> Please take a look at this class before starting the project!</p></blockquote><p>Use Ok to test your understanding:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q eval_apply -u</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-1-1-pt">Problem 1 (1 pt)<a href="#problem-1-1-pt" class="hash-link" aria-label="Direct link to Problem 1 (1 pt)" title="Direct link to Problem 1 (1 pt)">​</a></h3><p>Implement the <code>define</code> and <code>lookup</code> methods of the <code>Frame</code> class in <code>scheme_classes.py</code>. Each <code>Frame</code> object has the following instance attributes:</p><ul><li><code>bindings</code> is a dictionary representing the bindings in the frame. Each item associates a Scheme symbol (represented as a Python string) to a Scheme value.</li><li><code>parent</code> is the parent <code>Frame</code> instance. The parent of the Global Frame is <code>None</code>.</li></ul><p>In <code>scheme_classes.py</code>:</p><ol><li><p><code>define</code> takes a symbol (represented by a Python string) and a value. It binds the symbol to the value in the <code>Frame</code> instance.</p></li><li><p><code>lookup</code> takes a symbol and returns the value bound to that symbol in the first frame of the environment in which the symbol is bound. The <em>environment</em> for a <code>Frame</code> instance consists of that frame, its parent frame, and all its ancestor frames, including the Global Frame. When looking up a symbol:</p><ul><li>If the symbol is bound in the current frame, return its value.</li><li>If the symbol is not bound in the current frame and the frame has a parent frame, look up the symbol in the parent frame.</li><li>If the symbol is not found in the current frame and there is no parent frame, raise a <code>SchemeError</code>.</li></ul></li></ol><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 01 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 01</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After you complete this problem, you can start your Scheme interpreter (with <code>python3 scheme.py</code>). You should be able to look up built-in procedure names:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[+]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; odd?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[odd?]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, your Scheme interpreter will still not be able to call these procedures until you complete the next problem.</p><p>Remember, at this point, you can only exit the interpreter by pressing <code>Ctrl-d</code> on Max/Linux (or <code>Ctrl-z Enter</code> on Windows).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-2-2-pt">Problem 2 (2 pt)<a href="#problem-2-2-pt" class="hash-link" aria-label="Direct link to Problem 2 (2 pt)" title="Direct link to Problem 2 (2 pt)">​</a></h3><p>To be able to call built-in procedures, such as <code>+</code>, you need to complete the <code>BuiltinProcedure</code> case within the <code>scheme_apply</code> function in <code>scheme_eval_apply.py</code>. Built-in procedures are applied by calling a corresponding Python function that implements the procedure.</p><blockquote><p>To see a list of all Scheme built-in procedures used in the project, look in the <code>scheme_builtins.py</code> file. Any function decorated with <code>@builtin</code> will be added to the globally-defined <code>BUILTINS</code> list.</p></blockquote><p>A <code>BuiltinProcedure</code> has two instance attributes:</p><ul><li><code>py_func</code>: the <em>Python</em> function that implements the built-in Scheme procedure.</li><li><code>need_env</code>: a Boolean flag that indicates whether or not this built-in procedure will need the current environment to be passed in as the last argument. The environment is required, for instance, to implement the built-in <code>eval</code> procedure.</li></ul><p><code>scheme_apply</code> takes the <code>procedure</code> object, a list of argument values, and the current environment. <code>args</code> is a Scheme list represented as a <code>Pair</code> object or <code>nil</code>.</p><blockquote><p>Your implementation should do the following:</p><ul><li>Convert the Scheme list to a Python list of arguments. <em>Hint:</em> <code>args</code> is a <code>Pair</code>, which has a <code>.first</code> and <code>.rest</code> attribute.</li><li>If <code>procedure.need_env</code> is <code>True</code>, then add the current environment <code>env</code> as the last argument to this Python list.</li><li>Return the result of calling <code>procedure.py_func</code> on all of those arguments. Use <code>*args</code> notation: <code>f(1, 2, 3)</code> is equivalent to <code>f(*[1, 2, 3]</code>). Do this part within the <code>try</code> statement provided, after the line that says <code>try:</code>.</li></ul></blockquote><p>We have already implemented the following behavior for you:</p><ul><li>If calling the function results in a <code>TypeError</code> exception being raised, then the wrong number of arguments were passed. The <code>try</code> statement handles this exception and raises a <code>SchemeError</code> with the message <code>&#x27;incorrect number of arguments&#x27;</code>.</li></ul><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 02 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 02</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>👩🏽‍💻👨🏿‍💻 <a href="https://cs61a.org/articles/pair-programming" target="_blank" rel="noopener noreferrer">Pair programming?</a> Remember to alternate between driver and navigator roles. The driver controls the keyboard; the navigator watches, asks questions, and suggests ideas.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-3-2-pt">Problem 3 (2 pt)<a href="#problem-3-2-pt" class="hash-link" aria-label="Direct link to Problem 3 (2 pt)" title="Direct link to Problem 3 (2 pt)">​</a></h3><p>The <code>scheme_eval</code> function (in <code>scheme_eval_apply.py</code>) evaluates a Scheme expression in an environment. The provided code already looks up symbols in the current environment, returns self-evaluating expressions (such as numbers), and evaluates special forms.</p><p>Implement the missing part of <code>scheme_eval</code>, which evaluates a call expression. To evaluate a call expression:</p><ol><li>Evaluate the operator (which should evaluate to a <code>Procedure</code> instance).</li><li>Evaluate all of the operands and collect the results (the argument values) in a Scheme list.</li><li>Return the result of calling <code>scheme_apply</code> on this <code>Procedure</code> and these argument values.</li></ol><p>You&#x27;ll have to recursively call <code>scheme_eval</code> in the first two steps. Here are some other functions/methods you should use:</p><ul><li>The <code>map</code> method of <code>Pair</code> returns a new Scheme list constructed by applying a <em>one-argument function</em> to every item in a Scheme list.</li><li>The <code>scheme_apply</code> function applies a Scheme procedure to arguments represented as a Scheme list (a <code>Pair</code> instance or <code>nil</code>).</li></ul><blockquote><p>Important: do not mutate the passed-in <code>expr</code>. That would change a program as it&#x27;s being evaluated, creating strange and incorrect effects.</p></blockquote><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 03 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 03</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Some of these tests call a primitive (built-in) procedure called <code>print-then-return</code>. This procedure doesn&#x27;t exist in Scheme, but was added to this project just to test this question. <code>print-then-return</code> takes two arguments. It prints out its first argument and returns the second. You can find this function at the bottom of <code>scheme_builtins.py</code></p></blockquote><p>Your interpreter should now be able to evaluate built-in procedure calls, giving you the functionality of the Calculator language and more. Run <code>python3 scheme.py</code>, and you can now add and multiply!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (+ 1 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (* 3 4 (- 5 2) 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (odd? 31)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-4-2-pt">Problem 4 (2 pt)<a href="#problem-4-2-pt" class="hash-link" aria-label="Direct link to Problem 4 (2 pt)" title="Direct link to Problem 4 (2 pt)">​</a></h3><p>The <code>define</code> special form (<a href="https://cs61a.org/articles/scheme-spec/#define" target="_blank" rel="noopener noreferrer">spec</a>) in Scheme can be used either to assign a symbol to the value of a given expression or to create a procedure and bind it to a symbol:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define a (+ 2 3))  ; Binds the symbol a to the value of (+ 2 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define (foo x) x)  ; Creates a procedure and binds it to the symbol foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The type of the first operand tells us what is being defined:</p><ul><li>If it is a symbol, e.g. <code>a</code>, then the expression is defining a symbol.</li><li>If it is a list, e.g. <code>(foo x)</code>, then the expression is creating a procedure.</li></ul><p>The <code>do_define_form</code> function in <code>scheme_forms.py</code> evaluates <code>(define ...)</code> expressions. There are two missing parts in this function. For this problem, implement <strong>just the first part</strong>, which evaluates the second operand to obtain a value and binds the first operand, a symbol, to that value. Then, <code>do_define_form</code> returns the symbol that was bound.</p><blockquote><p><em>Hint:</em> The <code>define</code> method of a <code>Frame</code> instance creates a binding in that frame.</p></blockquote><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 04 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 04</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should now be able to assign values to symbols and evaluate those symbols.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define x 15)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define y (* 2 x))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following <code>ok</code> test determines whether the operator of a call expression is evaluated multiple times. The operator should be evaluated only a <em>single</em> time before raising an error (because <code>x</code> is not bound to a procedure).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define x 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; expect x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">((define x (+ x 1)) 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; expect SchemeError</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; expect 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the operator is evaluated twice, then <code>x</code> will be bound to 2 instead of 1 at the end, causing the test to fail. Therefore, if your code fails this test, you&#x27;ll want to make sure you only evaluate the operator of a call expression once in <code>scheme_eval</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-5-1-pt">Problem 5 (1 pt)<a href="#problem-5-1-pt" class="hash-link" aria-label="Direct link to Problem 5 (1 pt)" title="Direct link to Problem 5 (1 pt)">​</a></h3><p>In Scheme, you can quote expressions in two ways: with the <code>quote</code> special form (<a href="https://cs61a.org/articles/scheme-spec/#quote" target="_blank" rel="noopener noreferrer">spec</a>) or with the symbol <code>&#x27;</code>. The reader converts <code>&#x27;...</code> into <code>(quote ...)</code>, so that your interpreter only needs to evaluate the <code>(quote ...)</code> syntax. The <code>quote</code> special form returns its operand expression without evaluating it:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (quote hello)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; &#x27;(cons 1 2)  ; Equivalent to (quote (cons 1 2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(cons 1 2)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Implement the <code>do_quote_form</code> function in <code>scheme_forms.py</code> so that it simply returns the unevaluated operand of the <code>(quote ...)</code> expression.</p><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 05 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 05</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After completing this function, you should be able to evaluate quoted expressions. Try out some of the following in your interpreter!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (quote a)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (quote (1 2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (quote (1 (2 three (4 5))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1 (2 three (4 5)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (car (quote (a b)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; &#x27;hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; &#x27;(1 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; &#x27;(1 (2 three (4 5)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1 (2 three (4 5)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (car &#x27;(a b))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (eval (cons &#x27;car &#x27;(&#x27;(1 2))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (eval (define tau 6.28))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6.28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (eval &#x27;tau)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6.28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; tau</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6.28</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Submit your Phase 1 checkpoint</strong></p><p>Check to make sure that you completed all the problems in Phase 1:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok --score</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, submit <code>scheme_eval_apply.py</code>, <code>scheme_forms.py</code>, <code>scheme_classes.py</code>, and <code>questions.scm</code> to the <strong>Scheme Checkpoint 1</strong> assignment on <strong>Gradescope</strong> before the first checkpoint deadline.</p><p>When you run <code>ok</code> commands, you&#x27;ll still see that some tests are locked because you haven&#x27;t completed the whole project yet. You&#x27;ll get full credit for the checkpoint if you complete all the problems up to this point.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-2-procedures">Part 2: Procedures<a href="#part-2-procedures" class="hash-link" aria-label="Direct link to Part 2: Procedures" title="Direct link to Part 2: Procedures">​</a></h2><p>In Part 2, you will add the ability to create and call user-defined procedures. You will add the following features to the interpreter:</p><ul><li>Lambda procedures, using the <code>(lambda ...)</code> special form</li><li>Named procedures, using the <code>(define (...) ...)</code> special form</li><li>Dynamically scoped mu procedures, using the <code>(mu ...)</code> special form.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-defined-procedures">User-Defined Procedures<a href="#user-defined-procedures" class="hash-link" aria-label="Direct link to User-Defined Procedures" title="Direct link to User-Defined Procedures">​</a></h3><p>User-defined lambda procedures are represented as instances of the <code>LambdaProcedure</code> class. A <code>LambdaProcedure</code> instance has three instance attributes:</p><ul><li><code>formals</code> is a Scheme list of the formal parameters (symbols) that name the arguments of the procedure.</li><li><code>body</code> is a Scheme list of expressions; the body of the procedure.</li><li><code>env</code> is the environment in which the procedure was <strong>defined</strong>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-6-1-pt">Problem 6 (1 pt)<a href="#problem-6-1-pt" class="hash-link" aria-label="Direct link to Problem 6 (1 pt)" title="Direct link to Problem 6 (1 pt)">​</a></h3><p>Change the <code>eval_all</code> function in <code>scheme_eval_apply.py</code> (which is called from <code>do_begin_form</code> in <code>scheme_forms.py</code>) to complete the implementation of the <code>begin</code> special form (<a href="https://cs61a.org/articles/scheme-spec/#begin" target="_blank" rel="noopener noreferrer">spec</a>).</p><p>A <code>begin</code> expression is evaluated by evaluating all sub-expressions in order. The value of the <code>begin</code> expression is the value of the final sub-expression.</p><p>To complete the implementation of <code>begin</code>, <code>eval_all</code> will take in <code>expressions</code> (a Scheme list of expressions) and <code>env</code> (a <code>Frame</code> representing the current environment), evaluate all the expressions in <code>expressions</code>, and return the value of the last expression in <code>expressions</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (begin (+ 2 3) (+ 5 6))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define x (begin (display 3) (newline) (+ 2 3)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (+ x 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (begin (print 3) &#x27;(+ 2 3))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(+ 2 3)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If <code>eval_all</code> is passed an empty list of expressions (<code>nil</code>), then it should return the Python value <code>None</code>, which represents the Scheme value <code>undefined</code>.</p><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 06 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 06</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>👩🏽‍💻👨🏿‍💻 <a href="https://cs61a.org/articles/pair-programming" target="_blank" rel="noopener noreferrer">Pair programming?</a> This would be a good time to switch roles. Switching roles makes sure that you both benefit from the learning experience of being in each role.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-7-2-pt">Problem 7 (2 pt)<a href="#problem-7-2-pt" class="hash-link" aria-label="Direct link to Problem 7 (2 pt)" title="Direct link to Problem 7 (2 pt)">​</a></h3><p>Implement the <code>do_lambda_form</code> function (<a href="https://cs61a.org/articles/scheme-spec/#lambda" target="_blank" rel="noopener noreferrer">spec</a>) in <code>scheme_forms.py</code>, which creates and returns a <code>LambdaProcedure</code> instance. While you cannot call a user-defined procedure yet, you can verify that you have created the procedure correctly by evaluating a lambda expression.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (lambda (x y) (+ x y))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(lambda (x y) (+ x y))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In Scheme, it is legal to place more than one expression in the body of a procedure. (There must be at least one expression.) The <code>body</code> attribute of a <code>LambdaProcedure</code> instance is therefore a Scheme list of body expressions. The <code>formals</code> attribute of a <code>LambdaProcedure</code> instance should be a properly nested <code>Pair</code> expression. Like a <code>begin</code> special form, evaluating the body of a procedure evaluates all body expressions in order. The return value of a procedure is the value of its last body expression.</p><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 07 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 07</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-8-2-pt">Problem 8 (2 pt)<a href="#problem-8-2-pt" class="hash-link" aria-label="Direct link to Problem 8 (2 pt)" title="Direct link to Problem 8 (2 pt)">​</a></h3><p>Implement the <code>make_child_frame</code> method of the <code>Frame</code> class (in <code>scheme_classes.py</code>), which will be used to create new frames when calling user-defined procedures. This method takes in two arguments: <code>formals</code>, which is a Scheme list of symbols, and <code>vals</code>, which is a Scheme list of values. It should return a new child frame, binding the formal parameters to the values.</p><p>To do this:</p><ul><li>If the number of argument values does not match with the number of formal parameters, raise a <code>SchemeError</code>.</li><li>Create a new <code>Frame</code> instance, the parent of which is <code>self</code>.</li><li>Bind each formal parameter to its corresponding argument value in the newly created frame. The first symbol in <code>formals</code> should be bound to the first value in <code>vals</code>, and so on.</li><li>Return the new frame.</li></ul><blockquote><p><em>Hint:</em> The <code>define</code> method of a <code>Frame</code> instance creates a binding in that frame.</p></blockquote><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 08 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 08</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-9-2-pt">Problem 9 (2 pt)<a href="#problem-9-2-pt" class="hash-link" aria-label="Direct link to Problem 9 (2 pt)" title="Direct link to Problem 9 (2 pt)">​</a></h3><p>Implement the <code>LambdaProcedure</code> case in the <code>scheme_apply</code> function in <code>scheme_eval_apply.py</code>.</p><p>You should first create a new <code>Frame</code> instance using the <code>make_child_frame</code> method of the appropriate parent frame, binding formal parameters to argument values. Then, evaluate each of the expressions of the body of the procedure using <code>eval_all</code> within this new frame.</p><p><strong>Important:</strong> Your new frame should be a child of the frame in which the lambda is defined. Note that the <code>env</code> provided as an argument to <code>scheme_apply</code> is instead the frame in which the procedure is called. See <a href="#user-defined-procedures">User-Defined Procedures</a> to remind yourself of the attributes of <code>LambdaProcedure</code>.</p><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 09 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 09</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-10-1-pt">Problem 10 (1 pt)<a href="#problem-10-1-pt" class="hash-link" aria-label="Direct link to Problem 10 (1 pt)" title="Direct link to Problem 10 (1 pt)">​</a></h3><p>Currently, your Scheme interpreter is able to bind symbols to user-defined procedures in the following manner:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define f (lambda (x) (* x 2)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, we&#x27;d like to be able to use the shorthand form of defining named procedures:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define (f x) (* x 2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Modify the <code>do_define_form</code> function in <code>scheme_forms.py</code> so that it correctly handles <code>define (...) ...)</code> expressions (<a href="https://cs61a.org/articles/scheme-spec/#define" target="_blank" rel="noopener noreferrer">spec</a>).</p><p>Make sure that it can handle multi-expression bodies. For example,</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define (g y) (print y) (+ y 1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (g 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are (at least) two ways to solve this problem. One is to construct an expression <code>(define _ (lambda ...))</code> and call <code>do_define_form</code> on it (omitting the <code>define</code>). The second is to implement it directly:</p><ul><li>Using the given variables <code>signature</code> and <code>expressions</code>, find the defined function&#x27;s name (symbol), formals, and body.</li><li>Create a <code>LambdaProcedure</code> instance using the formals and body. (You could call <code>do_lambda_form</code> to do this.)</li><li>Bind the symbol to this new <code>LambdaProcedure</code> instance.</li><li>Return the symbol that was bound.</li></ul><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 10 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-11-1-pt">Problem 11 (1 pt)<a href="#problem-11-1-pt" class="hash-link" aria-label="Direct link to Problem 11 (1 pt)" title="Direct link to Problem 11 (1 pt)">​</a></h3><p>All of the Scheme procedures we&#x27;ve seen so far use <em>lexical scoping</em>: the parent of the new call frame is the environment in which the procedure was <strong>defined</strong>. Another type of scoping, which is not standard in Scheme but appears in other variants of Lisp, is called <em>dynamic scoping</em>: the parent of the new call frame is the environment in which the call expression was <strong>evaluated</strong>. With dynamic scoping, calling the same procedure with the same arguments from different parts of your code can create different behavior (due to different parent frames).</p><p>The <code>mu</code> special form (<a href="https://cs61a.org/articles/scheme-spec/#mu" target="_blank" rel="noopener noreferrer">spec</a>; invented for this project) evaluates to a dynamically scoped procedure.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define f (mu () (* a b)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define g (lambda () (define a 4) (define b 5) (f)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (g)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Above, the procedure <code>f</code> does not have <code>a</code> or <code>b</code> as arguments; however, because <code>f</code> gets called <strong>within</strong> the procedure <code>g</code>, it has access to the <code>a</code> and <code>b</code> defined in <code>g</code>&#x27;s frame.</p><p>Your job:</p><ul><li>Implement <code>do_mu_form</code> in <code>scheme_forms.py</code> to evaluate the <code>mu</code> special form. A <code>mu</code> expression evaluates to a <code>MuProcedure</code>. The <code>MuProcedure</code> class (defined in <code>scheme_classes.py</code>) has been provided for you.</li><li>In addition to implementing <code>do_mu_form</code>, complete the <code>MuProcedure</code> case within the <code>scheme_apply</code> function (in <code>scheme_eval_apply.py</code>) so that when a mu procedure is called, its body is evaluated in the correct environment. When a <code>MuProcedure</code> is called, the parent of the new call frame is the environment in which that call expression was <strong>evaluated</strong>. As a result, a <code>MuProcedure</code> does not need to store an environment as an instance attribute.</li></ul><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 11 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 11</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At this point in the project, your Scheme interpreter should support the following features:</p><ul><li>Creating procedures using <code>lambda</code> and <code>mu</code> expressions,</li><li>Defining named procedures using <code>define</code> expressions, and</li><li>Calling user-defined procedures.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-3-special-forms">Part 3: Special Forms<a href="#part-3-special-forms" class="hash-link" aria-label="Direct link to Part 3: Special Forms" title="Direct link to Part 3: Special Forms">​</a></h2><p>This section will be completed in <code>scheme_forms.py</code>.</p><p>Logical special forms include <code>if</code>, <code>and</code>, <code>or</code>, and <code>cond</code>. These expressions are special because not all of their sub-expressions may be evaluated.</p><p>In Scheme, only <code>#f</code> is a false value. All other values (including <code>0</code> and <code>nil</code>) are true values. You can test whether a value is a true or false value using the provided Python functions <code>is_scheme_true</code> and <code>is_scheme_false</code>, defined in <code>scheme_utils.py</code>.</p><blockquote><p>Scheme traditionally uses <code>#f</code> to indicate the false Boolean value. In our interpreter, that is equivalent to <code>false</code> or <code>False</code>. Similarly, <code>true</code>, <code>True</code>, and <code>#t</code> are all equivalent. However, <strong>when unlocking tests</strong>, use <code>#t</code> and <code>#f</code>.</p></blockquote><p>To get you started, we&#x27;ve provided an implementation of the <code>if</code> special form in the <code>do_if_form</code> function. Make sure you understand that implementation before starting the following questions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-12-2-pt">Problem 12 (2 pt)<a href="#problem-12-2-pt" class="hash-link" aria-label="Direct link to Problem 12 (2 pt)" title="Direct link to Problem 12 (2 pt)">​</a></h3><p>Implement <code>do_and_form</code> and <code>do_or_form</code> so that <code>and</code> and <code>or</code> expressions (<a href="https://cs61a.org/articles/scheme-spec/#and" target="_blank" rel="noopener noreferrer">spec</a>) are evaluated correctly.</p><p>The logical forms <code>and</code> and <code>or</code> are <em>short-circuiting</em>. For <code>and</code>, your interpreter should evaluate each sub-expression from left to right, and if any of these is a false value, return that value. Otherwise, return the value of the last sub-expression. If there are no sub-expressions in an <code>and</code> expression, it evaluates to <code>#t</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (and)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (and 4 5 6)  ; all operands are true values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (and 4 5 (+ 3 3))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (and #t #f 42 (/ 1 0))  ; short-circuiting behavior of and</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Internal to the interpreter, represent Scheme&#x27;s <code>#t</code> as Python&#x27;s <code>True</code> and Scheme&#x27;s <code>#f</code> as Python&#x27;s <code>False</code>.</p></blockquote><p>For <code>or</code>, evaluate each sub-expression from left to right. If any sub-expression evaluates to a true value, return that value. Otherwise, return the value of the last sub-expression. If there are no sub-expressions in an <code>or</code> expression, it evaluates to <code>#f</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (or)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (or 5 2 1)  ; 5 is a true value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (or #f (- 1 1) 1)  ; 0 is a true value in Scheme</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (or 4 #t (/ 1 0))  ; short-circuiting behavior of or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Important:</strong> Use the provided Python functions <code>is_scheme_true</code> and <code>is_scheme_false</code> from <code>scheme_utils.py</code> to test boolean values.</p><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 12 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 12</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-13-2-pt">Problem 13 (2 pt)<a href="#problem-13-2-pt" class="hash-link" aria-label="Direct link to Problem 13 (2 pt)" title="Direct link to Problem 13 (2 pt)">​</a></h3><p>Fill in the missing parts of <code>do_cond_form</code> so that it correctly implements <code>cond</code> (<a href="https://cs61a.org/articles/scheme-spec/#cond" target="_blank" rel="noopener noreferrer">spec</a>), returning the value of the first result sub-expression corresponding to a true predicate, or the value of the result sub-expression corresponding to <code>else</code>.</p><p>Some special cases:</p><ul><li>When the true predicate does not have a corresponding result sub-expression, return the predicate value.</li><li>When a result sub-expression of a <code>cond</code> case has multiple expressions, evaluate them all and return the value of the last expression. (<em>Hint</em>: Use <code>eval_all</code>.)</li></ul><p>Your implementation should match the following examples and the additional tests in <code>tests.scm</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (cond ((= 4 3) &#x27;nope)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ((= 4 4) &#x27;hi)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           (else &#x27;wait))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (cond ((= 4 3) &#x27;wat)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ((= 4 4))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           (else &#x27;hm))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (cond ((= 4 4) &#x27;here (+ 40 2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           (else &#x27;wat 0))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">42</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The value of a <code>cond</code> is <code>undefined</code> if there are no true predicates and no <code>else</code>. In such a case, <code>do_cond_form</code> should return <code>None</code>. If there is only an <code>else</code>, return the value of its result sub-expression. If it doesn&#x27;t have one, return <code>#t</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (cond (False 1) (False 2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (cond (else))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 13 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 13</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-14-2-pt">Problem 14 (2 pt)<a href="#problem-14-2-pt" class="hash-link" aria-label="Direct link to Problem 14 (2 pt)" title="Direct link to Problem 14 (2 pt)">​</a></h3><p>The <code>let</code> special form (<a href="https://cs61a.org/articles/scheme-spec/#let" target="_blank" rel="noopener noreferrer">spec</a>) binds symbols to values locally, giving them their initial values. For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define x 5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (define y &#x27;bye)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (let ((x 42)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           (y (* x 10)))  ; this x refers to the global value of x, not 42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       (list x y))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(42 50)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (list x y)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(5 bye)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Implement <code>make_let_frame</code> in <code>scheme_forms.py</code>, which returns a child frame of <code>env</code> that binds the symbol in each element of <code>bindings</code> to the value of its corresponding expression. The <code>bindings</code> Scheme list contains pairs that each contain a symbol and a corresponding expression.</p><p>You may find the following functions and methods useful:</p><ul><li><code>validate_form</code>: this function can be used to validate the structure of each binding. It takes in a Scheme list <code>expr</code> of expressions and a <code>min</code> and <code>max</code> length. If <code>expr</code> is not a list with length between <code>min</code> and <code>max</code> inclusive, it raises an error. If no <code>max</code> is passed in, the default is infinity.</li><li><code>validate_formals</code>: this function validates that its argument is a Scheme list of symbols for which each symbol is distinct.</li></ul><blockquote><p><strong>Hint:</strong> When building new linked lists iteratively, it may be easier to build it from right to left.</p></blockquote><p>Remember to refer to the <a href="https://cs61a.org/articles/scheme-spec/#let" target="_blank" rel="noopener noreferrer">spec</a> if you don&#x27;t understand any of the test cases!</p><p>Use Ok to unlock and test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 14 -u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 14</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-scheme-tests-1-pt">Additional Scheme Tests (1 pt)<a href="#additional-scheme-tests-1-pt" class="hash-link" aria-label="Direct link to Additional Scheme Tests (1 pt)" title="Direct link to Additional Scheme Tests (1 pt)">​</a></h3><p>Your final task in Part III of this project is to make sure that your scheme interpreter passes the additional suite of tests we have provided.</p><p>To run these tests (worth 1 point), run the command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q tests.scm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you have passed all of the required cases, you should see 1/1 points received for <code>tests.scm</code> when you run <code>python ok --score</code>. If you are failing tests due to output from <code>print</code> statements you&#x27;ve added in your code for debugging, make sure to remove those as well for the tests to pass.</p><p><strong>Submit your Phase 2 &amp; 3 checkpoint</strong></p><p>Check to make sure that you completed all the problems in Phase 1:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok --score</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, submit <code>scheme_eval_apply.py</code>, <code>scheme_forms.py</code>, <code>scheme_classes.py</code>, and <code>questions.scm</code> to the <strong>Scheme Checkpoint 2</strong> assignment on <strong>Gradescope</strong> before the second checkpoint deadline.</p><p>When you run <code>ok</code> commands, you&#x27;ll still see that some tests are locked because you haven&#x27;t completed the whole project yet. You&#x27;ll get full credit for the checkpoint if you complete all the problems up to this point.</p><p>Congratulations! Your Scheme interpreter implementation is now complete!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-4-write-some-scheme">Part 4: Write Some Scheme<a href="#part-4-write-some-scheme" class="hash-link" aria-label="Direct link to Part 4: Write Some Scheme" title="Direct link to Part 4: Write Some Scheme">​</a></h2><p>Not only is your Scheme interpreter itself a tree-recursive program, but it is flexible enough to evaluate <em>other</em> recursive programs. Implement the following procedures in the <code>questions.scm</code> file.</p><p>See the <a href="https://cs61a.org/articles/scheme-builtins/" target="_blank" rel="noopener noreferrer">built-in procedure reference</a> for descriptions of the behavior of all built-in Scheme procedures.</p><p>As you use your interpreter, you may discover additional bugs in your interpreter implementation. Therefore, you may find it useful to test your code for these questions in the staff interpreter or the <a href="https://code.cs61a.org/scheme" target="_blank" rel="noopener noreferrer">web editor</a> and then try it in your own interpreter once you are confident your Scheme code is working. You can also use the web editor to visualize the scheme code you&#x27;ve written and help you debug.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scheme-editor">Scheme Editor<a href="#scheme-editor" class="hash-link" aria-label="Direct link to Scheme Editor" title="Direct link to Scheme Editor">​</a></h3><p>As you&#x27;re writing your code, you can debug using the local Scheme Editor. To run this editor, run <code>python3 editor</code>. This should open a window in your browser; if it does not, please navigate to <a href="localhost:31415" target="_blank" rel="noopener noreferrer">localhost:31415</a> and you should see it.</p><p>Make sure to run <code>python3 ok</code> in a separate tab or window so that the editor keeps running.</p><p>👩🏽‍💻👨🏿‍💻 <a href="https://cs61a.org/articles/pair-programming" target="_blank" rel="noopener noreferrer">Pair programming?</a> Remember to alternate between driver and navigator roles. The driver controls the keyboard; the navigator watches, asks questions, and suggests ideas.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-15-2-pt">Problem 15 (2 pt)<a href="#problem-15-2-pt" class="hash-link" aria-label="Direct link to Problem 15 (2 pt)" title="Direct link to Problem 15 (2 pt)">​</a></h3><p>Implement the <code>enumerate</code> procedure, which takes in a list of values and returns a list of two-element lists, where the first element is the index of the value, and the second element is the value itself.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (enumerate &#x27;(3 4 5 6))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">((0 3) (1 4) (2 5) (3 6))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (enumerate &#x27;())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Use Ok to test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 15</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-16-2-pt">Problem 16 (2 pt)<a href="#problem-16-2-pt" class="hash-link" aria-label="Direct link to Problem 16 (2 pt)" title="Direct link to Problem 16 (2 pt)">​</a></h3><p>Implement the <code>merge</code> procedure, which takes in a comparator function <code>ordered?</code> and two lists that are sorted according to the comparator and combines the two lists into a single sorted list. A comparator defines an ordering by comparing two values and returning a true value if and only if the two values are ordered.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (merge &lt; &#x27;(1 4 6) &#x27;(2 5 8))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1 2 4 5 6 8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (merge &gt; &#x27;(6 4 1) &#x27;(8 5 2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(8 6 5 4 2 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (merge &lt; &#x27;(1) &#x27;(2 3 5))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1 2 3 5)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In case of a tie, you can choose to break the tie in any way you wish.</p><p>Use Ok to test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q 16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="optional-problems">Optional Problems<a href="#optional-problems" class="hash-link" aria-label="Direct link to Optional Problems" title="Direct link to Optional Problems">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="optional-problem-1-0-pt">Optional Problem 1 (0 pt)<a href="#optional-problem-1-0-pt" class="hash-link" aria-label="Direct link to Optional Problem 1 (0 pt)" title="Direct link to Optional Problem 1 (0 pt)">​</a></h3><p>In this problem, you will implement tail-call optimization, an essential feature of the Scheme language. Watch this <a href="https://www.youtube.com/watch?v=zOxxB-gdO9U&amp;list=PL6BsET-8jgYVSrrJ9XNFsYQButTbRFlJo" target="_blank" rel="noopener noreferrer">playlist</a> to learn about tail calls.</p><p>We will implement tail-call optimization in Scheme by using a technique called &quot;trampolining&quot; to tail-call optimize our <code>scheme_eval</code> function <em>in Python</em>.</p><p>The heart of our interpreter is <code>scheme_eval</code>, which is a tree recursive function. Therefore, when we make an initial call to <code>scheme_eval</code>, a very large of recursive calls to <code>scheme_eval</code> are subsequently made. This is the case even with the simple <code>foo</code> procedure below: evaluating <code>(foo 4)</code> in the Scheme interpreter results in <code>scheme_eval</code> being called 52 times.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define (foo n)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (if (= n 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (foo (- n 1))))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we only focus on calls to <code>scheme_eval</code> where the provided <code>expr</code> is a call to <code>foo</code>, we see an interesting pattern:</p><p><img loading="lazy" alt="Diagram" src="/assets/images/scheme_eval_recursion-9c0820c2ebc7973ab586aeb6a782f9f1.png" width="849" height="582" class="img_ev3q"></p><p>The structure of recursive calls made by <code>scheme_eval</code> closely mirrors the structure of recursive calls made by <code>foo</code>:</p><ul><li>The call to <code>scheme_eval</code> that calculates <code>(foo 4)</code> eventually makes a recursive call to <code>scheme_eval</code> that calculates <code>(foo 3)</code>. The call to <code>scheme_eval</code> that calculates <code>(foo 3)</code> eventually makes a recursive call to <code>scheme_eval</code> that calculates <code>(foo 2)</code>, and so on.</li><li>In Scheme, the very last thing that happens during the call to <code>(foo 4)</code> is that a recursive call is made to determine <code>(foo 3)</code>. Similarly, in Python, the very last thing that happens during the call to <code>scheme_eval</code> that calculates <code>(foo 4)</code> is that a recursive call is made to <code>scheme_eval</code> to determine <code>(foo 3)</code>. <em>In other words, these <code>scheme_eval</code> calls are tail calls!</em></li><li>In Python, a large number of <code>scheme_eval</code> frames are opened and kept. Each of these <code>scheme_eval</code> frames holds a reference to a <code>foo</code> frame (represented by an instance of the <code>Frame</code> class). The reason our current implementation of the interpreter is keeping these unnecessary <code>foo</code> frames around is because it&#x27;s keeping these <code>scheme_eval</code> frames around as well.</li></ul><p>Because some of the <code>scheme_eval</code> calls are tail calls, we don&#x27;t need to keep all of those frames that are being created in Python. That means that we can tail-call optimize <code>scheme_eval</code>. And because the Scheme frames are stored on the <code>scheme_eval</code> call frames, tail-call optimizing <code>scheme_eval</code> in Python will tail-call optimize the entire interpreter in Scheme.</p><p>As it turns out, tail-call optimizing <code>scheme_eval</code> has other effects in addition to tail-call optimizing Scheme. For example, expressions like <code>(or #f (or #f (or #f f )))</code> also become much more efficient to run.</p><p>Here is a simple recursive procedure, <code>foo</code>, that doesn&#x27;t do very much.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define (foo n)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (if (= n 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (foo (- n 1))))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In your non-tail-call optimized version of Scheme, here&#x27;s what happens when call we <code>foo(4)</code>:</p><p><img loading="lazy" alt="Foo" src="/assets/images/tco-4bea567b2274ca612d73707048276bd5.gif" width="148" height="236" class="img_ev3q"></p><p>In order to calculate <code>(foo 4)</code>, we need to call <code>(foo 3)</code>. In order to calculate <code>(foo 3)</code>, we need to call <code>(foo 2)</code>. In order to calculate <code>(foo 2)</code>, we need to call <code>(foo 1)</code>. In order to calculate <code>(foo 1)</code>, we need to call <code>(foo 0)</code>, which returns <code>0</code>. While all of these recursive calls are happening, each call <em>waits</em> on the result of the next recursive call, and its frame remains open during that time. This is manageable for small inputs, but for <code>(foo 1000000)</code>, over 1 million frames will be simultaneously open at some point! That could crash your computer.</p><p>In most circumstances, this practice of keeping these frames active during subsequent calls is important. For example, in the below code, <code>f</code> calls <code>g</code>; the frame of <code>f</code> needs to remain active while the call to <code>g</code> is ongoing so that we can eventually return to <code>f</code> and complete the code.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define (f x)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (define y (g x))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (* x y))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define (g x)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (* 6 x))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(f 7)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, some procedures, such as <code>foo</code>, make their procedure calls only at the <em>very end</em>. Because the very last thing <code>(foo 4)</code> does is make a call to <code>(foo 3)</code>, there will be nothing left to do in the <code>(foo 4)</code> call after <code>(foo 3)</code> returns. Therefore, we do not need to actually keep around the <code>(foo 4)</code> frame once we have made the recursive call to <code>(foo 3)</code>. Our interpreter is currently saving these frames, even though they are redundant. If we could get rid of these frames when we are done with them, we would solve the issue of large inputs to <code>foo</code> crashing and dramatically improve the efficiency of our program.</p><p>In this situation, where a call is the last thing a procedure evaluates before it returns, that call is said to be in a <strong>tail context</strong>. Full implementations of Scheme all implement <strong>tail-call optimization</strong>, which involves discarding unnecessary frames so that <strong>tail calls</strong> run more efficiently.</p><p>Trampolining is a method of implementing tail call optimization in a language that does not normally support it (e.g. Python) by storing function calls that are in a tail context as unevaluated calls (Thunks), then evaluating and unwrapping them only as needed (Trampolining).</p><p>The basic unit of this method is the Thunk, which represents an unevaluated operation. The simplest way to achieve this effect is by wrapping the operation in a zero-argument function, saving it for later evaluation:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; my_thunk1 = lambda: sqrt(16384) + 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; my_thunk2 = lambda: some_costly_operation(1000)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>These can be &quot;unwrapped&quot; by calling the function, which finally evaluates their interior.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; my_thunk1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">150.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; my_thunk2()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># result of evaluating some_costly_operation(1000)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>These thunks can be nested as well, requiring multiple calls:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; my_nested_thunk = lambda: lambda: lambda: 4 * (2 + 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; thunk2 = my_nested_thunk()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; thunk3 = thunk2()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; result = thunk3()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This &quot;unwrapping&quot; of a nested thunk is the process we call trampolining, and it can be done automatically, calling the thunk until it finally returns a value.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">def trampoline(value):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while callable(value): # While value is still a thunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value = value()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return value</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Why is this useful? Consider our tail-call-optimized factorial:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">def tail_factorial(n, so_far=1):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if n == 0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return so_far</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return tail_factorial(n - 1, so_far * n)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Since Python does not optimize tail calls, a frame is opened at each recursive call and only closed at the very end, causing this to be as bad as the original implementation! Visualizing this as a call stack:</p><p><img loading="lazy" alt="Non-Thunk Calls" src="/assets/images/non_thunked_calls-832b46591c7ac4576b07e04232aaf1e1.png" width="1597" height="749" class="img_ev3q"></p><p>You can see that by the time we get to the base case, every single <code>tail_factorial</code> frame is still open! To fix this, we can apply thunking! Thunking only keeps one <code>thunk_factorial</code> frame open by having each call evaluate exactly one step of the factorial, then return an unevaluated thunk instead of a nested call. The implementation looks like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">def thunk_factorial(n, so_far=1):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    def thunk():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if n == 0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return so_far</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return thunk_factorial(n - 1, so_far * n)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return thunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def factorial(n):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    value = thunk_factorial(n)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while callable(value): # While value is still a thunk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value = value()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return value</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To explain the benefit, consider the new diagram of the function calls, and compare to the original tail recursive version:</p><p><img loading="lazy" alt="Thunk Calls" src="/assets/images/thunked_calls-9fc8c093fd33be91c40e91187590135d.png" width="1744" height="687" class="img_ev3q"></p><p>While the thunked version may initially seem more complicated, notice that there are always at most one <code>thunk_factorial</code> and <code>thunk</code> calls active at a time. This is true no matter how large <code>n</code> gets! At each step, calling the current <code>thunk</code> calculates exactly one step of the factorial, then returns a new <code>thunk</code> for the next step so that the process can continue in the next loop.</p><p>You can also take a closer look by observing this step-by-step diagram that walks through evaluating the first part of <code>factorial(3)</code>:</p><p><img loading="lazy" alt="Detailed Animated Thunk" src="/assets/images/thunk_detailed-793ce654b8db0441483c862aa9749544.gif" width="1200" height="675" class="img_ev3q"></p><p>You can see that returning an unevaluated thunk from <code>thunk_factorial</code> instead of calling itself recursively allows the open frames that have finished evaluating to close, keeping only the necessary frames open at any given time.</p><p>For our Scheme interpreter, an <code>Unevaluated</code> instance is a thunk of <code>scheme_eval</code>, which we want to optimize. We repeatedly evaluate this thunk by calling <code>scheme_eval</code> on the stored arguments, until we get a value (which we return).</p><p>Complete the function <code>optimize_tail_calls</code> in <code>scheme_eval_apply.py</code>. It returns an alternative to <code>scheme_eval</code> that is tail-call optimized in Python. That is it will allow an unbounded number of active tail calls to <code>scheme_eval</code> in constant space. It has a third argument <code>tail</code> that indicates whether the call to <code>scheme_eval</code> is a tail call or not.</p><p>The <code>Unevaluated</code> class represents an expression that needs to be evaluated in an environment. When <code>optimized_eval</code> receives a non-atomic expression in a tail context, it returns an <code>Unevaluated</code> instance. Otherwise, it should repeatedly call <code>unoptimized_scheme_eval</code> on the current expr and env until the result is a value, rather than an <code>Unevaluated</code>.</p><p>Additionally, all tail calls to <code>scheme_eval</code> throughout your interpreter should be evaluated by calling <code>scheme_eval</code> with <code>True</code> as the third argument (now called <code>tail</code>). Your goal is to determine which calls to <code>scheme_eval</code> are tail calls and change <code>tail</code> as needed. <strong>A successful implementation will require changes to several other functions, including some functions that we provided for you.</strong></p><blockquote><p>A call to <code>scheme_eval</code> is a tail call if it is the last thing to be done in a function before it returns.</p><p>In lecture, you learned rules about how to find tail contexts <em>in Scheme</em>. Since we&#x27;re trying to tail-call optimize our Python function <code>scheme_eval</code>, these rules are not exactly applicable to Python.</p></blockquote><p>Once you finish, uncomment the following line in <code>scheme_eval_apply.py</code> to use your implementation:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scheme_eval = optimize_tail_calls(scheme_eval)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Use Ok to test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q optional1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="optional-problem-2-0-pt">Optional Problem 2 (0 pt)<a href="#optional-problem-2-0-pt" class="hash-link" aria-label="Direct link to Optional Problem 2 (0 pt)" title="Direct link to Optional Problem 2 (0 pt)">​</a></h3><p>In Scheme, source code is data. Every non-atomic expression is written as a Scheme list, so we can write procedures that manipulate other programs just as we write procedures that manipulate lists.</p><p>Rewriting programs can be useful: we can write an interpreter that only handles a small core of the language, and then write a procedure that converts other special forms into the core language before a program is passed to the interpreter.</p><p>For example, the <code>let</code> special form is equivalent to a call expression that begins with a <code>lambda</code> expression. Both create a new frame extending the current environment and evaluate a body within that new environment.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(let ((a 1) (b 2)) (+ a b))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;; Is equivalent to:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">((lambda (a b) (+ a b)) 1 2)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>These expressions can be represented by the following diagrams:</p><p>Use this rule to implement a procedure called <code>let-to-lambda</code> in <code>questions.scm</code> that rewrites all <code>let</code> special forms into <code>lambda</code> expressions. If we quote a <code>let</code> expression and pass it into this procedure, an equivalent <code>lambda</code> expression should be returned:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (let-to-lambda &#x27;(let ((a 1) (b 2)) (+ a b)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">((lambda (a b) (+ a b)) 1 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (let-to-lambda &#x27;(let ((a 1)) (let ((b a)) b)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">((lambda (a) ((lambda (b) b) a)) 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (let-to-lambda 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (let-to-lambda &#x27;a)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In order to handle all programs, <code>let-to-lambda</code> must be aware of Scheme syntax. Since Scheme expressions are recursively nested, <code>let-to-lambda</code> must also be recursive. In fact, the structure of <code>let-to-lambda</code> is somewhat similar to that of <code>scheme_eval</code>—but in Scheme! As a reminder, atoms include numbers, booleans, <code>nil</code>, and symbols. You do not need to consider code that contains quasiquotation for this problem.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(define (let-to-lambda expr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (cond ((atom?   expr) &lt;rewrite atoms&gt;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ((quoted? expr) &lt;rewrite quoted expressions&gt;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ((lambda? expr) &lt;rewrite lambda expressions&gt;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ((define? expr) &lt;rewrite define expressions&gt;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ((let?    expr) &lt;rewrite let expressions&gt;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (else           &lt;rewrite other expressions&gt;)))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Hint 1</em>: Consider how you can use <code>map</code> to convert <code>let</code> forms in every element of a list to the equivalent <code>lambda</code> form? Consider using <code>zip</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (zip &#x27;((1 2) (3 4) (5 6)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">((1 3 5) (2 4 6))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (zip &#x27;((1 2)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">((1) (2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scm&gt; (zip &#x27;())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(() ())</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Hint 2</em>: In this problem, it may be helpful to build a Scheme list that evaluates to a special form (for instance, a <code>lambda</code> expression). As a related example, the following code builds a scheme list that evaluates to the expression <code>(define (f x) (+ x 1))</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(let ((name-and-params &#x27;(f x))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (body &#x27;(+ x 1)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (cons &#x27;define</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (cons name-and-params (cons body nil))))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Use Ok to test your code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok -q optional2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>We used let while defining <code>let-to-lambda</code>. What if we want to run <code>let-to-lambda</code> on an interpreter that does not recognize <code>let</code>? We can pass <code>let-to-lambda</code> to itself to rewrite itself into an <em>equivalent program without</em> <code>let</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">;; The let-to-lambda procedure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define (let-to-lambda expr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ...)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;; A list representing the let-to-lambda procedure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define let-to-lambda-code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;(define (let-to-lambda expr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;; A let-to-lambda procedure that does not use &#x27;let&#x27;!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(define let-to-lambda-without-let</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (let-to-lambda let-to-lambda-code))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p><strong>Congratulations!</strong> You have just implemented an interpreter for an entire language! If you enjoyed this project and want to extend it further, you may be interested in looking at more advanced features, like <a href="http://schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-7.html#%25_sec_4.2.2" target="_blank" rel="noopener noreferrer">let<!-- -->*<!-- --> and letrec</a>, <a href="http://schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-7.html#%25_sec_4.2.6" target="_blank" rel="noopener noreferrer">unquote splicing</a>, <a href="https://en.wikipedia.org/wiki/Stack_trace" target="_blank" rel="noopener noreferrer">error tracing</a>, and <a href="https://en.wikipedia.org/wiki/Call-with-current-continuation" target="_blank" rel="noopener noreferrer">continuations</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="project-submission">Project submission<a href="#project-submission" class="hash-link" aria-label="Direct link to Project submission" title="Direct link to Project submission">​</a></h2><p>Run <code>ok</code> on all problems to make sure all tests are unlocked and pass:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can also check your score on each part of the project:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ok --score</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once you are satisfied, submit <code>scheme_eval_apply.py</code>, <code>scheme_forms.py</code>, <code>scheme_classes.py</code>, and <code>questions.scm</code> to the <strong>Scheme</strong> assignment on <strong>Gradescope</strong> before the second checkpoint deadline.</p><p>You can add a partner to your Gradescope submission by clicking on <strong>+<!-- --> Add Group Member</strong> under your name on the right hand side of your submission. Only one partner needs to submit to Gradescope.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/curriculum-resource/cs61a/project/ants"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Ants</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/curriculum-resource/cs61a/project/scheme_contest"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Scheme Gallery</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#download-starter-files" class="table-of-contents__link toc-highlight">Download starter files</a></li><li><a href="#logistics" class="table-of-contents__link toc-highlight">Logistics</a></li><li><a href="#interpreter-details" class="table-of-contents__link toc-highlight">Interpreter details</a><ul><li><a href="#scheme-features" class="table-of-contents__link toc-highlight">Scheme features</a></li><li><a href="#running-the-interpreter" class="table-of-contents__link toc-highlight">Running the interpreter</a></li></ul></li><li><a href="#getting-started-videos" class="table-of-contents__link toc-highlight">Getting Started Videos</a></li><li><a href="#part-1-the-evaluator" class="table-of-contents__link toc-highlight">Part 1: The Evaluator</a><ul><li><a href="#problem-1-1-pt" class="table-of-contents__link toc-highlight">Problem 1 (1 pt)</a></li><li><a href="#problem-2-2-pt" class="table-of-contents__link toc-highlight">Problem 2 (2 pt)</a></li><li><a href="#problem-3-2-pt" class="table-of-contents__link toc-highlight">Problem 3 (2 pt)</a></li><li><a href="#problem-4-2-pt" class="table-of-contents__link toc-highlight">Problem 4 (2 pt)</a></li><li><a href="#problem-5-1-pt" class="table-of-contents__link toc-highlight">Problem 5 (1 pt)</a></li></ul></li><li><a href="#part-2-procedures" class="table-of-contents__link toc-highlight">Part 2: Procedures</a><ul><li><a href="#user-defined-procedures" class="table-of-contents__link toc-highlight">User-Defined Procedures</a></li><li><a href="#problem-6-1-pt" class="table-of-contents__link toc-highlight">Problem 6 (1 pt)</a></li><li><a href="#problem-7-2-pt" class="table-of-contents__link toc-highlight">Problem 7 (2 pt)</a></li><li><a href="#problem-8-2-pt" class="table-of-contents__link toc-highlight">Problem 8 (2 pt)</a></li><li><a href="#problem-9-2-pt" class="table-of-contents__link toc-highlight">Problem 9 (2 pt)</a></li><li><a href="#problem-10-1-pt" class="table-of-contents__link toc-highlight">Problem 10 (1 pt)</a></li><li><a href="#problem-11-1-pt" class="table-of-contents__link toc-highlight">Problem 11 (1 pt)</a></li></ul></li><li><a href="#part-3-special-forms" class="table-of-contents__link toc-highlight">Part 3: Special Forms</a><ul><li><a href="#problem-12-2-pt" class="table-of-contents__link toc-highlight">Problem 12 (2 pt)</a></li><li><a href="#problem-13-2-pt" class="table-of-contents__link toc-highlight">Problem 13 (2 pt)</a></li><li><a href="#problem-14-2-pt" class="table-of-contents__link toc-highlight">Problem 14 (2 pt)</a></li><li><a href="#additional-scheme-tests-1-pt" class="table-of-contents__link toc-highlight">Additional Scheme Tests (1 pt)</a></li></ul></li><li><a href="#part-4-write-some-scheme" class="table-of-contents__link toc-highlight">Part 4: Write Some Scheme</a><ul><li><a href="#scheme-editor" class="table-of-contents__link toc-highlight">Scheme Editor</a></li><li><a href="#problem-15-2-pt" class="table-of-contents__link toc-highlight">Problem 15 (2 pt)</a></li><li><a href="#problem-16-2-pt" class="table-of-contents__link toc-highlight">Problem 16 (2 pt)</a></li></ul></li><li><a href="#optional-problems" class="table-of-contents__link toc-highlight">Optional Problems</a><ul><li><a href="#optional-problem-1-0-pt" class="table-of-contents__link toc-highlight">Optional Problem 1 (0 pt)</a></li><li><a href="#optional-problem-2-0-pt" class="table-of-contents__link toc-highlight">Optional Problem 2 (0 pt)</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li><li><a href="#project-submission" class="table-of-contents__link toc-highlight">Project submission</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">CS学习社区</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">路线图</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.50f11cc7.js"></script>
<script src="/assets/js/main.cf349332.js"></script>
</body>
</html>