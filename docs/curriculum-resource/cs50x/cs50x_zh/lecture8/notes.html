<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-curriculum-resource/cs50x/cs50x_zh/lecture8/notes" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">课程笔记 | CS自学社区</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.learncs.site/docs/curriculum-resource/cs50x/cs50x_zh/lecture8/notes"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="baidu-site-verification" content="codeva-hJyfN2UKgo"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="课程笔记 | CS自学社区"><meta data-rh="true" name="description" content="lecture7 SQL Notes | 课程笔记"><meta data-rh="true" property="og:description" content="lecture7 SQL Notes | 课程笔记"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.learncs.site/docs/curriculum-resource/cs50x/cs50x_zh/lecture8/notes"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/cs50x/cs50x_zh/lecture8/notes" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/cs50x/cs50x_zh/lecture8/notes" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CS自学社区 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CS自学社区 Atom Feed">




<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.c4382977.css">
<link rel="preload" href="/assets/js/runtime~main.30603f7d.js" as="script">
<link rel="preload" href="/assets/js/main.9cfb4d5b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">🎉️🎉️🎉️课程文档汉化工作正在进行中 🎉️🎉️ 学习交流群请到 <a href="/community">社区页面</a> 查看入群方式 🎉️🎉️🎉️</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">TeachYourselfCS</b></a><a class="navbar__item navbar__link" href="/docs/roadmap">路线图</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">课程资源</a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/community">社区</a><a class="navbar__item navbar__link" href="/donate">捐赠我们</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">前言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/roadmap">路线图</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/课程资源">课程资源</a><button aria-label="Toggle the collapsible sidebar category &#x27;课程资源&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs50x">cs50x</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_en">cs50x</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh">cs50x 中文版</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x 中文版&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture1">Lecture0 Scratch</a><button aria-label="Toggle the collapsible sidebar category &#x27;Lecture0 Scratch&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture2">lecture1 C</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture1 C&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture3">lecture2 Arrays</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture2 Arrays&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture4">lecture3 Algorithms</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture3 Algorithms&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture5">lecture4 Memory</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture4 Memory&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture6">lecture5 Data Structures</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture5 Data Structures&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture7">lecture6 python</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture6 python&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture8">lecture7 SQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture7 SQL&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture8/notes">课程笔记</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture8/problem set">Problem Set</a><button aria-label="Toggle the collapsible sidebar category &#x27;Problem Set&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture8/practice problems">Practice Problem</a><button aria-label="Toggle the collapsible sidebar category &#x27;Practice Problem&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture8/lab">Lab</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture9">lecture8 HTML,CSS,JavaScript</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture8 HTML,CSS,JavaScript&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture10">lecture9 Flask</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture9 Flask&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture12">lecture11 Cybersecurity</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture11 Cybersecurity&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture11">lecture10 Emoji</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture10 Emoji&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61a">cs61a</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61a&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61b">cs61b</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61b&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61c">cs61c</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61c&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-01">MIT 18.01</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.01&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-02">MIT 18.02</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.02&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-06">MIT 18.06</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.06&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/6-04j">MIT 6.042J</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 6.042J&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs162">cs162</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs162&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs144">cs144</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs144&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/15-445">CMU 15-445</a><button aria-label="Toggle the collapsible sidebar category &#x27;CMU 15-445&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/课程资源"><span itemprop="name">课程资源</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/cs50x"><span itemprop="name">cs50x</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/cs50x/cs50x_zh"><span itemprop="name">cs50x 中文版</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture8"><span itemprop="name">lecture7 SQL</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">课程笔记</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>第七讲 - CS50x 2023</h1><ul><li><a href="#%E7%AC%AC%E4%B8%83%E8%AE%B2---cs50x-2023">第七讲 - CS50x 2023</a><ul><li><a href="#%E6%AC%A2%E8%BF%8E">欢迎!</a></li><li><a href="#%E5%B9%B3%E9%9D%A2%E6%96%87%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93">平面文件数据库</a></li><li><a href="#%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93">关系数据库</a></li><li><a href="#imdb">IMDb</a></li><li><a href="#join%E8%BF%9E%E6%8E%A5"><code>JOIN</code>（连接）</a></li><li><a href="#%E7%B4%A2%E5%BC%95">索引</a></li><li><a href="#%E5%9C%A8-python-%E4%B8%AD%E4%BD%BF%E7%94%A8-sql">在 Python 中使用 SQL</a></li><li><a href="#%E7%AB%9E%E6%80%81%E6%9D%A1%E4%BB%B6">竞态条件</a></li><li><a href="#sql-%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB">SQL 注入攻击</a></li><li><a href="#%E6%80%BB%E7%BB%93">总结</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="欢迎">欢迎!<a href="#欢迎" class="hash-link" aria-label="Direct link to 欢迎!" title="Direct link to 欢迎!">​</a></h2><ul><li>在前几周，我们向您介绍了 Python，一种高级编程语言，它使用了我们在 C 语言中学到的相同构建块。</li><li>本周，我们将继续学习更多与 Python 相关的语法。</li><li>此外，我们将把这些知识与数据集成起来。</li><li>最后，我们将讨论 <em>SQL</em> 或 <em>结构化查询语言</em>。</li><li>总的来说，本课程的目标之一是学习通用的编程思想，而不仅仅是如何使用本课程中涉及的语言进行编程。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="平面文件数据库">平面文件数据库<a href="#平面文件数据库" class="hash-link" aria-label="Direct link to 平面文件数据库" title="Direct link to 平面文件数据库">​</a></h2><ul><li><p>正如您可能已经了解的那样，数据通常可以用列和表的结构来表示。</p></li><li><p>像 Microsoft Excel 和 Google Sheets 这样的电子表格软件可以将数据导出为 <code>csv</code>，即<em>逗号分隔值</em>文件。</p></li><li><p>查看 <code>csv</code> 文件时，你会发现它是一种平面文件，所有数据都存储在一个由文本文件构成的单表中。我们将这种形式的数据称为 <em>平面文件数据库</em>。</p></li><li><p>Python 原生支持 <code>csv</code> 文件。</p></li><li><p>在终端窗口中输入 <code>code favorites.py</code>，然后编写以下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用 csv.reader 打印 CSV 中的所有收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 创建 reader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.reader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 跳过标题行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    next(reader)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 迭代 CSV 文件，打印每个收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(row[1])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，已经导入了 <code>csv</code> 库。我们创建了一个 <code>reader</code> 对象来存储 <code>csv.reader(file)</code> 的返回值。<code>csv.reader</code> 函数会逐行读取文件内容，并将结果保存在 <code>reader</code> 对象中。因此，<code>print(row[1])</code> 会输出 <code>favorites.csv</code> 文件中每行的第二列数据，即编程语言。</p></li><li><p>您可以如下优化代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 将收藏夹存储在变量中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 创建 reader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.reader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 跳过标题行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    next(reader)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 迭代 CSV 文件，打印每个收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        favorite = row[1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(favorite)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，<code>favorite</code> 变量被赋值后随即输出。<code>next</code> 函数用于跳过 <code>reader</code> 对象的下一行，通常用于跳过表头。</p></li><li><p>Python 允许通过键来访问列表中的元素。请修改代码如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用 csv.DictReader 打印 CSV 中的所有收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 创建 DictReader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.DictReader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 迭代 CSV 文件，打印每个收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(row[&quot;language&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，此示例直接使用键 <code>language</code> 来访问并输出对应的值。</p></li><li><p>要统计 <code>csv</code> 文件中各种编程语言的偏好数量，可以采用以下方法：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用变量计算收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 创建 DictReader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.DictReader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scratch, c, python = 0, 0, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 迭代 CSV 文件，计算收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        favorite = row[&quot;language&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if favorite == &quot;Scratch&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            scratch += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        elif favorite == &quot;C&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        elif favorite == &quot;Python&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            python += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(f&quot;Scratch: {scratch}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(f&quot;C: {c}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(f&quot;Python: {python}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，这里使用了<code>if</code>语句来统计每种语言的偏好数量。</p></li><li><p>Python 允许我们使用字典来统计每种语言的计数（<code>counts</code>）。考虑对以下代码的改进：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用字典计算收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 创建 DictReader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.DictReader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counts = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 迭代 CSV 文件，计算收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        favorite = row[&quot;language&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;{favorite}: {counts[favorite]}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，如果字典<code>counts</code>中已存在键<code>favorite</code>，则其对应的值会递增；否则，我们会将<code>counts[favorite]</code>的值设为1。此外，格式化字符串也进行了优化，可以直接显示<code>counts[favorite]</code>的值。</p></li><li><p>Python 还允许对 <code>counts</code> 进行排序。按以下方式改进代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 按键对收藏夹进行排序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 创建 DictReader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.DictReader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counts = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 迭代 CSV 文件，计算收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        favorite = row[&quot;language&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for favorite in sorted(counts):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;{favorite}: {counts[favorite]}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意代码底部的 <code>sorted(counts)</code> 函数。</p></li><li><p>如果您查看 Python 文档中 <code>sorted</code> 函数的参数，您会发现它有许多内置参数。您可以按以下方式使用这些内置参数：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 按值对收藏夹进行排序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 创建 DictReader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.DictReader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counts = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 迭代 CSV 文件，计算收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        favorite = row[&quot;language&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def get_value(language):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return counts[language]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for favorite in sorted(counts, key=get_value, reverse=True):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;{favorite}: {counts[favorite]}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，这里创建了一个名为<code>get_value</code>的函数，并将其作为参数传递给<code>sorted</code>函数。<code>key</code>参数用于指定排序的依据。</p></li><li><p>Python 有一个我们之前没有提到过的特性：它允许使用匿名函数，也就是<code>lambda</code>函数。当您不想单独定义一个函数时，可以使用匿名函数。注意以下修改：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用 lambda 函数按值对收藏夹进行排序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 创建 DictReader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.DictReader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counts = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 迭代 CSV 文件，计算收藏夹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        favorite = row[&quot;language&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for favorite in sorted(counts, key=lambda language: counts[language], reverse=True):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;{favorite}: {counts[favorite]}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>相反，<code>lambda language: counts[language]</code> 这行代码实现了之前两行函数的功能。</p></li><li><p>我们可以修改代码，将关注点从最喜欢的语言转移到最喜欢的问题：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 最喜欢的问题而不是最喜欢的语言</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 创建 DictReader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.DictReader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counts = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 遍历 CSV 文件，统计最喜爱的问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        favorite = row[&quot;problem&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for favorite in sorted(counts, key=lambda problem: counts[problem], reverse=True):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;{favorite}: {counts[favorite]}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，这里将 <code>language</code> 替换成了 <code>problem</code>。</p></li><li><p>如果想允许用户直接在终端输入，我们可以利用之前学过的用户输入知识来修改代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 最喜欢的问题而不是最喜欢的语言</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 创建 DictReader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reader = csv.DictReader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    counts = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 遍历 CSV 文件，统计最喜爱的问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        favorite = row[&quot;problem&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            counts[favorite] = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">favorite = input(&quot;Favorite: &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;{favorite}: {counts[favorite]}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，和 C 语言相比，Python 代码显得非常简洁。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="关系数据库">关系数据库<a href="#关系数据库" class="hash-link" aria-label="Direct link to 关系数据库" title="Direct link to 关系数据库">​</a></h2><ul><li><p>Google、Twitter 和 Meta 都使用关系数据库来大规模存储他们的信息。</p></li><li><p>关系数据库以行和列的形式将数据存储在称为“表”的结构中。</p></li><li><p>SQL 支持四种类型的命令：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  Create</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Delete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>这四个操作通常被称为 CRUD。</p></li><li><p>我们可以在终端通过输入 <code>sqlite3 favorites.db</code> 来创建一个 SQL 数据库。 在提示符出现后，按 <code>y</code> 确认创建 <code>favorites.db</code>。</p></li><li><p>你会看到不同的提示符，表示你现在已经进入了 <code>sqlite3</code> 程序。</p></li><li><p>输入 <code>.mode csv</code> 可以将 <code>sqlite3</code> 设置为 <code>csv</code> 模式。</p></li><li><p>然后，输入 <code>.import favorites.csv favorites</code> 从 <code>csv</code> 文件导入数据。 此时可能看起来没有任何变化！</p></li><li><p>我们可以输入 <code>.schema</code> 来查看数据库的结构。</p></li><li><p>可以使用 <code>SELECT columns FROM table</code> 语法从表中读取数据。</p></li><li><p>例如，输入 <code>SELECT * FROM favorites;</code> 会返回 <code>favorites</code> 表中的所有行。</p></li><li><p>使用 <code>SELECT language FROM favorites;</code> 命令可以获取 <code>language</code> 列的数据。</p></li><li><p>SQL 支持许多访问数据的命令，包括：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  AVG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  COUNT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DISTINCT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LOWER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MAX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UPPER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>例如，您可以输入 <code>SELECT COUNT(language) FROM favorites;</code>。 此外，输入 <code>SELECT DISTINCT(language) FROM favorites;</code> 可以获取数据库中所有不同的语言列表。 甚至可以输入 <code>SELECT COUNT(DISTINCT(language)) FROM favorites;</code> 来统计不同语言的种类数量。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 查询数据库中问题的受欢迎程度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from cs50 import SQL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开数据库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db = SQL(&quot;sqlite:///favorites.db&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 提示用户输入他们最喜欢的问题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">favorite = input(&quot;Favorite: &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 搜索标题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rows = db.execute(&quot;SELECT COUNT(*) FROM favorites WHERE problem LIKE ?&quot;, &quot;%&quot; + favorite + &quot;%&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 获取结果的第一行（也是唯一的一行）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row = rows[0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印查询结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(row[&quot;COUNT(*)&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>SQL 提供了我们可以在查询中使用的其他命令：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  WHERE       -- 添加布尔表达式来过滤数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LIKE        -- 更灵活地过滤结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ORDER BY    -- 对结果进行排序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LIMIT       -- 限制结果的数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  GROUP BY    -- 将结果分组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，<code>--</code> 在 SQL 中用于添加注释。</p></li><li><p>例如，我们可以执行 <code>SELECT COUNT(*) FROM favorites WHERE language = &#x27;C&#x27;;</code>。 会返回一个计数结果。</p></li><li><p>接下来，我们可以输入 <code>SELECT COUNT(*) FROM favorites WHERE language = &#x27;C&#x27; AND problem = &#x27;Mario&#x27;;</code>。 请注意如何使用 <code>AND</code> 来缩小我们的结果范围。</p></li><li><p>类似地，我们可以执行 <code>SELECT language, COUNT(*) FROM favorites GROUP BY language;</code>。 这会生成一个临时表，显示每种语言的计数。</p></li><li><p>我们可以输入 <code>SELECT language, COUNT(*) FROM favorites GROUP BY language ORDER BY COUNT(*);</code> 来优化排序。</p></li><li><p>我们还可以使用 <code>INSERT</code> 将数据插入 SQL 数据库，格式如下：<code>INSERT INTO table (column...) VALUES(value, ...);</code>。</p></li><li><p>我们可以执行 <code>INSERT INTO favorites (language, problem) VALUES (&#x27;SQL&#x27;, &#x27;Fiftyville&#x27;);</code>。</p></li><li><p>我们还可以使用 <code>UPDATE</code> 命令来更新您的数据。</p></li><li><p>例如，您可以执行 <code>UPDATE favorites SET language = &#x27;C++&#x27; WHERE language = &#x27;C&#x27;;</code>。 这会将所有之前 &#x27;C&#x27; 作为首选语言的记录更新为 &#x27;C++&#x27;。</p></li><li><p>请注意这些查询功能强大。 因此，在实际环境中，您应该考虑谁有权执行某些命令。</p></li><li><p><code>DELETE</code> 允许您删除数据的某些部分。 例如，您可以 <code>DELETE FROM favorites WHERE problem = &#x27;Tideman&#x27;;</code>。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="imdb">IMDb<a href="#imdb" class="hash-link" aria-label="Direct link to IMDb" title="Direct link to IMDb">​</a></h2><ul><li><p>IMDb 提供了一个人员、节目、编剧、明星、类型和评分的数据库。 图示展示了各个SQL表之间的关系，包括人员、节目、编剧、明星、类型和评分等。</p><p><img loading="lazy" alt="六个框代表各种 SQL 表，箭头绘制到每个框，显示它们彼此之间的许多关系" src="/assets/images/cs50Week7Slide025-bb45d9f803af6cf4dab84dd80e079cba.png" title="imdb 关系" width="960" height="540" class="img_ev3q"></p></li><li><p>下载 <a href="https://github.com/cs50/lectures/blob/2022/fall/7/src7/imdb/shows.db" target="_blank" rel="noopener noreferrer"><code>shows.db</code></a> 后，您可以在终端窗口中执行 <code>sqlite3 shows.db</code>。</p></li><li><p>执行 <code>.schema</code> 后，您不仅会找到每个表，还会找到每个表中的各个字段。</p></li><li><p>如上图所示，<code>shows</code> 有一个 <code>id</code> 字段。 <code>genres</code> 表有一个 <code>show_id</code> 字段，该字段具有 <code>shows</code> 表之间共有的数据。</p></li><li><p>从图中可以看出，<code>show_id</code> 存在于所有表中。 在 <code>shows</code> 表中，它简称为 <code>id</code>。 所有字段之间的这个公共字段称为“键”。 主键用于标识表中的唯一记录。 外键用于通过指向另一个表中的主键来构建表之间的关系。</p></li><li><p>通过如上所述将数据存储在关系数据库中，可以更有效地存储数据。</p></li><li><p>在 <em>sqlite</em> 中，我们有五种数据类型，包括：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  BLOB       -- 二进制大对象，由一系列1和0组成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INTEGER    -- 整数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NUMERIC    -- 用于特殊格式的数字，如日期</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  REAL       -- 像浮点数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TEXT       -- 用于字符串等</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>此外，可以设置列以添加特殊约束：</p></li><li><p>为了进一步说明这些表之间的关系，我们可以执行以下命令：<code>SELECT * FROM people LIMIT 10;</code>。 查看结果，我们可以执行 <code>SELECT * FROM shows LIMIT 10;</code>。 此外，我们可以执行 <code>SELECT * FROM stars LIMIT 10;</code>。 <code>show_id</code> 是此最终查询中的外键，因为 <code>show_id</code> 对应于 <code>shows</code> 中的唯一 <code>id</code> 字段。 <code>person_id</code> 对应于 <code>people</code> 列中的唯一 <code>id</code> 字段。</p></li><li><p>我们可以进一步使用这些数据来了解这些关系。 执行 <code>SELECT * FROM genres;</code>。 有很多类型！</p></li><li><p>我们可以通过执行 <code>SELECT * FROM genres WHERE genre = &#x27;Comedy&#x27; LIMIT 10;</code> 来进一步限制这些数据。 从这个查询中，您可以看到有 10 个节目呈现出来。</p></li><li><p>您可以通过执行 <code>SELECT * FROM shows WHERE id = 626124;</code> 来发现这些节目是什么。</p></li><li><p>为了提高查询效率，我们可以执行以下操作</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT title</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM shows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE id IN (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SELECT show_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FROM genres</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHERE genre = &#x27;Comedy&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LIMIT 10;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，此查询将两个查询嵌套在一起。 内部查询由外部查询使用。</p></li><li><p>我们可以通过执行以下操作来进一步优化</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT title</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM shows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE id IN (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SELECT show_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FROM genres</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHERE genre = &#x27;Comedy&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ORDER BY title LIMIT 10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>如果想查找由史蒂夫·卡瑞尔主演的所有节目，该怎么办呢？可以执行<code>SELECT * FROM people WHERE name = &#x27;Steve Carell&#x27;;</code>，找到他的个人<code>id</code>。然后，利用这个<code>id</code>来查找他出演的许多<code>shows</code>。但是，逐一查找会很繁琐。如何通过嵌套查询来简化这个过程呢？请看下面的例子：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT title FROM shows WHERE id IN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (SELECT show_id FROM stars WHERE person_id =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (SELECT * FROM people WHERE name = &#x27;Steve Carell&#x27;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，这个较长的查询最终会产生一个结果，可以帮助我们找到问题的答案。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="join连接"><code>JOIN</code>（连接）<a href="#join连接" class="hash-link" aria-label="Direct link to join连接" title="Direct link to join连接">​</a></h2><ul><li><p>考虑以下两个表：</p><p><img loading="lazy" alt="两个框代表shows和genres表，箭头连接id和show id" src="/assets/images/cs50Week7Slide030-3f664e686d78bb4ac5669cd5b5e515c0.png" title="主键和外键" width="960" height="540" class="img_ev3q"></p></li><li><p>如何临时组合这些表呢？可以使用<code>JOIN</code>命令。</p></li><li><p>执行以下命令：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT * FROM shows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  JOIN ratings on shows.id = ratings.show_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WHERE title = &#x27;The Office&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>现在，可以看到所有名为《办公室》的剧集。</p></li><li><p>类似地，可以将<code>JOIN</code>应用到前面提到的史蒂夫·卡瑞尔查询，方法如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT title FROM people</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  JOIN stars ON people.id = stars.person_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  JOIN shows ON stars.show_id = shows.id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WHERE name = `Steve Carell`;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，每个<code>JOIN</code>命令都指明了哪些列与哪些列相关联。</p></li><li><p>这也可以类似地实现如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT title FROM people, stars, shows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE people.id = stars.person_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AND stars.show_id = shows.id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AND name = &#x27;Steve Carell&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，这实现了相同的结果。</p></li><li><p>可以使用通配符<code>%</code>运算符查找所有名字以<code>Steve C</code>开头的人。例如，可以使用以下语法：<code>SELECT * FROM people WHERE name LIKE &#x27;Steve C%&#x27;;</code></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="索引">索引<a href="#索引" class="hash-link" aria-label="Direct link to 索引" title="Direct link to 索引">​</a></h2><ul><li><p>虽然关系型数据库比使用<code>CSV</code>文件更快、更强大，但仍然可以使用<em>索引</em>来优化表中的数据。</p></li><li><p>索引可用于加速我们的查询。</p></li><li><p>我们可以通过在<code>sqlite3</code>中执行<code>.timer on</code>来跟踪查询的速度。</p></li><li><p>为了理解索引如何加速查询，请运行以下命令：<code>SELECT * FROM shows WHERE title = &#x27;The Office&#x27;;</code> 并注意查询执行后所显示的时间。</p></li><li><p>然后，我们可以使用语法<code>CREATE INDEX title_index on shows (title);</code>创建一个索引。这告诉<code>sqlite3</code>创建一个索引，并执行一些与此列<code>title</code>相关的特殊的底层优化。</p></li><li><p>这将创建一个名为<em>B树</em>的数据结构，它类似于二叉树。但与二叉树不同的是，它可以拥有超过两个子节点。</p><p><img loading="lazy" alt="顶部的一个节点，从中发出四个子节点，在它下面，有一个节点发出三个子节点，另一个节点发出两个子节点，另一个节点发出两个子节点，另一个节点发出三个子节点" src="/assets/images/cs50Week7Slide039-d1d6b95538a8ebdcd608e0ee3f9dd15e.png" title="b 树" width="960" height="540" class="img_ev3q"></p></li><li><p>运行查询<code>SELECT * FROM shows WHERE title = &#x27;The Office&#x27;;</code>，你会注意到查询运行得更快了！</p></li><li><p>不幸的是，索引所有列会导致占用更多的存储空间。因此，为了提高速度，需要做出权衡。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="在-python-中使用-sql">在 Python 中使用 SQL<a href="#在-python-中使用-sql" class="hash-link" aria-label="Direct link to 在 Python 中使用 SQL" title="Direct link to 在 Python 中使用 SQL">​</a></h2><ul><li><p>为了方便在本课程中使用 SQL，可以在代码中使用 CS50 库，如下所示：</p></li><li><p>与之前使用 CS50 库类似，该库可以帮助简化在 Python 代码中使用 SQL 的复杂步骤。</p></li><li><p>你可以在<a href="https://cs50.readthedocs.io/libraries/cs50/python/#cs50.SQL" target="_blank" rel="noopener noreferrer">文档</a>中阅读更多关于 CS50 库的 SQL 功能。</p></li><li><p>回顾一下之前在<code>favorites.py</code>中编写的代码，它应该是这样的：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 收藏问题而不是收藏语言</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开 CSV 文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">with open(&quot;favorites.csv&quot;, &quot;r&quot;) as file:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 创建字典读取器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reader = csv.DictReader(file)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 计数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">counts = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 遍历CSV文件，统计最爱项目</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for row in reader:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    favorite = row[&quot;problem&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        counts[favorite] += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        counts[favorite] = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印统计结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">favorite = input(&quot;Favorite: &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if favorite in counts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(f&quot;{favorite}: {counts[favorite]}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>请按照以下方式修改您的代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 搜索数据库中问题的热度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from cs50 import SQL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打开数据库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db = SQL(&quot;sqlite:///favorites.db&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 提示用户输入最爱项目</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">favorite = input(&quot;Favorite: &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 搜索标题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rows = db.execute(&quot;SELECT COUNT(*) FROM favorites WHERE problem LIKE ?&quot;, &quot;%&quot; + favorite + &quot;%&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 获取第一行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">row = rows[0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印热度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(row[&quot;COUNT(*)&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，<code>db = SQL(&quot;sqlite:///favorites.db&quot;)</code> 这行代码向 Python 提供数据库文件的位置。然后，以 <code>rows</code> 开头的这行代码使用 <code>db.execute</code> 执行 SQL 命令。实际上，这个命令会将引号内的 SQL 语法传递给 <code>db.execute</code> 函数。此外，请注意，<code>rows</code> 会以字典列表的形式返回。在这种情况下，只会返回一个结果，即一行数据，并以字典的形式存储在 <code>rows</code> 列表中。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="竞态条件">竞态条件<a href="#竞态条件" class="hash-link" aria-label="Direct link to 竞态条件" title="Direct link to 竞态条件">​</a></h2><ul><li>使用 SQL 有时会导致一些问题。</li><li>您可以想象这样一种情况：多个用户可以同时访问同一个数据库并执行命令。</li><li>这可能会导致代码被其他人的操作中断而出现故障。这可能会导致数据丢失。</li><li>内置的 SQL 功能（如 <code>BEGIN TRANSACTION</code>、<code>COMMIT</code> 和 <code>ROLLBACK</code>）有助于避免其中一些竞态条件问题。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sql-注入攻击">SQL 注入攻击<a href="#sql-注入攻击" class="hash-link" aria-label="Direct link to SQL 注入攻击" title="Direct link to SQL 注入攻击">​</a></h2><ul><li><p>现在，仍然考虑上面的代码，您可能想知道上面的 <code>?</code> 问号是做什么用的。在 SQL 的实际应用中，可能会出现一种问题，叫做<em>注入攻击</em>。注入攻击是指恶意行为者可以输入恶意 SQL 代码。</p></li><li><p>例如，考虑以下登录屏幕：</p><p><img loading="lazy" alt="包含用户名和密码输入框的哈佛 Key 登录界面" src="/assets/images/cs50Week7Slide051-e00c15988c54defdd13ebea756886e6a.png" title="哈佛密钥登录屏幕" width="960" height="540" class="img_ev3q"></p></li><li><p>如果没有在我们自己的代码中采取适当的保护措施，不良行为者可能会运行恶意代码。考虑以下事项：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rows = db.execute(&quot;SELECT COUNT(*) FROM favorites WHERE problem LIKE ?&quot;, &quot;%&quot; + favorite + &quot;%&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，由于 <code>?</code> 存在，因此可以在查询盲目接受 <code>favorite</code> 之前对其运行验证。</p></li><li><p>切记不要像上面那样在查询语句中使用格式化字符串，也不要盲目信任用户的输入。</p></li><li><p>使用 CS50 库，它会对输入进行<em>清理</em>，移除潜在的恶意字符。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="Direct link to 总结" title="Direct link to 总结">​</a></h2><p>在本节课中，您学习了更多与 Python 相关的语法。此外，您还学习了如何将这些知识与平面文件和关系数据库形式的数据集成。最后，您学习了 <em>SQL</em>。具体来说，我们讨论了：...</p><ul><li>平面文件数据库</li><li>关系数据库</li><li>SQL</li><li><code>JOIN</code></li><li>索引</li><li>在 Python 中使用 SQL</li><li>竞态条件</li><li>SQL 注入攻击</li></ul><p>下节课见！</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture8"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">lecture7 SQL</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture8/problem set"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">问题集</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#欢迎" class="table-of-contents__link toc-highlight">欢迎!</a></li><li><a href="#平面文件数据库" class="table-of-contents__link toc-highlight">平面文件数据库</a></li><li><a href="#关系数据库" class="table-of-contents__link toc-highlight">关系数据库</a></li><li><a href="#imdb" class="table-of-contents__link toc-highlight">IMDb</a></li><li><a href="#join连接" class="table-of-contents__link toc-highlight"><code>JOIN</code>（连接）</a></li><li><a href="#索引" class="table-of-contents__link toc-highlight">索引</a></li><li><a href="#在-python-中使用-sql" class="table-of-contents__link toc-highlight">在 Python 中使用 SQL</a></li><li><a href="#竞态条件" class="table-of-contents__link toc-highlight">竞态条件</a></li><li><a href="#sql-注入攻击" class="table-of-contents__link toc-highlight">SQL 注入攻击</a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">CS学习社区</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">路线图</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">捐赠</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/donate">捐赠我们</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyleft © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.30603f7d.js"></script>
<script src="/assets/js/main.9cfb4d5b.js"></script>
</body>
</html>