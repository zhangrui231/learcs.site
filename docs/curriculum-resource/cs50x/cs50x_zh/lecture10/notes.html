<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-curriculum-resource/cs50x/cs50x_zh/lecture10/notes" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">笔记 | CS自学社区</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.learncs.site/docs/curriculum-resource/cs50x/cs50x_zh/lecture10/notes"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="baidu-site-verification" content="codeva-hJyfN2UKgo"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="笔记 | CS自学社区"><meta data-rh="true" name="description" content="lecture9 Flask Notes | 第九讲 Flask 笔记"><meta data-rh="true" property="og:description" content="lecture9 Flask Notes | 第九讲 Flask 笔记"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.learncs.site/docs/curriculum-resource/cs50x/cs50x_zh/lecture10/notes"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/cs50x/cs50x_zh/lecture10/notes" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/cs50x/cs50x_zh/lecture10/notes" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CS自学社区 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CS自学社区 Atom Feed">




<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.c4382977.css">
<link rel="preload" href="/assets/js/runtime~main.a7b75e5e.js" as="script">
<link rel="preload" href="/assets/js/main.0bc30274.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">🎉️🎉️🎉️课程文档汉化工作正在进行中 🎉️🎉️ 学习交流群请到 <a href="/community">社区页面</a> 查看入群方式 🎉️🎉️🎉️</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">TeachYourselfCS</b></a><a class="navbar__item navbar__link" href="/docs/roadmap">路线图</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">课程资源</a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/community">社区</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">前言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/roadmap">路线图</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/课程资源">课程资源</a><button aria-label="Toggle the collapsible sidebar category &#x27;课程资源&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs50x">cs50x</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_en">cs50x</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh">cs50x 中文版</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x 中文版&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture1">Lecture0 Scratch</a><button aria-label="Toggle the collapsible sidebar category &#x27;Lecture0 Scratch&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture2">lecture1 C</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture1 C&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture3">lecture2 Arrays</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture2 Arrays&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture4">lecture3 Algorithms</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture3 Algorithms&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture5">lecture4 Memory</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture4 Memory&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture6">lecture5 Data Structures</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture5 Data Structures&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture7">lecture6 python</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture6 python&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture8">lecture7 SQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture7 SQL&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture9">lecture8 HTML,CSS,JavaScript</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture8 HTML,CSS,JavaScript&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture10">lecture9 Flask</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture9 Flask&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture10/notes">笔记</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture10/problem set">Problem Set</a><button aria-label="Toggle the collapsible sidebar category &#x27;Problem Set&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture10/practice problems">Practice Problem</a><button aria-label="Toggle the collapsible sidebar category &#x27;Practice Problem&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture10/lab">Lab</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture12">lecture11 Cybersecurity</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture11 Cybersecurity&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture11">lecture10 Emoji</a><button aria-label="Toggle the collapsible sidebar category &#x27;lecture10 Emoji&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61a">cs61a</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61a&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61b">cs61b</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61b&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61c">cs61c</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61c&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-01">MIT 18.01</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.01&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-02">MIT 18.02</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.02&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-06">MIT 18.06</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.06&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/6-04j">MIT 6.042J</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 6.042J&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs162">cs162</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs162&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs144">cs144</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs144&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/15-445">CMU 15-445</a><button aria-label="Toggle the collapsible sidebar category &#x27;CMU 15-445&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/课程资源"><span itemprop="name">课程资源</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/cs50x"><span itemprop="name">cs50x</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/cs50x/cs50x_zh"><span itemprop="name">cs50x 中文版</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture10"><span itemprop="name">lecture9 Flask</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">笔记</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>第九讲 - CS50x 2023</h1><ul><li><a href="#%E7%AC%AC%E4%B9%9D%E8%AE%B2---cs50x-2023">第九讲 - CS50x 2023</a><ul><li><a href="#%E6%AC%A2%E8%BF%8E">欢迎！</a></li><li><a href="#%E4%BB%8E%E9%9D%99%E6%80%81%E5%88%B0%E5%8A%A8%E6%80%81">从静态到动态</a></li><li><a href="#flask">Flask</a></li><li><a href="#%E5%B8%83%E5%B1%80">布局</a></li><li><a href="#post">POST</a></li><li><a href="#frosh-ims">Frosh IMs</a></li><li><a href="#flask-%E5%92%8C-sql">Flask 和 SQL</a></li><li><a href="#%E4%BC%9A%E8%AF%9D">会话</a></li><li><a href="#%E5%95%86%E5%BA%97">商店</a></li><li><a href="#api">API</a></li><li><a href="#json">JSON</a></li><li><a href="#%E6%80%BB%E7%BB%93%E4%B8%80%E4%B8%8B">总结一下</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="欢迎">欢迎！<a href="#欢迎" class="hash-link" aria-label="Direct link to 欢迎！" title="Direct link to 欢迎！">​</a></h2><ul><li>在过去的几周里，您学习了许多编程语言、技术和策略。</li><li>实际上，这门课与其说是 C 语言课或 Python 语言课，不如说是一门编程课。 这样，大家可以更好地掌握未来的技术趋势。</li><li>在过去的几周里，你已经学会了<em>如何学习</em>编程的方法。</li><li>今天，我们将从 HTML 和 CSS 转到结合 HTML、CSS、SQL、Python 和 JavaScript，以便您可以创建自己的 Web 应用程序。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="从静态到动态">从静态到动态<a href="#从静态到动态" class="hash-link" aria-label="Direct link to 从静态到动态" title="Direct link to 从静态到动态">​</a></h2><ul><li>到目前为止，您看到的所有 HTML 都是预先编写的并且是静态的。</li><li>过去，当您访问一个页面时，浏览器会下载一个 HTML 页面，然后您就可以查看它。</li><li>动态页面指的是 Python 等语言能够实时生成 HTML 文件的能力，从而可以根据用户选择的选项来生成不同的网页。</li><li>之前大家用过<code>http-server</code>来托管网页。 今天，我们会使用一个新的服务器，它可以解析网址，并根据URL来执行相应的操作。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flask">Flask<a href="#flask" class="hash-link" aria-label="Direct link to Flask" title="Direct link to Flask">​</a></h2><ul><li><p><em>Flask</em> 是一个第三方库，允许您使用 Python 中的 Flask 框架托管 Web 应用程序。</p></li><li><p>您可以通过执行 <code>flask run</code> 来运行 Flask。</p></li><li><p>为此，您需要一个名为 <code>app.py</code> 的文件和一个名为 <code>templates</code> 的文件夹。</p></li><li><p>要开始使用，请创建一个名为 <code>templates</code> 的文件夹，并创建一个名为 <code>index.html</code> 的文件，其中包含以下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, width=device-width&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;title&gt;hello&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hello, {{ name }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意双花括号<code>{{ name }}</code>，这是一个占位符，稍后会被Flask服务器替换成具体的内容。</p></li><li><p>然后，在与 <code>templates</code> 文件夹相同的文件夹中，创建一个名为 <code>app.py</code> 的文件，并添加以下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 问候用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, render_template, request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;index.html&quot;, name=request.args.get(&quot;name&quot;, &quot;world&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，此代码将 <code>app</code> 定义为 Flask 应用程序。然后，它将 <code>app</code> 的 <code>/</code> 路由定义为返回 <code>index.html</code> 的内容，并带有 <code>name</code> 参数。默认情况下，<code>request.args.get</code> 函数会查找用户通过URL传递的<code>name</code>参数。 如果没有提供，则默认使用<code>world</code>。</p></li><li><p>最后，在与 <code>app.py</code> 相同的文件夹中添加一个名为 <code>requirements.txt</code> 的最终文件，该文件只有一行代码：</p><p>请注意，此文件中只出现 <code>Flask</code>。</p></li><li><p>您可以通过在终端窗口中键入 <code>flask run</code> 来运行此文件。如果 Flask 没有运行，请确保您在上面的每个文件中语法正确。此外，如果 Flask 无法运行，请确保您的文件按以下方式组织：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/templates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>一旦你让它运行起来，你会被提示点击一个链接。导航到该网页后，尝试在浏览器的 URL 栏中的基本 URL 中添加 <code>?name=[你的名字]</code>。</p></li><li><p>为了改善用户体验，我们知道大多数用户不会直接在地址栏里输入参数。 开发者通常会使用网页表单让用户填写信息。 因此，我们可以修改<code>index.html</code>文件如下:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, width=device-width&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;title&gt;hello&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;form action=&quot;/greet&quot; method=&quot;get&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;input autocomplete=&quot;off&quot; autofocus name=&quot;name&quot; placeholder=&quot;Name&quot; type=&quot;text&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;button type=&quot;submit&quot;&gt;Greet&lt;/button&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/form&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，这里创建了一个表单，用于获取用户姓名，并将其提交到 <code>/greet</code> 路由。</p></li><li><p>接下来，我们可以这样修改 <code>app.py</code> 文件：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 添加一个表单，第二个路由</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, render_template, request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;index.html&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/greet&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def greet():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;greet.html&quot;, name=request.args.get(&quot;name&quot;, &quot;world&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，默认路径会显示一个表单，用户可以在其中输入姓名。<code>/greet</code> 路由会将输入的 <code>name</code> 值传递到相应的网页。</p></li><li><p>为了完成这个功能，您还需要创建另一个名为 <code>greet.html</code> 的模板文件，代码如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, width=device-width&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;title&gt;hello&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hello, {{ name }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，这个路由现在会向用户显示包含问候语和用户姓名的页面。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="布局">布局<a href="#布局" class="hash-link" aria-label="Direct link to 布局" title="Direct link to 布局">​</a></h2><ul><li><p><code>index.html</code> 和 <code>greet.html</code> 这两个页面有很多重复的内容。如果能让页面的主体内容各不相同，而其他部分沿用相同的布局，岂不是更好？</p></li><li><p>首先，创建一个新的模板文件，命名为 <code>layout.html</code>，并添加以下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, width=device-width&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;title&gt;hello&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {% block body %}{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，<code>{% block body %}{% endblock %}</code> 标签允许从其他 HTML 文件插入代码片段。</p></li><li><p>接下来，按照下面的方式修改 <code>index.html</code> 文件：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;form action=&quot;/greet&quot; method=&quot;get&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;input autocomplete=&quot;off&quot; autofocus name=&quot;name&quot; placeholder=&quot;Name&quot; type=&quot;text&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;button type=&quot;submit&quot;&gt;Greet&lt;/button&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/form&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，<code>{% extends &quot;layout.html&quot; %}</code> 这一行告诉服务器该页面应该继承 <code>layout.html</code> 的布局。而 <code>{% block body %}{% endblock %}</code> 则定义了要插入到 <code>layout.html</code> 文件中 <code>body</code> 区域的代码。</p></li><li><p>请注意，修改后的代码更加简洁。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="post">POST<a href="#post" class="hash-link" aria-label="Direct link to POST" title="Direct link to POST">​</a></h2><ul><li><p>可以想象，在某些情况下使用 <code>get</code> 方法是不安全的，因为用户名和密码可能会暴露在 URL 中。</p></li><li><p>我们可以使用 <code>post</code> 方法来解决这个问题。修改 <code>app.py</code> 文件如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 切换到 POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, render_template, request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;index.html&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/greet&quot;, methods=[&quot;POST&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def greet():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;greet.html&quot;, name=request.form.get(&quot;name&quot;, &quot;world&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，我们为 <code>/greet</code> 路由添加了 <code>POST</code> 方法，并且使用了 <code>request.form.get</code> 来获取表单数据，而不是 <code>request.args.get</code>。</p></li><li><p>这告诉服务器在虚拟信封的<em>更深层</em>去寻找数据，避免<code>post</code>请求中的信息直接显示在URL中。</p></li><li><p>不过，还可以通过将<code>get</code>和<code>post</code>请求合并到一个路由来进一步优化这段代码。为此，请按如下方式修改<code>app.py</code>：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用单个路由</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, render_template, request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if request.method == &quot;POST&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return render_template(&quot;greet.html&quot;, name=request.form.get(&quot;name&quot;, &quot;world&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;index.html&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，<code>get</code>和<code>post</code>请求的处理都在同一个路由中完成。但是，<code>request.method</code>会根据用户请求类型进行正确的路由。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="frosh-ims">Frosh IMs<a href="#frosh-ims" class="hash-link" aria-label="Direct link to Frosh IMs" title="Direct link to Frosh IMs">​</a></h2><ul><li><p>Frosh IMs，也称为 <em>froshims</em>，是一个Web应用程序，允许学生注册参加大学内部的体育活动。</p></li><li><p>在终端窗口中输入命令 <code>mkdir froshims</code> 来创建一个名为 froshims 的文件夹。然后，键入 <code>cd froshims</code> 以浏览到此文件夹。在其中，通过键入 <code>mkdir templates</code> 创建一个名为 templates 的目录。最后，键入 <code>code app.py</code> 并编写如下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用选择菜单实现注册表单</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, render_template, request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SPORTS = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Basketball&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Soccer&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Ultimate Frisbee&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;index.html&quot;, sports=SPORTS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/register&quot;, methods=[&quot;POST&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def register():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 验证提交</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if not request.form.get(&quot;name&quot;) or request.form.get(&quot;sport&quot;) not in SPORTS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return render_template(&quot;failure.html&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 确认注册</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;success.html&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，如果 <code>name</code> 或 <code>sport</code> 字段未正确填写，程序会提供一个 <code>failure</code> 选项，向用户显示错误信息。</p></li><li><p>接下来，在 <code>templates</code> 文件夹中创建 <code>index.html</code> 文件 (通过输入命令 <code>code templates/index.html</code>)，并编写以下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;h1&gt;Register&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;form action=&quot;/register&quot; method=&quot;post&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;input autocomplete=&quot;off&quot; autofocus name=&quot;name&quot; placeholder=&quot;Name&quot; type=&quot;text&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;select name=&quot;sport&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;option disabled selected&gt;Sport&lt;/option&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {% for sport in sports %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &lt;option value=&quot;{{ sport }}&quot;&gt;{{ sport }}&lt;/option&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {% endfor %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/select&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;button type=&quot;submit&quot;&gt;Register&lt;/button&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/form&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>接下来，通过键入 <code>code templates/layout.html</code> 创建一个名为 <code>layout.html</code> 的文件，并编写如下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, width=device-width&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;title&gt;froshims&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {% block body %}{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>第四，创建 <code>templates/success.html</code> 文件，内容如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    You are registered!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>最后，在 templates 中创建一个名为 <code>failure.html</code> 的文件，如下所示：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    You are not registered!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>您可以想象我们可能希望接受许多不同注册者的注册。我们可以按如下方式改进 <code>app.py</code>：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 实现注册表单，将注册者存储在字典中，并带有错误消息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, redirect, render_template, request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REGISTRANTS = {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SPORTS = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Basketball&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Soccer&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Ultimate Frisbee&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;index.html&quot;, sports=SPORTS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/register&quot;, methods=[&quot;POST&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def register():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 校验姓名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name = request.form.get(&quot;name&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if not name:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return render_template(&quot;error.html&quot;, message=&quot;姓名未填写&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 校验运动项目</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sport = request.form.get(&quot;sport&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if not sport:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return render_template(&quot;error.html&quot;, message=&quot;运动项目未选择&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if sport not in SPORTS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return render_template(&quot;error.html&quot;, message=&quot;无效的运动项目&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 保存注册者信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REGISTRANTS[name] = sport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 注册成功，正在跳转...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return redirect(&quot;/registrants&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/registrants&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def registrants():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;registrants.html&quot;, registrants=REGISTRANTS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，程序使用名为 <code>REGISTRANTS</code> 的字典来记录每位注册者选择的运动项目。同时，<code>registrants=REGISTRANTS</code> 将注册者信息字典传递给模板。</p></li><li><p>此外，创建一个名为 <code>registrants.html</code> 的新模板，如下所示：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;h1&gt;注册者&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;table&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;thead&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &lt;th&gt;姓名&lt;/th&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &lt;th&gt;运动项目&lt;/th&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;/tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/thead&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;tbody&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {% for name in registrants %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &lt;tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &lt;td&gt;{{ name }}&lt;/td&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &lt;td&gt;{{ registrants[name] }}&lt;/td&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &lt;/tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {% endfor %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/tbody&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/table&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，<code>{% for name in registrants %}...{% endfor %}</code> 将遍历每个注册者。这使得在动态网页上展示注册信息成为可能。</p></li><li><p>执行 <code>flask run</code> 并输入许多姓名和运动项目，您可以浏览到 <code>/registrants</code> 以查看已记录的数据。</p></li><li><p>现在，您已经创建了一个Web应用程序！ 但是，存在一些安全漏洞！ 因为一切都在客户端，所以攻击者可以修改HTML代码，从而入侵网站。 此外，如果服务器关闭，此数据将不会持久存在。 是否有某种方法可以使我们的数据即使在服务器重新启动后仍然存在？</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flask-和-sql">Flask 和 SQL<a href="#flask-和-sql" class="hash-link" aria-label="Direct link to Flask 和 SQL" title="Direct link to Flask 和 SQL">​</a></h2><ul><li><p>正如我们之前学习的，Python可以与SQL数据库交互，我们可以结合 Flask、Python 和 SQL 的强大功能来创建一个 Web 应用程序，其中数据将持久存在！</p></li><li><p>要实现这一点，您需要执行多个步骤。</p></li><li><p>首先，请按以下方式修改 <code>requirements.txt</code>：</p></li><li><p>请按以下方式修改 <code>index.html</code>：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;h1&gt;注册&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;form action=&quot;/register&quot; method=&quot;post&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;input autocomplete=&quot;off&quot; autofocus name=&quot;name&quot; placeholder=&quot;Name&quot; type=&quot;text&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {% for sport in sports %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;input name=&quot;sport&quot; type=&quot;radio&quot; value=&quot;{{ sport }}&quot;&gt; {{ sport }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {% endfor %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;button type=&quot;submit&quot;&gt;注册&lt;/button&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/form&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>请按以下方式修改 <code>layout.html</code>：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, width=device-width&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;title&gt;froshims&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {% block body %}{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>确保 <code>failure.html</code> 显示如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    注册失败！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>修改 <code>registrants.html</code> 以显示如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;h1&gt;已注册用户&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;table&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;thead&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &lt;tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &lt;th&gt;姓名&lt;/th&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &lt;th&gt;运动&lt;/th&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &lt;th&gt;操作&lt;/th&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &lt;/tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;/thead&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;tbody&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {% for registrant in registrants %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &lt;tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &lt;td&gt;{{ registrant.name }}&lt;/td&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &lt;td&gt;{{ registrant.sport }}&lt;/td&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &lt;td&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &lt;form action=&quot;/deregister&quot; method=&quot;post&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &lt;input name=&quot;id&quot; type=&quot;hidden&quot; value=&quot;{{ registrant.id }}&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &lt;button type=&quot;submit&quot;&gt;取消注册&lt;/button&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &lt;/form&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &lt;/td&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &lt;/tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {% endfor %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/tbody&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/table&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，<code>registrant.id</code> 是一个隐藏值，可在 <code>app.py</code> 中使用。</p></li><li><p>接下来，修改 <code>app.py</code> 如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 实现一个注册表单，将注册者存储在 SQLite 数据库中，并支持取消注册</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from cs50 import SQL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, redirect, render_template, request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db = SQL(&quot;sqlite:///froshims.db&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SPORTS = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Basketball&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Soccer&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Ultimate Frisbee&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;index.html&quot;, sports=SPORTS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/deregister&quot;, methods=[&quot;POST&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def deregister():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Forget registrant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id = request.form.get(&quot;id&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if id:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        db.execute(&quot;DELETE FROM registrants WHERE id = ?&quot;, id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return redirect(&quot;/registrants&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/register&quot;, methods=[&quot;POST&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def register():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Validate submission</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name = request.form.get(&quot;name&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sport = request.form.get(&quot;sport&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if not name or sport not in SPORTS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return render_template(&quot;failure.html&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Remember registrant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    db.execute(&quot;INSERT INTO registrants (name, sport) VALUES(?, ?)&quot;, name, sport)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Confirm registration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return redirect(&quot;/registrants&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/registrants&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def registrants():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    registrants = db.execute(&quot;SELECT * FROM registrants&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;registrants.html&quot;, registrants=registrants)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，使用了 <code>cs50</code> 库。包含一个用于 <code>POST</code> 请求的 <code>register</code> 路由。此路由从注册表单获取姓名和运动，并执行 SQL 查询将它们添加到 <code>registrants</code> 表。<code>deregister</code> 路由到一个 SQL 查询，该查询获取用户 <code>id</code> 并用它来取消注册。</p></li><li><p>您可以在 <a href="https://flask.palletsprojects.com/" target="_blank" rel="noopener noreferrer">Flask 文档</a> 中阅读更多内容。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="会话">会话<a href="#会话" class="hash-link" aria-label="Direct link to 会话" title="Direct link to 会话">​</a></h2><ul><li><p>虽然上述代码对后台管理有用，允许管理员增删用户，但在公共服务器上实施并不安全。</p></li><li><p>恶意用户可能通过点击取消注册按钮，冒充其他用户并删除其注册信息。</p></li><li><p>像 Google 这样的 Web 服务使用登录凭据来确保用户只能访问正确的数据。</p></li><li><p>实际上，我们可以使用 Cookie 实现这一点。这样，您的计算机就能与服务器通信，表明“我是一个已登录的授权用户”。</p></li><li><p>以最简单的形式，我们可以通过创建一个名为 <code>login</code> 的文件夹，然后添加以下文件来实现这一点。</p></li><li><p>首先，创建一个名为 <code>requirements.txt</code> 的文件，其内容如下：</p><p>请注意，除了 <code>Flask</code> 之外，我们还包括 <code>Flask-Session</code>，这是支持登录会话所必需的。</p></li><li><p>其次，在 <code>templates</code> 文件夹中，创建一个名为 <code>layout.html</code> 的文件，其内容如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, width=device-width&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;title&gt;store&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {% block body %}{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，这是一个非常简单的布局，包含标题和正文。</p></li><li><p>第三，在 <code>templates</code> 文件夹中创建一个名为 <code>index.html</code> 的文件，内容如下：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {% if session[&quot;name&quot;] %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        您已登录为 {{ session[&quot;name&quot;] }}。&lt;a href=&quot;/logout&quot;&gt;退出&lt;/a&gt;。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {% else %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        您尚未登录。&lt;a href=&quot;/login&quot;&gt;登录&lt;/a&gt;。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {% endif %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，此文件会检查是否存在 <code>session[&quot;name&quot;]</code>。如果存在，则显示欢迎消息；否则，建议您前往登录页面。</p></li><li><p>第四，创建一个名为 <code>login.html</code> 的文件，并添加以下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% extends &quot;layout.html&quot; %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% block body %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;form action=&quot;/login&quot; method=&quot;post&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;input autocomplete=&quot;off&quot; autofocus name=&quot;name&quot; placeholder=&quot;Name&quot; type=&quot;text&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;button type=&quot;submit&quot;&gt;Log In&lt;/button&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/form&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endblock %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，这是个基本的登录页面布局。</p></li><li><p>最后，在 <code>login</code> 文件夹中创建一个名为 <code>app.py</code> 的文件，并编写以下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, redirect, render_template, request, session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask_session import Session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configure app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configure session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.config[&quot;SESSION_PERMANENT&quot;] = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.config[&quot;SESSION_TYPE&quot;] = &quot;filesystem&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session(app)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if not session.get(&quot;name&quot;):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return redirect(&quot;/login&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;index.html&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/login&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def login():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if request.method == &quot;POST&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        session[&quot;name&quot;] = request.form.get(&quot;name&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return redirect(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;login.html&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/logout&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def logout():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    session[&quot;name&quot;] = None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return redirect(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意文件顶部修改过的 <code>imports</code> 语句，包括 <code>session</code>，这将允许您支持会话。最重要的是，注意 <code>session[&quot;name&quot;]</code> 在 <code>login</code> 和 <code>logout</code> 路由中的用法。<code>login</code> 路由会将用户提供的登录名赋值给 <code>session[&quot;name&quot;]</code>，而在 <code>logout</code> 路由中，注销操作则是通过将 <code>session[&quot;name&quot;]</code> 设置为 <code>None</code> 实现的。</p></li><li><p>您可以在 <a href="https://flask.palletsprojects.com/en/2.2.x/api/?highlight=session#flask.session" target="_blank" rel="noopener noreferrer">Flask 文档</a> 中阅读有关会话的更多信息。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="商店">商店<a href="#商店" class="hash-link" aria-label="Direct link to 商店" title="Direct link to 商店">​</a></h2><ul><li><p>接下来，我们来看最后一个利用 Flask 会话功能的例子。</p></li><li><p>我们来看一下 <code>app.py</code> 文件中关于 <code>store</code> 的代码。显示了以下代码：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from cs50 import SQL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, redirect, render_template, request, session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask_session import Session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configure app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Connect to database</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db = SQL(&quot;sqlite:///store.db&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configure session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.config[&quot;SESSION_PERMANENT&quot;] = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app.config[&quot;SESSION_TYPE&quot;] = &quot;filesystem&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Session(app)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    books = db.execute(&quot;SELECT * FROM books&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;books.html&quot;, books=books)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/cart&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def cart():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Ensure cart exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if &quot;cart&quot; not in session:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        session[&quot;cart&quot;] = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if request.method == &quot;POST&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id = request.form.get(&quot;id&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if id:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            session[&quot;cart&quot;].append(id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return redirect(&quot;/cart&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # GET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    books = db.execute(&quot;SELECT * FROM books WHERE id IN (?)&quot;, session[&quot;cart&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;cart.html&quot;, books=books)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请注意，<code>cart</code> 是使用列表实现的。用户可以通过 <code>books.html</code> 页面上的“添加到购物车”按钮将商品添加到购物车。点击这些按钮时，会触发 <code>post</code> 请求，将对应商品的 <code>id</code> 添加到购物车 <code>cart</code> 列表中。当用户查看购物车时，会触发 <code>get</code> 请求，执行 SQL 查询以显示购物车中的商品列表。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="api">API<a href="#api" class="hash-link" aria-label="Direct link to API" title="Direct link to API">​</a></h2><ul><li><p>一个<em>应用程式介面</em> (API) 是一系列规范，允许您与其他服务进行交互。例如，我们可以利用 IMDB 的 API 与他们的数据库进行交互。我们甚至可以集成 API 来处理从服务器下载的特定类型的数据。</p></li><li><p>我们看了一个名为 <code>shows</code> 的例子。</p></li><li><p>在 <code>app.py</code> 文件中，我们看到如下代码:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用 Ajax 搜索节目</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from cs50 import SQL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from flask import Flask, render_template, request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app = Flask(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db = SQL(&quot;sqlite:///shows.db&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def index():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;index.html&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@app.route(&quot;/search&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def search():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    q = request.args.get(&quot;q&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if q:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shows = db.execute(&quot;SELECT * FROM shows WHERE title LIKE ? LIMIT 50&quot;, &quot;%&quot; + q + &quot;%&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shows = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return render_template(&quot;search.html&quot;, shows=shows)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，<code>search</code> 路由会执行 SQL 查询。</p></li><li><p>查看 <code>search.html</code>，您会注意到它非常简单：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{% for show in shows %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;li&gt;{{ show[&quot;title&quot;] }}&lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{% endfor %}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意，这里展示的是一个项目符号列表。</p></li><li><p>最后，在 <code>index.html</code> 文件中，可以看到 <em>AJAX</em> 代码被用于实现搜索功能:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, width=device-width&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;title&gt;shows&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;input autocomplete=&quot;off&quot; autofocus placeholder=&quot;Query&quot; type=&quot;search&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;ul&gt;&lt;/ul&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;script&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            let input = document.querySelector(&#x27;input&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            input.addEventListener(&#x27;input&#x27;, async function() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                let response = await fetch(&#x27;/search?q=&#x27; + input.value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                let shows = await response.text();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                document.querySelector(&#x27;ul&#x27;).innerHTML = shows;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/script&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这段代码会找到 HTML 中的 <code>ul</code> 标签，并用匹配结果更新该标签的内容。</p></li><li><p>您可以在 <a href="https://api.jquery.com/category/ajax/" target="_blank" rel="noopener noreferrer">AJAX 文档</a> 中阅读更多内容。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="json">JSON<a href="#json" class="hash-link" aria-label="Direct link to JSON" title="Direct link to JSON">​</a></h2><ul><li><p><em>JavaScript 对象表示法</em> 或 <em>JSON</em> 是包含键和值的字典的文本文件。 这是一种原始的、计算机友好的方式来获取大量数据。</p></li><li><p>JSON 是一种从服务器获取数据的高效方式。</p></li><li><p>您可以在我们一起检查的 <code>index.html</code> 中看到这一点：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;viewport&quot; content=&quot;initial-scale=1, width=device-width&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;title&gt;shows&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;input autocomplete=&quot;off&quot; autofocus placeholder=&quot;Query&quot; type=&quot;text&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;ul&gt;&lt;/ul&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;script&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            let input = document.querySelector(&#x27;input&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            input.addEventListener(&#x27;input&#x27;, async function() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                let response = await fetch(&#x27;/search?q=&#x27; + input.value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                let shows = await response.json();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                let html = &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                for (let id in shows) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    let title = shows[id].title.replace(&#x27;&lt;&#x27;, &#x27;&amp;lt;&#x27;).replace(&#x27;&amp;&#x27;, &#x27;&amp;amp;&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    html += &#x27;&lt;li&gt;&#x27; + title + &#x27;&lt;/li&gt;&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                document.querySelector(&#x27;ul&#x27;).innerHTML = html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/script&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>虽然上面的代码可能有些复杂，但它可以作为一个起点，帮助你了解如何在自己的 Web 应用中使用 JSON。</p></li><li><p>您可以在 <a href="https://www.json.org/json-en.html" target="_blank" rel="noopener noreferrer">JSON 文档</a> 中阅读更多内容。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结一下">总结一下<a href="#总结一下" class="hash-link" aria-label="Direct link to 总结一下" title="Direct link to 总结一下">​</a></h2><p>在本课程中，您学习了如何利用 Python、SQL 和 Flask 创建 Web 应用程序。 具体来说，我们讨论了...</p><ul><li>GET</li><li>POST</li><li>Flask</li><li>Session</li><li>AJAX</li><li>JSON</li></ul><p>我们下节课再见，这将是最后一讲了！</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture10"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">lecture9 Flask</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/curriculum-resource/cs50x/cs50x_zh/lecture10/problem set"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">问题集</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#欢迎" class="table-of-contents__link toc-highlight">欢迎！</a></li><li><a href="#从静态到动态" class="table-of-contents__link toc-highlight">从静态到动态</a></li><li><a href="#flask" class="table-of-contents__link toc-highlight">Flask</a></li><li><a href="#布局" class="table-of-contents__link toc-highlight">布局</a></li><li><a href="#post" class="table-of-contents__link toc-highlight">POST</a></li><li><a href="#frosh-ims" class="table-of-contents__link toc-highlight">Frosh IMs</a></li><li><a href="#flask-和-sql" class="table-of-contents__link toc-highlight">Flask 和 SQL</a></li><li><a href="#会话" class="table-of-contents__link toc-highlight">会话</a></li><li><a href="#商店" class="table-of-contents__link toc-highlight">商店</a></li><li><a href="#api" class="table-of-contents__link toc-highlight">API</a></li><li><a href="#json" class="table-of-contents__link toc-highlight">JSON</a></li><li><a href="#总结一下" class="table-of-contents__link toc-highlight">总结一下</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">CS学习社区</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">路线图</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyleft © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a7b75e5e.js"></script>
<script src="/assets/js/main.0bc30274.js"></script>
</body>
</html>