<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-curriculum-resource/cs61c/projects/proj4" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Project4 | CS自学社区</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.learncs.site/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.learncs.site/docs/curriculum-resource/cs61c/projects/proj4"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="baidu-site-verification" content="codeva-hJyfN2UKgo"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Project4 | CS自学社区"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.learncs.site/docs/curriculum-resource/cs61c/projects/proj4"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/cs61c/projects/proj4" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.learncs.site/docs/curriculum-resource/cs61c/projects/proj4" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CS自学社区 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CS自学社区 Atom Feed">




<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.35067f2e.css">
<link rel="preload" href="/assets/js/runtime~main.85a3caca.js" as="script">
<link rel="preload" href="/assets/js/main.8c32c80d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="content_knG7 announcementBarContent_xLdY">🎉️🎉️🎉️课程文档汉化工作正在进行中 🎉️🎉️ 学习交流群请到 <a href="/community">社区页面</a> 查看入群方式 🎉️🎉️🎉️</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="TeachYourselfCS" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">TeachYourselfCS</b></a><a class="navbar__item navbar__link" href="/docs/roadmap">路线图</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">课程资源</a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/community">社区</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">前言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/roadmap">路线图</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/课程资源">课程资源</a><button aria-label="Toggle the collapsible sidebar category &#x27;课程资源&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs50x">cs50x</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs50x&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61a">cs61a</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61a&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61b">cs61b</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61b&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs61c">cs61c</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs61c&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs61c/syllabus">syllabus-课程大纲</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs61c/labs/lab00">labs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/curriculum-resource/cs61c/projects/proj1">projects</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs61c/projects/proj1">Project1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs61c/projects/proj2">Project2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/curriculum-resource/cs61c/projects/proj3">Project3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/curriculum-resource/cs61c/projects/proj4">Project4</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-01">MIT 18.01</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.01&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-02">MIT 18.02</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.02&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/18-06">MIT 18.06</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 18.06&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/6-04j">MIT 6.042J</a><button aria-label="Toggle the collapsible sidebar category &#x27;MIT 6.042J&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs162">cs162</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs162&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/curriculum-resource/cs144">cs144</a><button aria-label="Toggle the collapsible sidebar category &#x27;cs144&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/课程资源"><span itemprop="name">课程资源</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/curriculum-resource/cs61c"><span itemprop="name">cs61c</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">projects</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Project4</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Project 4: Numc</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p><strong>Due Wednesday, December 4th</strong></p><p>This project is designed to be both a C project as well as a performance project. In this project you will be implementing a slower version of numpy. Your version of numpy, <code>numc</code> (how exciting!), is most likely to be slower than numpy, but much faster than the naive implementations of matrix operations. You will first complete a naive solution for some matrix functions in C, then you will experiment with the setup file in Python to install your <code>numc</code> module. After that, you will gain a deeper understanding of the Python-C interface by overloading some operators and defining some instance methods for <code>numc.Matrix</code> objects. Finally, you will speed up your naive solution, thus making <code>numc.Matrix</code> operations faster.</p><p>Do not expect your final completed <code>numc</code> module to be as good as numpy, but you should expect a very large speedup compared to the naive solution, especially for matrix multiplication and exponentiation!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tips-and-guidelines">Tips and Guidelines<a href="#tips-and-guidelines" class="hash-link" aria-label="Direct link to Tips and Guidelines" title="Direct link to Tips and Guidelines">​</a></h2><p><strong><a href="https://piazza.com/class/kd0ifacummd56a?cid=3778" target="_blank" rel="noopener noreferrer">Here</a> is a list of all the important clarifications!!</strong> For each new clarification we make, it will be reflected both in that post and the spec.</p><ul><li><strong>Please start early!</strong> Because there are many more 61C students than Hive machines, you will likely share resources with your classmates. This might affect the measurement of your code’s speedup. We encourage you to use <a href="https://hivemind.eecs.berkeley.edu/" target="_blank" rel="noopener noreferrer">Hivemind</a> to help balance the load amongst the hive machines.<ul><li>You will have 6 tokens every 24 hours for the Gradescope assignment.</li><li>You can complete task 1 through 3 before the performance lectures (lec 33-35) and task 4 after. So again, please start early!</li></ul></li><li>You will get negative points up to the number of points it is worth if you fail to complete task 5, so you should do it as much as you can even if you do not complete the entire project!</li><li>You can either allocate new matrices and throw errors in <strong><code>numc.c</code></strong> or <strong><code>matrix.c</code></strong>.</li><li>We will not be directly testing your C code. All tests will be in Python!</li><li>You may change the function signatures in <strong><code>matrix.h</code></strong> and <strong><code>matrix.c</code></strong> as you deem appropriate, but you may not change the function signatures in <strong><code>numc.h</code></strong> and <strong><code>numc.c</code></strong>.</li><li>You may change the skeleton code in <strong><code>numc.c</code></strong>.</li><li>You may <strong>NOT</strong> add/remove any additional imports.</li><li>If you would like to run the reference solution to compare your solution to, you can import the <strong><code>dumbpy</code></strong> library on hive as we have already installed it there for you!</li><li>For this project, <strong>we strongly suggest working on Hive machines under you cs61c account</strong>. We have set up a few environment settings that only work if you use your cs61c account.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting Started<a href="#getting-started" class="hash-link" aria-label="Direct link to Getting Started" title="Direct link to Getting Started">​</a></h2><p>Ssh into one of the hive machines <strong>under your cs61c class account</strong>.</p><p>Please follow the directions in this Google Form to get a repository: <a href="https://docs.google.com/forms/d/e/1FAIpQLSc59h0HsJLPfhqbJ8hil01lrfIvK0xTPxTihB1C3KfpmkGc2Q/viewform" target="_blank" rel="noopener noreferrer">https://docs.google.com/forms/d/e/1FAIpQLSc59h0HsJLPfhqbJ8hil01lrfIvK0xTPxTihB1C3KfpmkGc2Q/viewform</a>. After completing the form, clone your GitHub Classroom repository and add the starter code repository as a remote:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone YOUR_REPO_NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd YOUR_REPO_NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git remote add starter https://github.com/61c-teach/fa20-proj4-starter.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we publish changes to the starter code, retrieve them using git pull starter master.</p><p>To be able install the modules that you will complete in this project, you must create a virtual environment with by running</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ python3.6 -m venv .venv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that you <strong>MUST</strong> use python 3.6 as our reference module <code>dumbpy</code> only supports this specific version of python. Finally, run the following command to activate the virtual environment:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ source .venv/bin/activate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will put you in a virtual environment needed for this project. Please remember that if you exit the virtual environment and want to return to work on the project, you must re-run <code>source .venv/bin/activate</code>. This also means every time you re-ssh into the hive, you will have to re-run <code>source .venv/bin/activate</code>.</p><p>Then, run</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install -r requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>in the virtual environment. This will install all python packages you need for running your custom python tests.</p><p>Finally, if you have to exit out of the virtual environment, you can do so by running:</p><p><strong>We already have the reference library <code>dumbpy</code> installed for you on Hive machines.</strong> You can import it with or without the virtual environment while using python3.6, and all object and function names are the same as the <code>numc</code> module that you will implement (please refer to <a href="#task-3">Task 3</a>). <strong>You will only be able to access the dumbpy package on hive as we will not be directly releasing it</strong>. You can use it as a reference for both correctness and speed.</p><p>Again, for this project, <strong>we strongly suggest working on Hive machines in your cs61c class account</strong>. <strong>You will not be able to import dumbpy if you are using other class accounts</strong>. We may be unable to help you with issues caused by working outside of the Hive.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1-matrix-functions-in-c">Task 1: Matrix functions in C<a href="#task-1-matrix-functions-in-c" class="hash-link" aria-label="Direct link to Task 1: Matrix functions in C" title="Direct link to Task 1: Matrix functions in C">​</a></h2><p>For this task, you will need to complete all functions in <strong><code>matrix.c</code></strong> labelled with <code>/* TODO: YOUR CODE HERE */</code>. The comments above each function signature in <strong><code>matrix.c</code></strong> contain instructions on how to implement the functions, so read them carefully before you start coding.</p><p>The <code>matrix</code> struct is defined in <strong><code>matrix.h</code></strong>. Feel free to change it, but make sure your changes are compatible with our starter code.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">typedef struct matrix {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int rows;       // number of rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int cols;       // number of columns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  double **data;  // each element is a pointer to a row of data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int is_1d;      // Whether this matrix is a 1d matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  // For 1D matrix, shape is (rows * cols)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int ref_cnt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  struct matrix *parent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} matrix;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>rows</code> is the number of rows of this matrix, <code>cols</code> is the number of columns, and <code>data</code> is a 2D representation of the matrix data. <code>ref_cnt</code> is the number of existing <code>matrix</code> structs (including itself) that share all or part of the data array with this particular <code>matrix</code> struct. <code>is_1d</code> is non-zero if the number of rows is 1 or the number of columns is 1. <code>parent</code> indicates whether this <code>matrix</code> struct is a slice of another matrix, and should be set to its parent <code>matrix</code> struct if it is and <code>NULL</code> otherwise.</p><p><strong><code>matrix.h</code></strong> also imports the library <code>Python.h</code>, but for this part you should not need any other functions besides <code>PyErr_SetString</code>.</p><p>Depending on your implementation of <strong><code>matrix.c</code></strong> and <strong><code>numc.c</code></strong>, you may or may not assume that <code>result</code> is already preallocated or that all inputs’ dimensions are valid. However, as mentioned in the <a href="#tip">Tips and Guidelines</a> section, your Python number methods will need to handle the case where matrix allocation fails.</p><p>Again, you may change any function signature in <strong><code>matrix.h</code></strong> and <strong><code>matrix.c</code></strong>.</p><p><strong>Important notes</strong>:</p><ul><li><strong>Remember to throw a runtime error if <code>allocate_matrix</code> or <code>allocate_matrix_ref</code> fails to allocate space, or a value error if you are trying to allocate matrices with non-positive dimensions!</strong> Otherwise you would have to make sure that a runtime/value error will be thrown in <strong><code>numc.c</code></strong> whenever we run out of memory. <strong>This includes throwing an error in Matrix61c<!-- -->_<!-- -->init</strong>.</li><li><strong>Remember to set the <code>is_1d</code> field when initializing matrices in <code>allocate_matrix</code> or <code>allocate_matrix_ref</code>!</strong>. Since 1D matrices are printed out differently than 2D, autograder tests may fail if <code>is_1d</code> is not set correctly.</li><li>The <code>deallocate</code> function as well as the <code>ref_cnt</code> field in the <code>matrix</code> struct have caused a lot of confusions in the past semesters. It is important to remember that this <code>ref_cnt</code> is <strong>NOT</strong> Python’s internal reference count. It is simply a field that will help you implement the <code>deallocate</code> function. It does not have to reflect the true reference count if you deem that setting it to other values will simplify your implementation of <code>deallocate</code>.</li><li>For the <code>deallocate</code> function, since there can be multiple matrices that refer to the same data array in the memory, you must not free the data until you call <code>deallocate</code> on the last existing matrix that refers to that data. If you are having some difficulties implementing this, here’s a hint: you can keep the matrix struct in the memory even if you have already called <code>deallocate</code> on that matrix. <strong>You only need to make sure to that the struct is freed once the last matrix referring to its data is deallocated.</strong><ul><li>If this explanation does not make sense now, don’t worry! It will make more sense after you implement the <a href="#indexing">indexing section</a> of task 3.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-for-correctness">Testing for Correctness<a href="#testing-for-correctness" class="hash-link" aria-label="Direct link to Testing for Correctness" title="Direct link to Testing for Correctness">​</a></h3><p>We’ve provided some sanity in <strong><code>mat_test.c</code></strong>. <strong>These tests make several assumptions:</strong></p><ul><li>They assume that all result matrices are already pre-allocated with the correct dimensions and that all input dimensions are valid.</li><li>They assume that you have not modified the <code>matrix</code> struct in <strong><code>matrix.h</code></strong></li><li>All tests except the tests for <code>get</code> and <code>set</code> assume that your <code>get</code> and <code>set</code> are correct</li><li>They assume that you have not modified the function signatures.</li></ul><p>Violation of one or more of these assumptions may not cause your tests to fail, but please keep this in mind if your tests are failing and you are violating at least one of these assumptions.</p><p>To run the CUnit tests, run</p><p>in the root folder of your project. This will create an executable called <strong><code>test</code></strong> in the root folder and run it.</p><p>By default, CUnit will run these tests in Normal mode. When debugging a specific issue, it may be helpful to switch to Verbose mode, which can be done by commenting and uncommenting the relevant lines in <code>mat_test.c</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// CU_basic_set_mode(CU_BRM_NORMAL);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CU_basic_set_mode(CU_BRM_VERBOSE);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure that one line is uncommented at a time.</p><p>Please keep in mind that these tests are not comprehensive, and passing all the sanity tests does not necessarily mean your implementation is correct. This is especially true with the memory functions <code>allocate_matrix</code>, <code>allocate_matrix_ref</code>, and <code>deallocate_matrix</code>. Also keep in mind that the autograder will be using our own set of sanity tests. We will not directly test your C code, and will not be running your CUnit tests.</p><p>Another thing to note is that the <strong><code>Makefile</code></strong> is written for compilation on the hive machines. If you wish to run it locally, you will have to modify the <strong><code>Makefile</code></strong> by replacing the path to your CUnit/Python libraries in your <code>CUNIT</code> and <code>PYTHON</code> variables. You will also need to make sure that your local computer supports AVX extensions and OpenMP.</p><p>Finally, you are welcomed to modify <strong><code>mat_test.c</code></strong> to implement your custom test cases.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-writing-the-setup-file">Task 2: Writing the setup file<a href="#task-2-writing-the-setup-file" class="hash-link" aria-label="Direct link to Task 2: Writing the setup file" title="Direct link to Task 2: Writing the setup file">​</a></h2><p>The <code>setup.py</code> file is used for installing your custom-built modules. After completing it, you should be able to install <code>numc</code> by simply running:</p><p>This will uninstall your previously installed <code>numc</code> module if it existed and reinstall <code>numc</code>. We have written <code>numc.c</code> so that <code>numc.Matrix</code> will be initialized and ready to import upon succesful installation of the <code>numc</code> module. You should rerun <code>make</code> every time you make changes and want them to be reflected in the <code>numc</code> module.</p><p>You can uninstall your <code>numc</code> module by running</p><p>We have provided you with the compiler and linker flags in <code>setup.py</code>, and your task is to find out how to use them to build your module.</p><p>You will likely get a lot of warnings about functions being defined but not used, and that’s ok! You should ignore these warnings for now, and they will be gone after you finish writing Task 3.</p><p>Remember that <strong>you must be in the virtual environment that you set up in order to install the modules</strong>, otherwise you will get a “Read-only file system” error.</p><p><strong>READ FIRST</strong>: take a look at the function <code>distutils.core.setup</code> (<a href="https://docs.python.org/3.6/distutils/apiref.html" target="_blank" rel="noopener noreferrer">https://docs.python.org/3.6/distutils/apiref.html</a>), and here is an <a href="https://docs.python.org/3.6/extending/building.html" target="_blank" rel="noopener noreferrer">example usage</a>. If the documentation seems too difficult to understand, it is a good idea to take a look at the example first. You only need two function calls to complete this section, if you’re doing more than that, please reread the docs included as you’re likely doing something wrong</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-writing-the-python-c-interface">Task 3: Writing the Python-C interface<a href="#task-3-writing-the-python-c-interface" class="hash-link" aria-label="Direct link to Task 3: Writing the Python-C interface" title="Direct link to Task 3: Writing the Python-C interface">​</a></h2><p>Now that you have successfully installed your <code>numc</code> module, you can import your <code>numc.Matrix</code> objects in Python programs! Here are some ready-to-use features already implemented for <code>numc.Matrix</code> objects. You might find them helpful when debugging Task 3.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="info-importing-numcmatrix">Info: Importing <code>numc.Matrix</code><a href="#info-importing-numcmatrix" class="hash-link" aria-label="Direct link to info-importing-numcmatrix" title="Direct link to info-importing-numcmatrix">​</a></h3><p>Here are several ways of importing <code>numc.Matrix</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">from numc import Matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import numc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">numc.Matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nc.Matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="info-numcmatrix-initialization">Info: <code>numc.Matrix</code> initialization<a href="#info-numcmatrix-initialization" class="hash-link" aria-label="Direct link to info-numcmatrix-initialization" title="Direct link to info-numcmatrix-initialization">​</a></h3><p>Here are all the different ways of creating a <code>numc.Matrix</code> object.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CS61C Fall 2020 Project 4: numc imported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; nc.Matrix(3, 3) # This creates a 3 * 3 matrix with entries all zeros</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; nc.Matrix(3, 3, 1) # This creates a 3 * 3 matrix with entries all ones</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[1.0, 1.0, 1.0], [1.0, 1.0, 1.0], [1.0, 1.0, 1.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; nc.Matrix([[1, 2, 3], [4, 5, 6]]) # This creates a 2 * 3 matrix with first row 1, 2, 3, second row 4, 5, 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; nc.Matrix(1, 2, [4, 5]) # This creates a 1 * 2 matrix with entries 4, 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4.0, 5.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>More specifically:</p><ul><li><code>nc.Matrix(rows: int, cols: int)</code> will create a matrix with <code>rows</code> rows and <code>cols</code> cols. All entries in this matrix are defaulted to 0.</li><li><code>nc.Matrix(rows: int, cols: int, val: float/int)</code> will create a matrix with <code>rows</code> rows and <code>cols</code> cols. All entries in this matrix will be initialized to <code>val</code>.</li><li><code>nc.Matrix(rows: int, cols: int, lst: List[int/float])</code> will create a matrix with <code>rows</code> rows and <code>cols</code> cols. <code>lst</code> must have length <code>rows * cols</code>, and entries of the matrix will be initialized to values of <code>lst</code> in a row-major order.</li><li><code>nc.Matrix(lst: List[List[int/float]])</code> will create a matrix with the same shape as the 2D <code>lst</code> (i.e. each list in <code>lst</code> is a row for this matrix).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="info-instance-attributes">Info: instance attributes<a href="#info-instance-attributes" class="hash-link" aria-label="Direct link to Info: instance attributes" title="Direct link to Info: instance attributes">​</a></h3><p>The matrices and vectors have an attribute shape. For a 2D matrix, it is a tuple of <code>(rows, cols)</code>. For a 1D matrix, it is a one-element tuple of <code>(number of elements, )</code> Example is given below.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CS61C Fall 2020 Project 4: numc imported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; mat = nc.Matrix(3, 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; mat.shape</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(3, 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; mat = nc.Matrix(3, 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; mat.shape</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(3,)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Because 1D matrices’ shapes are tricky, <strong>we are NOT testing matrix operations on your 1D matrices</strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="info-pythonc-api-reference">Info: Python/C API Reference<a href="#info-pythonc-api-reference" class="hash-link" aria-label="Direct link to Info: Python/C API Reference" title="Direct link to Info: Python/C API Reference">​</a></h3><p>Here is the link to the full reference manual: <a href="https://docs.python.org/3.6/c-api/index.html" target="_blank" rel="noopener noreferrer">https://docs.python.org/3.6/c-api/index.html</a>. If you ever find anything confusing in the skeleton code or are at a lost on how to implement <strong><code>numc.c</code></strong>, this is a great resource.</p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="quick-overview-of-numc-skeleton-code">Quick Overview of <code>numc</code> skeleton code<a href="#quick-overview-of-numc-skeleton-code" class="hash-link" aria-label="Direct link to quick-overview-of-numc-skeleton-code" title="Direct link to quick-overview-of-numc-skeleton-code">​</a></h3><p>We define the <code>Matrix61c</code> struct in <strong><code>numc.h</code></strong>. It is of type <code>PyObject</code> (this means you can always cast <code>Matrix61c</code> to <code>PyObject</code>, but not vice versa), which according to the official documentation, “contains the information Python needs to treat a pointer to an object as an object”. Our <code>Matrix61c</code> has the <code>matrix</code> struct we defined in <strong><code>matrix.h</code></strong>.</p><p>Then we define a struct <code>PyTypeObject</code> named <code>Matrix61cType</code> to specify the intended behaviors of our Python object <code>Matrix61c</code>. This struct will then be initialized to be our <code>numc.Matrix</code> objects.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">static PyTypeObject Matrix61cType = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PyVarObject_HEAD_INIT(NULL, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_name = &quot;numc.Matrix&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_basicsize = sizeof(Matrix61c),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_dealloc = (destructor)Matrix61c_dealloc,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_repr = (reprfunc)Matrix61c_repr,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_as_number = &amp;Matrix61c_as_number,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_flags = Py_TPFLAGS_DEFAULT |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Py_TPFLAGS_BASETYPE,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_doc = &quot;numc.Matrix objects&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_methods = Matrix61c_methods,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_members = Matrix61c_members,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_as_mapping = &amp;Matrix61c_mapping,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_init = (initproc)Matrix61c_init,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .tp_new = Matrix61c_new</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For example, <code>.tp_dealloc</code> tells Python which function to call to destroy a <code>numc.Matrix</code> object when its reference count becomes 0, and <code>.tp_members</code> tells Python what instance attributes <code>numc.Matrix</code> objects have. You can take a look at the <a href="https://docs.python.org/3.6/c-api/typeobj.html" target="_blank" rel="noopener noreferrer">official documentation</a> if you are curious.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="useful-functions">Useful functions:<a href="#useful-functions" class="hash-link" aria-label="Direct link to Useful functions:" title="Direct link to Useful functions:">​</a></h3><p>Here is a list of some functions and Python objects from <code>&lt;Python.h&gt;</code> that you may find useful. You can also choose any other functions at this <a href="https://docs.python.org/3.6/c-api/index.html" target="_blank" rel="noopener noreferrer">link</a>.</p><ul><li><a href="https://docs.python.org/3.6/c-api/object.html" target="_blank" rel="noopener noreferrer">PyObject<!-- -->_<!-- -->TypeCheck</a></li><li><a href="https://docs.python.org/3.6/c-api/exceptions.html" target="_blank" rel="noopener noreferrer">PyErr<!-- -->_<!-- -->SetString</a></li><li><a href="https://docs.python.org/3.6/c-api/arg.html" target="_blank" rel="noopener noreferrer">Py<!-- -->_<!-- -->BuildValue</a></li><li><a href="https://docs.python.org/3.6/c-api/tuple.html" target="_blank" rel="noopener noreferrer">PyTupleObject</a></li><li><a href="https://docs.python.org/3.6/c-api/long.html" target="_blank" rel="noopener noreferrer">PyLongObject</a></li><li><a href="https://docs.python.org/3.6/c-api/float.html" target="_blank" rel="noopener noreferrer">PyFloatObject</a></li><li><a href="https://docs.python.org/3.6/c-api/list.html" target="_blank" rel="noopener noreferrer">PyListObject</a></li></ul><hr><p>Now you are ready to complete <strong><code>numc.c</code></strong>, the Python-C interface! As before, you will need to fill out all functions and variables labeled <code>/* TODO: YOUR CODE HERE */</code>. The code for initializing the module <code>numc</code> and the object type <code>numc.Matrix</code> is already done for you. Although not required, we encourage you to take a look at the existing code to better understand the interface.</p><p>Below are the three main parts for this task.</p><p><strong>Note: For each of the function below, we specify when you should throw each type of error. For any errors not specified, throw a runtime error.</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="number-methods">Number Methods<a href="#number-methods" class="hash-link" aria-label="Direct link to Number Methods" title="Direct link to Number Methods">​</a></h3><p>For this part, we ask you to overload operators for <code>numc.Matrix</code> objects. Here are the expected behaviors of overloaded operators:</p><ul><li><code>a + b</code>: Element-wise sum of <code>a</code> and <code>b</code>. Returns a <code>numc.Matrix</code> object.<ul><li>Throwing errors:<ul><li><code>TypeError</code> if <code>b</code> is not of type <code>numc.Matrix</code>.</li><li><code>ValueError</code> if <code>a</code> and <code>b</code> do not have the same dimensions.</li></ul></li></ul></li><li><code>a - b</code>: Element-wise subtraction of <code>a</code> and <code>b</code>. Returns a <code>numc.Matrix</code> object.<ul><li>Throwing errors:<ul><li><code>TypeError</code> if <code>b</code> is not of type <code>numc.Matrix</code>.</li><li><code>ValueError</code> if <code>a</code> and <code>b</code> do not have the same dimensions.</li></ul></li></ul></li><li><code>a * b</code>: Matrix multiplication of <code>a</code> and <code>b</code>. Returns a <code>numc.Matrix</code> object. Remember that this is a matrix multiplication, not an element-wise multiplication.<ul><li>Throwing errors:<ul><li><code>TypeError</code> if <code>b</code> is not of type <code>numc.Matrix</code></li><li><code>ValueError</code> if <code>a</code>’s number of columns is not equal to <code>b</code>’s number of rows.</li></ul></li></ul></li><li><code>-a</code>: Element-wise negation of <code>a</code>. Returns a <code>numc.Matrix</code> object.</li><li><code>abs(a)</code>: Element-wise absolute value of <code>a</code>. Returns a <code>numc.Matrix</code> object.</li><li><code>a ** pow</code>: Raise <code>a</code> to the <code>pow</code>th power. <code>a</code> to the 0th power is the identity matrix (1 on the top left to bottom right diagonal and 0 everywhere else). Returns a <code>numc.Matrix</code> object. This operator is defined in terms of matrix multiplication, not element-wise multiplication.<ul><li>Throwing errors:<ul><li><code>TypeError</code> if <code>pow</code> is not an integer.</li><li><code>ValueError</code> if <code>a</code> is not a square matrix or if <code>pow</code> is negative.</li></ul></li></ul></li></ul><p><strong>Please note that for all these operations above, you must never directly modify the matrix that you pass in.</strong> You always make a new <code>numc.Matrix</code> object to hold your result, so make sure you set the <code>shape</code> attribute of the new <code>numc.Matrix</code>. You can use <code>Matrix61c_new</code> to create new <code>numc.Matrix</code> objects. For your convenience, here’s an example of how you create a <code>numc.Matrix</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/* Assume new_mat is a matrix struct */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Matrix61c *rv = (Matrix61c *) Matrix61c_new(&amp;Matrix61cType, NULL, NULL);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rv-&gt;mat = new_mat;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* Set the shape of this numc.Matrix */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rv-&gt;shape = ...; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For all the functions above, throw a runtime error if any error occurs (such as matrix allocation failure) and causes the operation to fail. Moreover, for any operations that involve two instances of <code>numc.Matrix</code>, you will have to make sure that the second instance <code>b</code> is indeed of type <code>numc.Matrix</code> as we do not support operations between <code>numc.Matrix</code> and other data/object types. <strong>Please read the comments in <code>numc.c</code> carefully</strong>.</p><p>Here is a table that tells you which function in <strong><code>numc.c</code></strong> in which you will implement each of the above operators</p><table><thead><tr><th>Operator</th><th>Function</th></tr></thead><tbody><tr><td>+</td><td><code>Matrix61c_add</code></td></tr><tr><td>-<!-- --> (subtraction)</td><td><code>Matrix61c_sub</code></td></tr><tr><td>*</td><td><code>Matrix61c_multiply</code></td></tr><tr><td>-<!-- --> (negation)</td><td><code>Matrix61c_neg</code></td></tr><tr><td>abs()</td><td><code>Matrix61c_abs</code></td></tr><tr><td>*<!-- -->*</td><td><code>Matrix61c_pow</code></td></tr></tbody></table><p>All these functions will be called through a Python-C interface after you complete the <code>numc</code> module. In other words, these are the functions that will be called when you do matrix operations with <code>numc.Matrix</code> objects, and these interface methods will call <strong><code>matrix.c</code></strong> methods that you just implemented. You will have to check for the validity of the dimensions before actually carrying out the arithmetic, and throw an error if needed. Specifically, throw a value error if the arguments’ dimensions are invalid, and a runtime error if any memory allocation fails during execution. Again, depending on your implementation, these error checks could either be in <strong><code>matrix.c</code></strong> or <strong><code>numc.c</code></strong></p><p>After you implement all the functions above, you will need to fill out the struct <code>Matrix61c_as_number</code>, which is used to define the object type <code>numc.Matrix</code>.</p><p>Here is the link to the official documentation of a <code>PyNumberMethods</code> struct: <a href="https://docs.python.org/3/c-api/typeobj.html#c.PyNumberMethods" target="_blank" rel="noopener noreferrer">https://docs.python.org/3/c-api/typeobj.html#c.PyNumberMethods</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="instance-methods">Instance Methods<a href="#instance-methods" class="hash-link" aria-label="Direct link to Instance Methods" title="Direct link to Instance Methods">​</a></h3><p>You will implement two instance methods for <code>numc.Matrix</code>:</p><ul><li><code>set(self, i, j, val)</code>: Set <code>self</code>’s entry at the <code>i</code>th row and <code>j</code>th column to <code>val</code>.<ul><li>Throwing errors:<ul><li><code>TypeError</code> if the number of arguments parsed from args is not 3, if <code>i</code> and <code>j</code> are not integers, or if <code>val</code> is not a float or int.</li><li><code>IndexError</code> if <code>i</code> or <code>j</code> or both are out of range.</li></ul></li></ul></li><li><code>get(self, i, j)</code>: Returns the entry at the <code>i</code>th row and <code>j</code>th column. Throw a type error if the number of arguments parsed from args is not 2 or if the arguments are of the wrong types. Throw an index error if either <code>i</code>, <code>j</code>, or both are out of range. Return value is a Python float.<ul><li>Throwing errors:<ul><li><code>TypeError</code> if the number of arguments parsed from args is not 2 or if either <code>i</code> or <code>j</code> is not an integer.</li><li><code>IndexError</code> if <code>i</code> or <code>j</code> or both are out of range.</li></ul></li></ul></li></ul><p>These functions will call <code>get</code> and <code>set</code> in <strong><code>matrix.c</code></strong> to actually get or set the value. Again, you can throw errors either in <strong><code>numc.c</code></strong> or <strong><code>matrix.c</code></strong>.</p><p>Here is a table that tells you which functions in <strong><code>numc.c</code></strong> in which you will implement each of the above instance methods</p><table><thead><tr><th>Python method</th><th>C Function</th></tr></thead><tbody><tr><td><code>set</code></td><td><code>Matrix61c_set_value</code></td></tr><tr><td><code>get</code></td><td><code>Matrix61c_get_value</code></td></tr></tbody></table><p>After you implement all the functions above, you will need to fill out the array of <code>PyMethodDef</code> structs <code>Matrix61c_methods</code>, which is used to define the object type <code>numc.Matrix</code>.</p><p>This link tells you what goes into a <code>PyMethodDef</code> struct: <a href="https://docs.python.org/3/c-api/structures.html" target="_blank" rel="noopener noreferrer">https://docs.python.org/3/c-api/structures.html</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="indexing">Indexing<a href="#indexing" class="hash-link" aria-label="Direct link to Indexing" title="Direct link to Indexing">​</a></h3><p>After finishing this part, you should be able to index into a matrix and change either the value of one single entry or a slice. You will need to complete the following two functions:</p><ul><li><strong><code>static PyObject *Matrix61c_subscript(Matrix61c *self, PyObject *key)</code></strong><ul><li><p>This function takes in a <code>numc</code> matrix and the key to index into the matrix. For a 2D matrix, the key could either be an integer, a single slice, or a tuple of two slices/ints. For a 1D matrix, the key could either be an integer or a single slice. Below we provide an example for each case.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CS61C Fall 2020 Project 4: numc imported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a = nc.Matrix(3, 3) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0] # Key is a single number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [0.0, 0.0, 0.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0:2] # key is a single slice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0:2, 0:2] # key is a tuple of two slices</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[0.0, 0.0], [0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0:2, 0] # key is a tuple of (slice, int)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [0.0, 0.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0, 0:2] # key is a tuple of (int, slice)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [0.0, 0.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0, 0] # key is a tuple of (int, int)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; b = nc.Matrix(1, 3) # b is a 1D matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; b[0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; b[0:2] # Number of rows/cols does not matter now. You are slicing it as if it were a list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [0.0, 0.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; b[0:1, 0:1] # This is invalid!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Traceback (most recent call last):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TypeError: 1D matrices only support single slice!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>This function returns a single number if the resulting slice is 1 by 1, otherwise it returns a new matrix that shares its data with its parent matrix. Here are more examples.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CS61C Fall 2020 Project 4: numc imported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a = nc.Matrix(3, 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0][1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0:1, 0:1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>When the target matrix is 1D, then it does not matter whether it has 0 row or 0 column when you are indexing it. If <code>key</code> is an integer, then <code>mat[key]</code> should return the <code>key</code>th element of the matrix. If <code>key</code> is a single slice with <code>start</code> and <code>stop</code>, then <code>mat[start:stop]</code> should return another 1D matrix with <code>stop - start</code> elements. For example</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CS61C Fall 2020 Project 4: numc imported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a = nc.Matrix(3, 1, [1, 2, 3])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a[0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; b = nc.Matrix(1, 3, [1, 2, 3])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; b[0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a[1:3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2.0, 3.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; b[1:3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2.0, 3.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Throwing errors:</p><ul><li><p>If matrix is 2D, <code>TypeError</code> if <code>key</code> is not an integer, a slice, or a length-2 tuple of slices/ints. If matrix is 1D, <code>TypeError</code> if <code>key</code> is not an integer or a slice.</p></li><li><p><code>ValueError</code> if <code>key</code> is a slice or a tuple that has one or more slices, and that at least one of these slices has step size not equal to 1, or if the length of slice is &lt; 1. Here we provide an example for each error case to help you better understand them.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CS61C Fall 2020 Project 4: numc imported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a = nc.Matrix(4, 4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0:4:2] # Step size != 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Traceback (most recent call last):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ValueError: Slice info not valid!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0:0] # Slice has length &lt; 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Traceback (most recent call last):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ValueError: Slice info not valid!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><code>IndexError</code> if <code>key</code> is an integer but is out of range, or if <code>key</code> is a tuple with at least one integer in it, and the integer is out of range.</p></li></ul></li></ul></li><li><strong><code>static int Matrix61c_set_subscript(Matrix61c *self, PyObject *key, PyObject *v)</code></strong><ul><li><p>This function takes in a <code>numc</code> matrix, the key <code>key</code> to index into the matrix, and the value <code>v</code> to which to set the new slice. Again, the key could either be an integer, a single slice, or a tuple of two slices/ints. If the resulting slice after indexing is 1 by 1, then <code>v</code> should be an integer or a float. If it is an 1D matrix (1 by n or n by 1), then <code>v</code> should be a list of numbers, and each number can either be int or float, and the length of the list should be the same as the number of elements of this slice. If it is 2D, then <code>v</code> should be a 2D list where the ith element of this list is a 1D list of integers/floats to set the ith row of the slice. Below we provide an example for each case.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CS61C Fall 2020 Project 4: numc imported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a = nc.Matrix(3, 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0:1, 0:1] = 0.0 # Resulting slice is 1 by 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[:, 0] = [1, 1, 1] # Resulting slice is 1D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[1.0, 0.0, 0.0], [1.0, 0.0, 0.0], [1.0, 0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0, :] = [2, 2, 2] # Resulting slice is 1D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[2.0, 2.0, 2.0], [1.0, 0.0, 0.0], [1.0, 0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a[0:2, 0:2] = [[1, 2], [3, 4]] # Resulting slice is 2D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[1.0, 2.0, 2.0], [3.0, 4.0, 0.0], [1.0, 0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Throwing errors: <strong>In addition to the errors you have to throw for invalid key types/values (see <code>Matrix61c_subscript</code>)</strong>, you will also have to throw</p><ul><li><code>TypeError</code> if<ul><li>Resulting slice is 1 by 1, but <code>v</code> is not a float or int.</li><li>Resulting slice is not 1 by 1, but <code>v</code> is not a list.</li></ul></li><li><code>ValueError</code> if<ul><li>Resulting slice is 1D, but <code>v</code> has the wrong length, or if any element of <code>v</code> is not a float or int.</li><li>Resulting slice is 2D, but <code>v</code> has the wrong length, or if any element of <code>v</code> has the wrong length, or if any element of an element of <code>v</code> is not a float or int.</li></ul></li></ul></li></ul></li></ul><p>We suggest that you use <code>PySlice_GetIndicesEx</code> to extract the slices’ information. Here is the <a href="https://docs.python.org/3.6/c-api/slice.html" target="_blank" rel="noopener noreferrer">link</a> to the documentation of this function. Moreover, you should note that slices share data with their original matrix. This means that by changing values of the slices, the values of the original matrices should also change. Here are some examples.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CS61C Fall 2020 Project 4: numc imported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a = nc.Matrix(2, 2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a[0:1, 0:1] = 1.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[1.0, 0.0], [0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a[1] = [2, 2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[1.0, 0.0], [2.0, 2.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; b = a[1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; b[1] = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[1.0, 0.0], [2.0, 3.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Also note that it is possible to have nested slices, and changing the nested slices’ data should also change the original matrices’ data. For example,</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; import numc as nc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CS61C Fall 2020 Project 4: numc imported!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a = nc.Matrix(4, 4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; b = a[0:3, 0:3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; c = b[1:3, 1:3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; c[0] = [2, 2] # Changing c should change both a and b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[2.0, 2.0], [0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[0.0, 0.0, 0.0], [0.0, 2.0, 2.0], [0.0, 0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[0.0, 0.0, 0.0, 0.0], [0.0, 2.0, 2.0, 0.0], [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, if you didn’t fully understand what the <code>deallocate</code> function is supposed to do when you were implementation task 1, it is now a good time to go <a href="#deallocate">back</a> and take another look at it.</p><p>Again, make sure to set the <code>shape</code> attribute of the new slice that you make!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">​</a></h3><p>Refer to <a href="#unittest">this section</a> for instructions on how to test your program.</p><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-debug">How to Debug<a href="#how-to-debug" class="hash-link" aria-label="Direct link to How to Debug" title="Direct link to How to Debug">​</a></h3><p>To debug the Python-C interface, we suggest that you write your test files in Python, and use gdb or both gdb and pdb to debug.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-only-gdb">Using only gdb<a href="#using-only-gdb" class="hash-link" aria-label="Direct link to Using only gdb" title="Direct link to Using only gdb">​</a></h4><p>You don’t have to use pdb if you do not wish to set breakpoints in your Python test file. Open your terminal and run</p><p>Then you can set breakpoints in your C files using the normal gdb commands. gdb will warn you with</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">No source file named {your c file}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Make breakpoint pending on future shared library load? (y or [n])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Press ‘y’ (without the quotes) to proceed.</p><p>After that, you can run <code>run {your python test file name}.py</code> in gdb, and gdb will break at the breakpoints that you just set.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-both-gdb-and-pdb">Using both gdb and pdb<a href="#using-both-gdb-and-pdb" class="hash-link" aria-label="Direct link to Using both gdb and pdb" title="Direct link to Using both gdb and pdb">​</a></h4><p>You will have to use pdb if you wish to set breakpoints in your Python file. Here’s how it works. Start gdb by running</p><p>and set your breakpoints in C (see <a href="#only-gdb">previous section</a>). Then you will need to run in gdb</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">run -m pdb {your python file}.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After this step, you can set breakpoints in your Python file using gdb syntax (for example, <code>b test.py:5</code>). With this approach, your debugger will switch between pdb and gdb depending on whether you are stepping through a Python file or a C file.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-speeding-up-matrix-operations">Task 4: Speeding up matrix operations<a href="#task-4-speeding-up-matrix-operations" class="hash-link" aria-label="Direct link to Task 4: Speeding up matrix operations" title="Direct link to Task 4: Speeding up matrix operations">​</a></h2><p>Now that you have completed the three steps above and successfully installed your naive version of <code>numc</code>, it’s time to speed up your matrix functions in <strong><code>matrix.c</code></strong>! <strong>As of now, we are only testing PERFORMANCE on non-slice matrices. Although we ARE testing the correctness of matrix operations on matrix slices.</strong> Below we outline some steps for boosting performance.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-unrolling-and-other-optimizations">Step 1: Unrolling and Other Optimizations<a href="#step-1-unrolling-and-other-optimizations" class="hash-link" aria-label="Direct link to Step 1: Unrolling and Other Optimizations" title="Direct link to Step 1: Unrolling and Other Optimizations">​</a></h3><p>You should first try to speed up the computation by trying to apply conventional code optimizations (i.e. without using SSE or OpenMP). While we won’t tell you the exact steps, here are some hints that should help you get started:</p><ol><li>Function calls are expensive since they involve setting up a stack frame and jumping to a different part of code. See if there are any functions that are frequently called that don’t necessarily need to be.</li><li>Are there any places where you could do manual loop unrolling?</li><li>Is there any unnecessary computation being done?</li></ol><p>Note that the above hints relate to general optimization practices. You do not necessarily need to do all of these to achieve a good speedup.</p><p>Once you have improved performance using these optimizations, you can start applying vectorization and parallelization to make the program even faster. Note that you have considerable freedom to apply any of these optimizations, and there is more than one correct solution. Try to experiment with different approaches and see which one gives you the best performance.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-simd-instructions">Step 2: SIMD Instructions<a href="#step-2-simd-instructions" class="hash-link" aria-label="Direct link to Step 2: SIMD Instructions" title="Direct link to Step 2: SIMD Instructions">​</a></h3><p>From lectures, you learned how to apply SIMD instructions to improve performance. The processors in the hive machines support the Intel AVX extensions, which allow you to do SIMD operations on 256 bit values (not just 128 bit, as we have seen in the lab). You should use these extensions to perform four operations in parallel (since all floating point numbers are doubles, which are 64 bit in size). If you are unfamiliar with SIMD instructions, lab 9 can be a good warmup.</p><p>As a reminder, you can use the <a href="https://software.intel.com/sites/landingpage/IntrinsicsGuide/" target="_blank" rel="noopener noreferrer">Intel Intrinsics Guide</a> as a reference to look up the relevant instructions. You will have to use the <code>__m256d</code> type to hold 4 doubles in a YMM register, and then use the <code>_mm256_*</code> intrinsics to operate on them.</p><p>Here is a list of AVX instructions that you may find helpful, although you are also allowed to use other AVX instructions not on the list.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">void _mm256_storeu_pd (double * mem_addr, __m256d a)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_set1_pd (double a)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_set_pd (double e3, double e2, double e1, double e0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_loadu_pd (double const * mem_addr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_add_pd (__m256d a, __m256d b)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_sub_pd (__m256d a, __m256d b)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_fmadd_pd (__m256d a, __m256d b, __m256d c)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_mul_pd (__m256d a, __m256d b)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_cmp_pd (__m256d a, __m256d b, const int imm8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_and_pd (__m256d a, __m256d b)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__m256d _mm256_max_pd (__m256d a, __m256d b)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-openmp">Step 3: OpenMP<a href="#step-3-openmp" class="hash-link" aria-label="Direct link to Step 3: OpenMP" title="Direct link to Step 3: OpenMP">​</a></h3><p>Finally you should use OpenMP to parallelize computation. Note that you will need to make sure that none of the different threads overwrites each others’ data. Just adding a <code>#pragma omp parallel for</code> may cause errors.</p><p>Note that the Hive machines have 4 cores with two hyperthreads each. This means that you should expect a speed-up of 4-8x (note that hyperthreads mean that two different threads execute on the same physical core at the same time; they will therefore compete for processor resources, and as a result, you will not get the same performance as if you were running on two completely separate cores).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5-tell-us-what-you-did">Task 5: Tell us what you did!<a href="#task-5-tell-us-what-you-did" class="hash-link" aria-label="Direct link to Task 5: Tell us what you did!" title="Direct link to Task 5: Tell us what you did!">​</a></h2><p>Write up what you did in your README.md! While we do not have a specific format we are looking for, you should discuss what you did as a whole, the different python functions you implemented, what performance improvements you had, what were you surprised about, etc. More specifically, we want you to document your <code>numc</code> module and provide example usages. <strong>We expect a minimum of 6000 characters.</strong> This may seem like a lot, but documenting you’ve done actually takes quite a number of words, so just sufficiently covering all the things you did in the project should get you to the word count requirement. Again, failure to complete this task may result in negative points, so make sure you do it or you will lose points!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing-1">Testing<a href="#testing-1" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">​</a></h2><p><strong>We will not be grading your tests but we will NOT help you debug unless you have written a test which shows how your code is failing. This means just using the autograder to figure out your issues will not be acceptable for office hours.</strong></p><p>We use <strong><code>unittest</code></strong> as the framework for testing and have provided a <code>unittests</code> folder that contains this framework for testing your python module. You should be familiar with <code>unittest</code> by now as you have had experience with it in project 2. <strong>Here is the official documentation for the standard <a href="https://docs.python.org/3.6/library/unittest.html" target="_blank" rel="noopener noreferrer">Python unittest library</a>.</strong> <code>unittests/unittests.py</code> contains all the skeleton code for both correctness and performance tests, and <code>unittests/utils.py</code> has all the functions that you might need in order to write tests. We have provided some sample tests for you, but it is up to you to design and code up the tests. We will not be grading your tests.</p><p>As mentioned in <a href="#tip">Tips and Guidelines</a> and <a href="#getting-started">Getting Started</a>, we have installed the naive solution which we will be comparing against on hive! The python package is called <code>dumbpy</code> and you can import it like any other python library (so long as you are on hive)! Please note we will not be distributing this binary which means you must work on hive if you want to test with it. You should use this and the <strong><code>time</code></strong> package to determine how much you sped up your code.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="functions-in-unittestsutilspy">Functions in <code>unittests/utils.py</code><a href="#functions-in-unittestsutilspy" class="hash-link" aria-label="Direct link to functions-in-unittestsutilspy" title="Direct link to functions-in-unittestsutilspy">​</a></h3><ul><li><strong>`dp_nc_matrix(*args, </strong>kwargs)`**<ul><li><p>This function will return a <code>dumbpy</code> matrix and a <code>numc</code> matrix that are identical. <code>*args</code> and <code>**kwargs</code> will be used as the arguments to instantiate both matrices in the exact same format as you would instantiate a <code>numc.Matrix</code>. We provide some examples below.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; dp_mat, nc_mat = dp_nc_matrix(2, 2, 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; dp_mat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[0.0, 0.0], [0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; nc_mat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[0.0, 0.0], [0.0, 0.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; dp_mat, nc_mat = dp_nc_matrix([[1, 2, 3]])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; dp_mat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[1.0, 2.0, 3.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; nc_mat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[1.0, 2.0, 3.0]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><strong><code>rand_dp_nc_matrix(rows, cols, seed=0)</code></strong><ul><li><p>This function will instantiate a random <code>dumbpy</code> matrix and a random <code>numc</code> matrix with <code>seed</code>. The two matrices are identical with <code>rows</code> rows and <code>cols</code>. <code>seed</code> is defaulted to 0.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt;&gt; dp_mat, nc_mat = rand_dp_nc_matrix(2, 2, seed=5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; dp_mat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[0.27474559623503386, 0.046467764790387715], [0.9927552244592249, 0.08003044504673706]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &gt;&gt;&gt; nc_mat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [[0.27474559623503386, 0.046467764790387715], [0.9927552244592249, 0.08003044504673706]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><strong><code>cmp_dp_nc_matrix(dp_mat: dp.Matrix, nc_mat: nc.Matrix)</code></strong><ul><li>This function will return True if <code>dp_mat</code> has the same size of <code>nc_mat</code> and all corresponding elements are equal (within a margin of error).</li></ul></li><li><strong><code>compute(dp_mat_lst: List[Union[dp.Matrix, int]], nc_mat_lst: List[Union[nc.Matrix, int]], op: str)</code></strong><ul><li>This function takes in a list of dumbpy matrices and a list of numc matrices, then applies the specified operation <code>op</code> on these matrices. Note that <code>op</code> is a string. <code>&quot;add&quot;</code>, <code>&quot;sub&quot;</code>, <code>&quot;mul&quot;</code>, <code>&quot;neg&quot;</code>, <code>&quot;abs&quot;</code>, and <code>&quot;pow&quot;</code> correspond to the operations <code>+</code>, <code>-</code>(subtraction), <code>*</code>, <code>-</code>(negation), and <code>abs</code>, respectively. This function will return whether the computed <code>dumbpy</code> matrix is equal to the computed <code>numc</code> matrix, as well as the speedup for this specific computation.<ul><li>For unary operations like <code>&quot;neg&quot;</code> and <code>&quot;abs&quot;</code>, each matrix list must only contain 1 matrix. For the binary operations, they must contain more than 1 matrix.</li><li>Note that to compute <code>&quot;pow&quot;</code>, <code>dp_mat_lst</code> and <code>nc_mat_lst</code> should look like something like <code>[Matrix(2, 2), 1]</code>.</li><li>You can also do chained operations like <code>compute([a, b, c], [d, e, f], &quot;add&quot;)</code> where <code>a, b, c, d, e, f</code> are matrices, and the function will compute <code>a + b + c</code> and <code>d + e + f</code>.</li></ul></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="more-about-unittest">More about <code>unittest</code><a href="#more-about-unittest" class="hash-link" aria-label="Direct link to more-about-unittest" title="Direct link to more-about-unittest">​</a></h3><ul><li><p>Running</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  $ python -m unittest unittests.py -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will run all tests in <code>unittests.py</code>.</p></li><li><p>If you only want to run tests of one particular class, run</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  $ python -m unittest unittests.{classname} -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For example, running</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  $ python -m unittest unittests.TestAdd -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will only run the tests under the <code>TestAdd</code> class.</p></li><li><p>If you want to run a specific test under a specific class, run</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  $ python -m unittest unittests.{classname}.{testname} -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For example, running</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  $ python -m unittest unittests.TestAdd.test_small_add -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will only run the <code>test_small_add</code> test.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="frequently-asked-questions">Frequently Asked Questions<a href="#frequently-asked-questions" class="hash-link" aria-label="Direct link to Frequently Asked Questions" title="Direct link to Frequently Asked Questions">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1">​</a></h3><ul><li><p><strong>Q 1.1</strong>: Will we be graded on what types of errors we threw? Or do we just have to throw some error?<br>
<strong>A 1.1</strong>: Yes we expect you to throw the correct error types. We do not care about the error messages tho.</p></li><li><p><strong>Q 1.2</strong>: I’m getting this when I run <code>make test</code>, what is happening?</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  rm -f test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gcc -g -Wall -std=c99 -fopenmp -mavx -mfma -pthread -O3 mat_test.c matrix.c -o test -fopenmp -L/home/ff/cs61c/cunit/install/lib -I/home/ff/cs61c/cunit/install/include -lcunit -I/usr/include/python3.6 -lpython3.6m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ./test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       CUnit - A unit testing framework for C - Version 2.1-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       http://cunit.sourceforge.net/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Makefile:25: recipe for target &#x27;test&#x27; failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  make: *** [test] Illegal instruction (core dumped)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>A 1.2</strong>: This means your code segfaulted before any assert statements was reached and none of the tests passed. Use gdb to locate your bug.</p></li></ul><ul><li><strong>Q 1.3</strong>: Do we assume rows and cols start at 1 or 0?<br><strong>A 1.3</strong>: They are both zero-indexed.</li><li><strong>Q 1.4</strong>: Do our functions need to support self-referential operations? For example, <code>mul_matrix(mat, mat, mat)</code>.<br><strong>A 1.4</strong>: No.</li><li><strong>Q 1.5</strong>: Is it reasonable to run valgrind on <code>./test</code>? <strong>A 1.5</strong>: You can try, but would not recommend. Setting up valgrind for C-Python interface can be difficult.</li><li><strong>Q 1.6</strong>: When we throw an error, is it just a fprintf call to stderr?<br><strong>A 1.6</strong>: Nope, you should throw errors in a python context. i.e., when your python code calls this underlying C function, it should error. Take a look at the Python/C API’s reference manual for <a href="https://docs.python.org/3.6/c-api/exceptions.html" target="_blank" rel="noopener noreferrer">exception handling</a>.</li><li><strong>Q 1.7</strong>: Can we make a slice on slice? for example, <code>mat1 = [[1,2,3],[4,5,6]]</code>, <code>mat2 = mat1[0]</code>. Can we do <code>mat3 = mat2[0]</code>?<br><strong>A 1.7</strong>: You can make a slice on a 2D slice, but a “slice” on a 1D slice is just a number and is pass by value. In this case, <code>mat3</code> will just be a number and changing its value will not change <code>mat2</code>.</li><li><strong>Q 1.8</strong>: Does our solution need to exactly match the reference?<br><strong>A 1.8</strong>: No, we allow an error margin of 1e-6.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">​</a></h3><ul><li><strong>Q 2.1</strong>: I’m getting undefined symbols upon import (for example, <code>undefined symbol: allocate_matrix_ref</code>). What is happening?<br><strong>A 2.1</strong>: Think about what files your module needs, especially where the undefined symbol is located.</li><li><strong>Q 2.2</strong>: The values in my matrices change after I print their slices.<br><strong>A 2.2</strong>: This is likely a memory leak. Double check your <code>deallocate_matrix</code> implementation. What happens when you call <code>print(mat[0])</code> is that it will create a slice, then immediately deallocate it after this line.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Direct link to Task 3" title="Direct link to Task 3">​</a></h3><ul><li><strong>Q 3.1</strong>: Getting <code>&lt;class &#x27;AttributeError&#x27;&gt; -- shape</code>.<br><strong>A 3.1</strong>: Make sure the relevant method in numc.c is setting <code>mat-&gt;shape</code></li><li><strong>Q 3.2</strong>: Getting <code>&lt;class &#x27;SystemError&#x27;&gt; -- &lt;built-in method set of numc.Matrix object at 0x7f175faffef0&gt; returned NULL without setting an error!</code><br><strong>A 3.2</strong>: You need to throw an error before returning <code>NULL</code> in any interface function.</li><li><strong>Q 3.3</strong>: <code>UnicodeDecodeError: ‘utf-8’ codec can&#x27;t decode byte 0x89 in position 5: invalid start byte</code> upon import. What’s wrong?<br><strong>A 3.3</strong>: <code>{NULL, NULL, 0, NULL}</code> from starter code must be last element of <code>Matrix61c_methods</code>, so make sure you don’t accidentally remove that!</li><li><strong>Q 3.4</strong>: Are we allowed to call methods we wrote in <strong><code>matrix.c</code></strong>?<br><strong>A 3.4</strong>: Yes please do!</li><li><strong>Q 3.5</strong>: How do we know what gets passed into <code>PyObject* args</code>?<br><strong>A 3.5</strong>: Read the <a href="https://docs.python.org/3.6/c-api/" target="_blank" rel="noopener noreferrer">official documentation</a>! (You can also take a look at the starter code for examples.)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Direct link to Task 4" title="Direct link to Task 4">​</a></h3><ul><li><p><strong>Q 4.1</strong>: <code>#pragma omp parallel for</code> above a simple for loop slows down my add<!-- -->_<!-- -->matrix drastically?<br>
<strong>A 4.1</strong>: You need big matrices to actually see the effect of speedup (something around 1000 <!-- -->*<!-- --> 1000).</p></li><li><p><strong>Q 4.2</strong>: I’m getting <code>warning: ignoring #pragma omp parallel [-Wunknown-pragmas]</code> but I have not changed the Makefile?<br>
<strong>A 4.2</strong>: It might be your task 2. Take a look at the compiler and linker flags we provided you.</p></li><li><p><strong>Q 5.1</strong>: I’m passing my local correctness tests but failing autograder. What might be the case?<br>
<strong>A 5.1</strong>: Here are some common sources of bugs. 1. Make sure you test your matrix operations on non-integer floating point values (such as 1.2, 1.3). In the past semester, some students’ code was only able to generate correct results when every floating point value in their matrices were integer-valued floating points (such as 1.0, 2.0). 2. Make sure you are setting the <code>shape</code> attribute of every returned matrix! 3. Please do NOT modify anything related to generating random matrices! Do NOT try to speed them up! We use those to generate matrices to test on the autograder. We don’t include the time for generating matrices when testing for performance.</p></li><li><p><strong>Q 5.2</strong>: Performance tests are failing but correctness tests all pass.<br>
<strong>A 5.2</strong>: Our performance tests test on much larger matrices than the correctness tests, so make sure you handle those cases correctly!</p></li><li><p><strong>Q 5.3</strong>: Failing tests that are related to throwing errors.<br>
<strong>A 5.3</strong>: Make sure you are throwing the correct type of error, not just any error.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="grading">Grading<a href="#grading" class="hash-link" aria-label="Direct link to Grading" title="Direct link to Grading">​</a></h2><p>The grading breakdown for Project 4 is as follows:</p><ul><li>Correctness: 55%</li><li>Speedup: 40%<ul><li>Multiplication: 20%</li><li>Power: 25%</li><li>Simple: 12.5%</li><li>Comprehensive: 42.5%</li></ul></li><li>README.md: 5%</li></ul><p>Here are the graphs for the speedup tests. The x-axis is your speedup times and the y-axis indicates what percentage of that test’s total score you will receive.</p><p>Minimum speedup for 100% on each test:</p><ul><li>Multiplication: 95x</li><li>Power: 1700x</li><li>Simple: 4.9x</li><li>Comprehensive: 98x</li></ul><p>Since we are running your submissions on hive, albeit reserved, speedup times may fluctuate a bit. You should try to go above the speedup value as we will rerun the ag after the deadline and your speedup may go up or down. We will not rerun submissions if they went down unless we made another change to the autograder.</p><p>We will only be using your <code>matrix.h</code>, <code>matrix.c</code>, <code>numc.c</code>, <code>setup.py</code>, and <code>README.md</code> for grading. Gradescope only shows you all the core correctness tests that are needed to run performance tests. Other tests will stay hidden until the late due date.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance-contest">Performance Contest<a href="#performance-contest" class="hash-link" aria-label="Direct link to Performance Contest" title="Direct link to Performance Contest">​</a></h2><p>We are doing a performance contest for Project 4 this year! The method in which your Project 4 submission will be scored is based on the performance on your <code>numc</code> module. <strong>Note that while all submitted designs will show a score, only submissions that pass 100% of visible and hidden tests will be eligible for the contest.</strong> This means that it is in your best interest to test throughly!</p><p>We are still determining which benchmark(s) will be used in evaluating your solution and will update the spec once we have finalized that.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/curriculum-resource/cs61c/projects/proj3"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Project3</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/curriculum-resource/18-01"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">MIT 18.01 | Fall 2006</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#tips-and-guidelines" class="table-of-contents__link toc-highlight">Tips and Guidelines</a></li><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting Started</a></li><li><a href="#task-1-matrix-functions-in-c" class="table-of-contents__link toc-highlight">Task 1: Matrix functions in C</a><ul><li><a href="#testing-for-correctness" class="table-of-contents__link toc-highlight">Testing for Correctness</a></li></ul></li><li><a href="#task-2-writing-the-setup-file" class="table-of-contents__link toc-highlight">Task 2: Writing the setup file</a></li><li><a href="#task-3-writing-the-python-c-interface" class="table-of-contents__link toc-highlight">Task 3: Writing the Python-C interface</a><ul><li><a href="#info-importing-numcmatrix" class="table-of-contents__link toc-highlight">Info: Importing <code>numc.Matrix</code></a></li><li><a href="#info-numcmatrix-initialization" class="table-of-contents__link toc-highlight">Info: <code>numc.Matrix</code> initialization</a></li><li><a href="#info-instance-attributes" class="table-of-contents__link toc-highlight">Info: instance attributes</a></li><li><a href="#info-pythonc-api-reference" class="table-of-contents__link toc-highlight">Info: Python/C API Reference</a></li><li><a href="#quick-overview-of-numc-skeleton-code" class="table-of-contents__link toc-highlight">Quick Overview of <code>numc</code> skeleton code</a></li><li><a href="#useful-functions" class="table-of-contents__link toc-highlight">Useful functions:</a></li><li><a href="#number-methods" class="table-of-contents__link toc-highlight">Number Methods</a></li><li><a href="#instance-methods" class="table-of-contents__link toc-highlight">Instance Methods</a></li><li><a href="#indexing" class="table-of-contents__link toc-highlight">Indexing</a></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a></li><li><a href="#how-to-debug" class="table-of-contents__link toc-highlight">How to Debug</a></li></ul></li><li><a href="#task-4-speeding-up-matrix-operations" class="table-of-contents__link toc-highlight">Task 4: Speeding up matrix operations</a><ul><li><a href="#step-1-unrolling-and-other-optimizations" class="table-of-contents__link toc-highlight">Step 1: Unrolling and Other Optimizations</a></li><li><a href="#step-2-simd-instructions" class="table-of-contents__link toc-highlight">Step 2: SIMD Instructions</a></li><li><a href="#step-3-openmp" class="table-of-contents__link toc-highlight">Step 3: OpenMP</a></li></ul></li><li><a href="#task-5-tell-us-what-you-did" class="table-of-contents__link toc-highlight">Task 5: Tell us what you did!</a></li><li><a href="#testing-1" class="table-of-contents__link toc-highlight">Testing</a><ul><li><a href="#functions-in-unittestsutilspy" class="table-of-contents__link toc-highlight">Functions in <code>unittests/utils.py</code></a></li><li><a href="#more-about-unittest" class="table-of-contents__link toc-highlight">More about <code>unittest</code></a></li></ul></li><li><a href="#frequently-asked-questions" class="table-of-contents__link toc-highlight">Frequently Asked Questions</a><ul><li><a href="#task-1" class="table-of-contents__link toc-highlight">Task 1</a></li><li><a href="#task-2" class="table-of-contents__link toc-highlight">Task 2</a></li><li><a href="#task-3" class="table-of-contents__link toc-highlight">Task 3</a></li><li><a href="#task-4" class="table-of-contents__link toc-highlight">Task 4</a></li></ul></li><li><a href="#grading" class="table-of-contents__link toc-highlight">Grading</a></li><li><a href="#performance-contest" class="table-of-contents__link toc-highlight">Performance Contest</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">CS学习社区</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">路线图</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyleft © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.85a3caca.js"></script>
<script src="/assets/js/main.8c32c80d.js"></script>
</body>
</html>