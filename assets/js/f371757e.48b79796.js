"use strict";(self.webpackChunklearncs_set=self.webpackChunklearncs_set||[]).push([[7033],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=s(n),c=r,k=m["".concat(p,".").concat(c)]||m[c]||d[c]||i;return n?a.createElement(k,o(o({ref:t},u),{},{components:n})):a.createElement(k,o({ref:t},u))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[m]="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},81628:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));const i={title:"Lab 11 Programs as Data, Macros"},o="Lab 11: Programs as Data, Macros",l={unversionedId:"curriculum-resource/cs61a/lab/lab11",id:"curriculum-resource/cs61a/lab/lab11",title:"Lab 11 Programs as Data, Macros",description:"Due by 11:59pm on Wednesday, April 17.",source:"@site/docs/curriculum-resource/cs61a/lab/lab11.md",sourceDirName:"curriculum-resource/cs61a/lab",slug:"/curriculum-resource/cs61a/lab/lab11",permalink:"/docs/curriculum-resource/cs61a/lab/lab11",draft:!1,tags:[],version:"current",frontMatter:{title:"Lab 11 Programs as Data, Macros"},sidebar:"tutorialSidebar",previous:{title:"Lab 10 Interpreters",permalink:"/docs/curriculum-resource/cs61a/lab/lab10"},next:{title:"Lab 12 SQL",permalink:"/docs/curriculum-resource/cs61a/lab/lab12"}},p={},s=[{value:"Starter Files",id:"starter-files",level:2},{value:"Required Questions",id:"required-questions",level:2},{value:"Getting Started Videos",id:"getting-started-videos",level:2},{value:"Quasiquotation",id:"quasiquotation",level:2},{value:"Q1: WWSD: Quasiquote",id:"q1-wwsd-quasiquote",level:3},{value:"Programs as Data",id:"programs-as-data",level:2},{value:"Q2: If Program",id:"q2-if-program",level:3},{value:"Q3: Exponential Powers",id:"q3-exponential-powers",level:3},{value:"Macros",id:"macros",level:2},{value:"Q4: Repeat",id:"q4-repeat",level:3}],u={toc:s},m="wrapper";function d(e){let{components:t,...i}=e;return(0,r.kt)(m,(0,a.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"lab-11-programs-as-data-macros"},"Lab 11: Programs as Data, Macros"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Due by 11:59pm on Wednesday, April 17.")),(0,r.kt)("h2",{id:"starter-files"},"Starter Files"),(0,r.kt)("p",null,"Download ",(0,r.kt)("a",{target:"_blank",href:n(92998).Z},"lab11.zip"),". Inside the archive, you will find starter files for the questions in this lab, along with a copy of the ",(0,r.kt)("a",{parentName:"p",href:"https://cs61a.org//lab/lab11/ok"},"Ok")," autograder."),(0,r.kt)("h2",{id:"required-questions"},"Required Questions"),(0,r.kt)("h2",{id:"getting-started-videos"},"Getting Started Videos"),(0,r.kt)("p",null,"These videos may provide some helpful direction for tackling the coding problems on this assignment."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"To see these videos, you should be logged into your berkeley.edu email.")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://youtu.be/playlist?list=PLx38hZJ5RLZedEBGt6V6vpbXpA8ItUVgy"},"YouTube link")),(0,r.kt)("h2",{id:"quasiquotation"},"Quasiquotation"),(0,r.kt)("p",null,"Consult the drop-down if you need a refresher on quasiquotation. It's okay to skip directly to the questions and refer back here should you get stuck."),(0,r.kt)("p",null,"The normal quote ",(0,r.kt)("inlineCode",{parentName:"p"},"'")," and the quasiquote ",(0,r.kt)("inlineCode",{parentName:"p"},"`")," are both valid ways to quote an expression. However, the quasiquoted expression can be ",(0,r.kt)("em",{parentName:"p"},"unquoted"),' with the "unquote" ',(0,r.kt)("inlineCode",{parentName:"p"},",")," (represented by a comma). When a term in a quasiquoted expression is ",(0,r.kt)("em",{parentName:"p"},"unquoted"),", the unquoted term is ",(0,r.kt)("em",{parentName:"p"},"evaluated"),", instead of being taken as literal text. This mechanism is somewhat akin to using ",(0,r.kt)("em",{parentName:"p"},"f-strings")," in Python, where expressions inside ",(0,r.kt)("inlineCode",{parentName:"p"},"{}")," are evaluated and inserted into the string."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"scm> (define a 5)\na\nscm> (define b 3)\nb\nscm> `(* a b)  ; Quasiquoted expression\n(* a b)\nscm> `(* a ,b)  ; Unquoted b, which evaluates to 3\n(* a 3)\nscm> `(* ,(+ a b) b)  ; Unquoted (+ a b), which evaluates to 8\n(* 8 b)\n")),(0,r.kt)("h3",{id:"q1-wwsd-quasiquote"},"Q1: WWSD: Quasiquote"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},'Use Ok to test your knowledge with the following "What Would Scheme Display?" questions:'),(0,r.kt)("pre",{parentName:"blockquote"},(0,r.kt)("code",{parentName:"pre"},"python3 ok -q wwsd-quasiquote -u\n"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"scm> '(1 x 3)\n\nscm> (define x 2)\n\nscm> `(1 x 3)\n\nscm> `(1 ,x 3)\n\nscm> `(1 x ,3)\n\nscm> `(1 (,x) 3)\n\nscm> `(1 ,(+ x 2) 3)\n\nscm> (define y 3)\n\nscm> `(x ,(* y x) y)\n\nscm> `(1 ,(cons x (list y 4)) 5)\n")),(0,r.kt)("h2",{id:"programs-as-data"},"Programs as Data"),(0,r.kt)("p",null,"Consult the drop-down if you need a refresher on Programs as Data. It's okay to skip directly to the questions and refer back here should you get stuck."),(0,r.kt)("p",null,"All Scheme programs are made up of expressions. There are two types of expressions: ",(0,r.kt)("em",{parentName:"p"},"primitive")," (a.k.a ",(0,r.kt)("em",{parentName:"p"},"atomic"),") expressions and ",(0,r.kt)("em",{parentName:"p"},"combinations"),". Here are some examples of each:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Primitive/atomic")," expression: ",(0,r.kt)("inlineCode",{parentName:"li"},"#f"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"1.7"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"+")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Combinations"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"(factorial 10)"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"(/ 8 3)"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"(not #f)"))),(0,r.kt)("p",null,"Scheme represents combinations as a Scheme list. Therefore, a combination can be constructed through list manipulation."),(0,r.kt)("p",null,"For example, the expression ",(0,r.kt)("inlineCode",{parentName:"p"},"(list '+ 2 2)")," evaluates to the list ",(0,r.kt)("inlineCode",{parentName:"p"},"(+ 2 2)"),", which is also an expression. If we then call ",(0,r.kt)("inlineCode",{parentName:"p"},"eval")," on this list, it will evaluate to ",(0,r.kt)("inlineCode",{parentName:"p"},"4"),". The ",(0,r.kt)("inlineCode",{parentName:"p"},"eval")," procedure takes in one argument ",(0,r.kt)("inlineCode",{parentName:"p"},"expr")," and evaluates ",(0,r.kt)("inlineCode",{parentName:"p"},"expr")," in the current environment."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"scm> (define expr (list '+ 2 2))\nexpr\nscm> expr\n(+ 2 2)\nscm> (eval expr)\n4\n")),(0,r.kt)("p",null,"Additionally, ",(0,r.kt)("em",{parentName:"p"},"quasiquotation")," is very helpful for building procedures that create expressions. Take a look at the following ",(0,r.kt)("inlineCode",{parentName:"p"},"add-program"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"scm> (define (add-program x y)\n...>     `(+ ,x ,y))\nadd-program\nscm> (add-program 3 6)\n(+ 3 6)\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"add-program")," takes in two inputs ",(0,r.kt)("inlineCode",{parentName:"p"},"x")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"y")," and returns an expression that, if evaluated, evaluates to the result of adding ",(0,r.kt)("inlineCode",{parentName:"p"},"x")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"y")," together. Within ",(0,r.kt)("inlineCode",{parentName:"p"},"add-program"),", we use a quasiquote to build the addition expression ",(0,r.kt)("inlineCode",{parentName:"p"},"(+ ...)"),", and we unquote ",(0,r.kt)("inlineCode",{parentName:"p"},"x")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"y")," to get their evaluated values in the addition expression."),(0,r.kt)("h3",{id:"q2-if-program"},"Q2: If Program"),(0,r.kt)("p",null,"In Scheme, the ",(0,r.kt)("inlineCode",{parentName:"p"},"if")," special form allows us to evaluate one of two expressions based on a predicate. Write a program ",(0,r.kt)("inlineCode",{parentName:"p"},"if-program")," that takes in the following parameters:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"predicate")," : a quoted expression which will evaluate to the condition in our ",(0,r.kt)("inlineCode",{parentName:"li"},"if"),"-","expression"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"if-true")," : a quoted expression which will evaluate to the value we want to return if ",(0,r.kt)("inlineCode",{parentName:"li"},"predicate")," evaluates to true (",(0,r.kt)("inlineCode",{parentName:"li"},"#t"),")"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"if-false")," : a quoted expression which will evaluate to the value we want to return if ",(0,r.kt)("inlineCode",{parentName:"li"},"predicate")," evaluates to false (",(0,r.kt)("inlineCode",{parentName:"li"},"#f"),")")),(0,r.kt)("p",null,"The program returns a Scheme list that represents an ",(0,r.kt)("inlineCode",{parentName:"p"},"if")," expression in the form: ",(0,r.kt)("inlineCode",{parentName:"p"},"(if <predicate> <if-true> <if-false>)"),". Evaluating this expression returns the result of evaluating this ",(0,r.kt)("inlineCode",{parentName:"p"},"if")," expression."),(0,r.kt)("p",null,"Here are some doctests to show this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"scm> (define x 1)\nscm> (if-program '(= 0 0) '(+ x 1) 'x)\n(if (= 0 0) (+ x 1) x)\nscm> (eval (if-program '(= 0 0) '(+ x 1) 'x))\n2\nscm> (if-program '(= 1 0) '(print 3) '(print 5))\n(if (= 1 0) (print 3) (print 5))\nscm> (eval (if-program '(= 1 0) '(print 3) '(print 5)))\n5\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(define (if-program condition if-true if-false)\n  'YOUR-CODE-HERE\n)\n")),(0,r.kt)("p",null,"Use Ok to test your code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"python3 ok -q if-program\n")),(0,r.kt)("h3",{id:"q3-exponential-powers"},"Q3: Exponential Powers"),(0,r.kt)("p",null,"Implement a procedure ",(0,r.kt)("inlineCode",{parentName:"p"},"(pow-expr base exp)")," that returns an expression that, when evaluated, raises the number ",(0,r.kt)("inlineCode",{parentName:"p"},"base")," to the power of the nonnegative integer ",(0,r.kt)("inlineCode",{parentName:"p"},"exp"),". The body of ",(0,r.kt)("inlineCode",{parentName:"p"},"pow-expr")," should not perform any multiplication (or exponentiation). Instead, it should just construct an expression containing only the symbols ",(0,r.kt)("inlineCode",{parentName:"p"},"square")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"*")," as well as the number ",(0,r.kt)("inlineCode",{parentName:"p"},"base")," and parentheses. The length of this expression should grow logarithmically with respect to ",(0,r.kt)("inlineCode",{parentName:"p"},"exp"),", rather than linearly."),(0,r.kt)("p",null,"Examples:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"scm> (pow-expr 2 0)\n1\nscm> (pow-expr 2 1)\n(* 2 1)\nscm> (pow-expr 2 5)\n(* 2 (square (square (* 2 1))))\nscm> (pow-expr 2 15)\n(* 2 (square (* 2 (square (* 2 (square (* 2 1)))))))\nscm> (pow-expr 2 16)\n(square (square (square (square (* 2 1)))))\nscm> (eval (pow-expr 2 16))\n65536\n")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("mdxAdmonitionTitle",{parentName:"admonition"},"[",(0,r.kt)("strong",{parentName:"mdxAdmonitionTitle"},"Hint"),"]"),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("em",{parentName:"p"},"Hint:")),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"$ x^{2y} = (x^y)^2 $")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"$ x^{2y+1} = x \\cdot (x^y)^2 $"))),(0,r.kt)("p",{parentName:"admonition"},"For example,  $ 2^{16} = (2^8)^2 $ and $ 2^{17} = 2 \\times (2^8)^2 $\nYou may use the built-in predicates ",(0,r.kt)("inlineCode",{parentName:"p"},"even?")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"odd?"),". Also, the ",(0,r.kt)("inlineCode",{parentName:"p"},"square")," procedure is defined for you.")),(0,r.kt)("p",null,"Here's the ",(0,r.kt)("a",{parentName:"p",href:"https://cs61a.org/hw/sol-hw07/#q1-pow"},"solution to a similar homework problem"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(define (square n) (* n n))\n\n(define (pow-expr base exp)\n    'YOUR-CODE-HERE\n)\n")),(0,r.kt)("p",null,"Use Ok to test your code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"python3 ok -q pow\n")),(0,r.kt)("h2",{id:"macros"},"Macros"),(0,r.kt)("p",null,"A macro is a code transformation that is created using ",(0,r.kt)("inlineCode",{parentName:"p"},"define-macro")," and applied using a call expression. A macro call is evaluated by:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Binding the formal paramters of the macro to the ",(0,r.kt)("strong",{parentName:"li"},"unevaluated")," operand expressions of the macro call."),(0,r.kt)("li",{parentName:"ol"},"Evaluating the body of the macro, which returns an expression."),(0,r.kt)("li",{parentName:"ol"},"Evaluating the expression returned by the macro in the frame of the original macro call.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"scm> (define-macro (twice expr) (list 'begin expr expr))\ntwice\nscm> (twice (+ 2 2))  ; evaluates (begin (+ 2 2) (+ 2 2))\n4\nscm> (twice (print (+ 2 2)))  ; evaluates (begin (print (+ 2 2)) (print (+ 2 2)))\n4\n4\n")),(0,r.kt)("h3",{id:"q4-repeat"},"Q4: Repeat"),(0,r.kt)("p",null,"Define ",(0,r.kt)("inlineCode",{parentName:"p"},"repeat"),", a macro that is called on a number ",(0,r.kt)("inlineCode",{parentName:"p"},"n")," and an expression ",(0,r.kt)("inlineCode",{parentName:"p"},"expr"),". Calling it evaluates ",(0,r.kt)("inlineCode",{parentName:"p"},"expr")," in a local frame ",(0,r.kt)("inlineCode",{parentName:"p"},"n")," times, and its value is the final result. You will find the helper function ",(0,r.kt)("inlineCode",{parentName:"p"},"repeated-call")," useful, which takes a number ",(0,r.kt)("inlineCode",{parentName:"p"},"n")," and a zero-argument procedure ",(0,r.kt)("inlineCode",{parentName:"p"},"f")," and calls ",(0,r.kt)("inlineCode",{parentName:"p"},"f")," ",(0,r.kt)("inlineCode",{parentName:"p"},"n")," times."),(0,r.kt)("p",null,"For example, ",(0,r.kt)("inlineCode",{parentName:"p"},"(repeat (+ 2 3) (print 1))")," is equivalent to:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"(repeated-call (+ 2 3) (lambda () (print 1)))")),(0,r.kt)("p",null,"and should evaluate ",(0,r.kt)("inlineCode",{parentName:"p"},"(print 1)")," repeatedly 5 times."),(0,r.kt)("p",null,"The following expression should print ",(0,r.kt)("inlineCode",{parentName:"p"},"four")," four times:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"(repeat 2 (repeat 2 (print 'four)))")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"(define-macro (repeat n expr)\n  `(repeated-call ,n ___))\n\n; Call zero-argument procedure f n times and return the final result.\n(define (repeated-call n f)\n  (if (= n 1) ___ (begin ___ ___)))\n\n")),(0,r.kt)("p",null,"Use Ok to test your code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"python3 ok -q repeat-lambda\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"repeated-call")," procedure takes a zero-argument procedure, so ",(0,r.kt)("inlineCode",{parentName:"p"},"(lambda () ___)")," must appear in the blank. The body of the lambda is ",(0,r.kt)("inlineCode",{parentName:"p"},"expr"),", which must be unquoted."),(0,r.kt)("p",null,"Call ",(0,r.kt)("inlineCode",{parentName:"p"},"f")," on no arguments with ",(0,r.kt)("inlineCode",{parentName:"p"},"(f)"),". If ",(0,r.kt)("inlineCode",{parentName:"p"},"n")," is 1, just call ",(0,r.kt)("inlineCode",{parentName:"p"},"f"),". If ",(0,r.kt)("inlineCode",{parentName:"p"},"n")," is greater than 1, first call ",(0,r.kt)("inlineCode",{parentName:"p"},"f")," and then call ",(0,r.kt)("inlineCode",{parentName:"p"},"(repeated-call (- n 1) f)"),"."))}d.isMDXComponent=!0},92998:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/lab11-5802ea3c90e73ebae6062a360754f8fb.zip"}}]);